var vo=Object.create;var qt=Object.defineProperty;var wo=Object.getOwnPropertyDescriptor;var xo=Object.getOwnPropertyNames;var ko=Object.getPrototypeOf,Lo=Object.prototype.hasOwnProperty;var zo=(e,r,o)=>r in e?qt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o;var Mo=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var Eo=(e,r,o,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let l of xo(r))!Lo.call(e,l)&&l!==o&&qt(e,l,{get:()=>r[l],enumerable:!(n=wo(r,l))||n.enumerable});return e};var kt=(e,r,o)=>(o=e!=null?vo(ko(e)):{},Eo(r||!e||!e.__esModule?qt(o,"default",{value:e,enumerable:!0}):o,e));var kr=(e,r,o)=>(zo(e,typeof r!="symbol"?r+"":r,o),o),Lr=(e,r,o)=>{if(!r.has(e))throw TypeError("Cannot "+o)};var Lt=(e,r,o)=>(Lr(e,r,"read from private field"),o?o.call(e):r.get(e)),zr=(e,r,o)=>{if(r.has(e))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(e):r.set(e,o)},Mr=(e,r,o,n)=>(Lr(e,r,"write to private field"),n?n.call(e,o):r.set(e,o),o);var ut=Mo((ht,ft)=>{(function(){var e,r,o,n,l,f,_,p,y,L,m,z,F,P,E,T,R,K,B,g,re,I,pe,W,se,Q,ve,ne,oe,Ne,Ee,Oe,ce,ge,Ce,Se,Pe,Ve,we,Le,$e,pt,he,fe,rr,It,or,gt,je,bt,sr,G,ir,lr,nr,ar,ae,cr,dr,hr,fr,ur,_r,pr,Dt,jt,Wt,gr,br,mr,mt,yt,yr,be,vr,Xe,xe,Ht,ee,te,Fe,vt,wt,ze=[].slice;ee=function(){var t,s,i,a,c;for(t={},c="Boolean Number String Function Array Date RegExp Undefined Null".split(" "),a=0,s=c.length;a<s;a++)i=c[a],t["[object "+i+"]"]=i.toLowerCase();return function(d){var h;return h=Object.prototype.toString.call(d),t[h]||"object"}}(),gt=function(t,s,i){return s==null&&(s=0),i==null&&(i=1),t<s&&(t=s),t>i&&(t=i),t},te=function(t){return t.length>=3?Array.prototype.slice.call(t):t[0]},re=function(t){var s,i;for(t._clipped=!1,t._unclipped=t.slice(0),s=i=0;i<3;s=++i)s<3?((t[s]<0||t[s]>255)&&(t._clipped=!0),t[s]<0&&(t[s]=0),t[s]>255&&(t[s]=255)):s===3&&(t[s]<0&&(t[s]=0),t[s]>1&&(t[s]=1));return t._clipped||delete t._unclipped,t},n=Math.PI,be=Math.round,W=Math.cos,oe=Math.floor,ae=Math.pow,je=Math.log,Xe=Math.sin,xe=Math.sqrt,P=Math.atan2,G=Math.max,F=Math.abs,_=n*2,l=n/3,r=n/180,f=180/n,g=function(){return arguments[0]instanceof e?arguments[0]:function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,arguments,function(){})},g.default=g,z=[],typeof ft<"u"&&ft!==null&&ft.exports!=null&&(ft.exports=g),typeof define=="function"&&define.amd?define([],function(){return g}):(yr=typeof ht<"u"&&ht!==null?ht:this,yr.chroma=g),g.version="1.4.1",m={},y=[],L=!1,e=function(){function t(){var s,i,a,c,d,h,u,b,w;for(h=this,i=[],b=0,c=arguments.length;b<c;b++)s=arguments[b],s!=null&&i.push(s);if(i.length>1&&(u=i[i.length-1]),m[u]!=null)h._rgb=re(m[u](te(i.slice(0,-1))));else{for(L||(y=y.sort(function(k,N){return N.p-k.p}),L=!0),w=0,d=y.length;w<d&&(a=y[w],u=a.test.apply(a,i),!u);w++);u&&(h._rgb=re(m[u].apply(m,i)))}h._rgb==null&&console.warn("unknown format: "+i),h._rgb==null&&(h._rgb=[0,0,0]),h._rgb.length===3&&h._rgb.push(1)}return t.prototype.toString=function(){return this.hex()},t}(),g._input=m;g.brewer=K={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},function(){var t,s;s=[];for(t in K)s.push(K[t.toLowerCase()]=K[t]);return s}(),Fe={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},g.colors=pe=Fe,he=function(){var t,s,i,a,c,d,h,u,b;return s=te(arguments),c=s[0],t=s[1],i=s[2],u=(c+16)/116,h=isNaN(t)?u:u+t/500,b=isNaN(i)?u:u-i/200,u=o.Yn*fe(u),h=o.Xn*fe(h),b=o.Zn*fe(b),d=wt(3.2404542*h-1.5371385*u-.4985314*b),a=wt(-.969266*h+1.8760108*u+.041556*b),i=wt(.0556434*h-.2040259*u+1.0572252*b),[d,a,i,s.length>3?s[3]:1]},wt=function(t){return 255*(t<=.00304?12.92*t:1.055*ae(t,1/2.4)-.055)},fe=function(t){return t>o.t1?t*t*t:o.t2*(t-o.t0)},o={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Dt=function(){var t,s,i,a,c,d,h,u;return a=te(arguments),i=a[0],s=a[1],t=a[2],c=mr(i,s,t),d=c[0],h=c[1],u=c[2],[116*h-16,500*(d-h),200*(h-u)]},mt=function(t){return(t/=255)<=.04045?t/12.92:ae((t+.055)/1.055,2.4)},vt=function(t){return t>o.t3?ae(t,1/3):t/o.t2+o.t0},mr=function(){var t,s,i,a,c,d,h;return a=te(arguments),i=a[0],s=a[1],t=a[2],i=mt(i),s=mt(s),t=mt(t),c=vt((.4124564*i+.3575761*s+.1804375*t)/o.Xn),d=vt((.2126729*i+.7151522*s+.072175*t)/o.Yn),h=vt((.0193339*i+.119192*s+.9503041*t)/o.Zn),[c,d,h]},g.lab=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["lab"]),function(){})},m.lab=he,e.prototype.lab=function(){return Dt(this._rgb)},E=function(t){var s,i,a,c,d,h,u,b,w,k,N;return t=function(){var M,x,S;for(S=[],x=0,M=t.length;x<M;x++)c=t[x],S.push(g(c));return S}(),t.length===2?(w=function(){var M,x,S;for(S=[],x=0,M=t.length;x<M;x++)c=t[x],S.push(c.lab());return S}(),d=w[0],h=w[1],s=function(M){var x,S;return S=function(){var C,D;for(D=[],x=C=0;C<=2;x=++C)D.push(d[x]+M*(h[x]-d[x]));return D}(),g.lab.apply(g,S)}):t.length===3?(k=function(){var M,x,S;for(S=[],x=0,M=t.length;x<M;x++)c=t[x],S.push(c.lab());return S}(),d=k[0],h=k[1],u=k[2],s=function(M){var x,S;return S=function(){var C,D;for(D=[],x=C=0;C<=2;x=++C)D.push((1-M)*(1-M)*d[x]+2*(1-M)*M*h[x]+M*M*u[x]);return D}(),g.lab.apply(g,S)}):t.length===4?(N=function(){var M,x,S;for(S=[],x=0,M=t.length;x<M;x++)c=t[x],S.push(c.lab());return S}(),d=N[0],h=N[1],u=N[2],b=N[3],s=function(M){var x,S;return S=function(){var C,D;for(D=[],x=C=0;C<=2;x=++C)D.push((1-M)*(1-M)*(1-M)*d[x]+3*(1-M)*(1-M)*M*h[x]+3*(1-M)*M*M*u[x]+M*M*M*b[x]);return D}(),g.lab.apply(g,S)}):t.length===5&&(i=E(t.slice(0,3)),a=E(t.slice(2,5)),s=function(M){return M<.5?i(M*2):a((M-.5)*2)}),s},g.bezier=function(t){var s;return s=E(t),s.scale=function(){return g.scale(s)},s},g.cubehelix=function(t,s,i,a,c){var d,h,u;return t==null&&(t=300),s==null&&(s=-1.5),i==null&&(i=1),a==null&&(a=1),c==null&&(c=[0,1]),d=0,ee(c)==="array"?h=c[1]-c[0]:(h=0,c=[c,c]),u=function(b){var w,k,N,M,x,S,C,D,X;return w=_*((t+120)/360+s*b),C=ae(c[0]+h*b,a),S=d!==0?i[0]+b*d:i,k=S*C*(1-C)/2,M=W(w),X=Xe(w),D=C+k*(-.14861*M+1.78277*X),x=C+k*(-.29227*M-.90649*X),N=C+k*(1.97294*M),g(re([D*255,x*255,N*255,1]))},u.start=function(b){return b==null?t:(t=b,u)},u.rotations=function(b){return b==null?s:(s=b,u)},u.gamma=function(b){return b==null?a:(a=b,u)},u.hue=function(b){return b==null?i:(i=b,ee(i)==="array"?(d=i[1]-i[0],d===0&&(i=i[1])):d=0,u)},u.lightness=function(b){return b==null?c:(ee(b)==="array"?(c=b,h=b[1]-b[0]):(c=[b,b],h=0),u)},u.scale=function(){return g.scale(u)},u.hue(i),u},g.random=function(){var t,s,i,a;for(s="0123456789abcdef",t="#",i=a=0;a<6;i=++a)t+=s.charAt(oe(Math.random()*16));return new e(t)},z=[],Se=function(t,s,i,a){var c,d,h,u;for(i==null&&(i=.5),a==null&&(a="rgb"),ee(t)!=="object"&&(t=g(t)),ee(s)!=="object"&&(s=g(s)),h=0,d=z.length;h<d;h++)if(c=z[h],a===c[0]){u=c[1](t,s,i,a);break}if(u==null)throw"color mode "+a+" is not supported";return u.alpha(t.alpha()+i*(s.alpha()-t.alpha()))},g.interpolate=Se,e.prototype.interpolate=function(t,s,i){return Se(this,t,s,i)},g.mix=Se,e.prototype.mix=e.prototype.interpolate,m.rgb=function(){var t,s,i,a;s=te(arguments),i=[];for(t in s)a=s[t],i.push(a);return i},g.rgb=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["rgb"]),function(){})},e.prototype.rgb=function(t){return t==null&&(t=!0),t?this._rgb.map(Math.round).slice(0,3):this._rgb.slice(0,3)},e.prototype.rgba=function(t){return t==null&&(t=!0),t?[Math.round(this._rgb[0]),Math.round(this._rgb[1]),Math.round(this._rgb[2]),this._rgb[3]]:this._rgb.slice(0)},y.push({p:3,test:function(t){var s;if(s=te(arguments),ee(s)==="array"&&s.length===3||s.length===4&&ee(s[3])==="number"&&s[3]>=0&&s[3]<=1)return"rgb"}}),m.lrgb=m.rgb,we=function(t,s,i,a){var c,d;return c=t._rgb,d=s._rgb,new e(xe(ae(c[0],2)*(1-i)+ae(d[0],2)*i),xe(ae(c[1],2)*(1-i)+ae(d[1],2)*i),xe(ae(c[2],2)*(1-i)+ae(d[2],2)*i),a)},p=function(t){var s,i,a,c,d,h;for(i=1/t.length,h=[0,0,0,0],c=0,a=t.length;c<a;c++)s=t[c],d=s._rgb,h[0]+=ae(d[0],2)*i,h[1]+=ae(d[1],2)*i,h[2]+=ae(d[2],2)*i,h[3]+=d[3]*i;return h[0]=xe(h[0]),h[1]=xe(h[1]),h[2]=xe(h[2]),h[3]>1&&(h[3]=1),new e(re(h))},z.push(["lrgb",we]),g.average=function(t,s){var i,a,c,d,h,u,b,w,k,N,M,x,S;if(s==null&&(s="rgb"),k=t.length,t=t.map(function(C){return g(C)}),b=t.splice(0,1)[0],s==="lrgb")return p(t);x=b.get(s),d=[],h=0,u=0;for(w in x)x[w]=x[w]||0,d.push(isNaN(x[w])?0:1),s.charAt(w)==="h"&&!isNaN(x[w])&&(i=x[w]/180*n,h+=W(i),u+=Xe(i));for(a=b.alpha(),M=0,N=t.length;M<N;M++){c=t[M],S=c.get(s),a+=c.alpha();for(w in x)isNaN(S[w])||(d[w]+=1,s.charAt(w)==="h"?(i=S[w]/180*n,h+=W(i),u+=Xe(i)):x[w]+=S[w])}for(w in x)if(s.charAt(w)==="h"){for(i=P(u/d[w],h/d[w])/n*180;i<0;)i+=360;for(;i>=360;)i-=360;x[w]=i}else x[w]=x[w]/d[w];return g(x,s).alpha(a/k)},Ee=function(t){var s,i,a,c,d,h;if(t.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return(t.length===4||t.length===7)&&(t=t.substr(1)),t.length===3&&(t=t.split(""),t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),h=parseInt(t,16),c=h>>16,a=h>>8&255,i=h&255,[c,a,i,1];if(t.match(/^#?([A-Fa-f0-9]{8})$/))return t.length===9&&(t=t.substr(1)),h=parseInt(t,16),c=h>>24&255,a=h>>16&255,i=h>>8&255,s=be((h&255)/255*100)/100,[c,a,i,s];if(m.css!=null&&(d=m.css(t)))return d;throw"unknown color: "+t},fr=function(t,s){var i,a,c,d,h,u,b;return s==null&&(s="auto"),h=t[0],c=t[1],a=t[2],i=t[3],s==="auto"&&(s=i<1?"rgba":"rgb"),h=Math.round(h),c=Math.round(c),a=Math.round(a),b=h<<16|c<<8|a,u="000000"+b.toString(16),u=u.substr(u.length-6),d="0"+be(i*255).toString(16),d=d.substr(d.length-2),"#"+function(){switch(s.toLowerCase()){case"rgba":return u+d;case"argb":return d+u;default:return u}}()},m.hex=function(t){return Ee(t)},g.hex=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["hex"]),function(){})},e.prototype.hex=function(t){return t==null&&(t="auto"),fr(this._rgb,t)},y.push({p:4,test:function(t){if(arguments.length===1&&ee(t)==="string")return"hex"}}),ge=function(){var t,s,i,a,c,d,h,u,b,w,k,N,M,x;if(t=te(arguments),c=t[0],k=t[1],h=t[2],k===0)b=a=s=h*255;else{for(x=[0,0,0],i=[0,0,0],M=h<.5?h*(1+k):h+k-h*k,N=2*h-M,c/=360,x[0]=c+1/3,x[1]=c,x[2]=c-1/3,d=u=0;u<=2;d=++u)x[d]<0&&(x[d]+=1),x[d]>1&&(x[d]-=1),6*x[d]<1?i[d]=N+(M-N)*6*x[d]:2*x[d]<1?i[d]=M:3*x[d]<2?i[d]=N+(M-N)*(2/3-x[d])*6:i[d]=N;w=[be(i[0]*255),be(i[1]*255),be(i[2]*255)],b=w[0],a=w[1],s=w[2]}return t.length>3?[b,a,s,t[3]]:[b,a,s]},_r=function(t,s,i){var a,c,d,h,u;return t!==void 0&&t.length>=3&&(h=t,t=h[0],s=h[1],i=h[2]),t/=255,s/=255,i/=255,d=Math.min(t,s,i),G=Math.max(t,s,i),c=(G+d)/2,G===d?(u=0,a=Number.NaN):u=c<.5?(G-d)/(G+d):(G-d)/(2-G-d),t===G?a=(s-i)/(G-d):s===G?a=2+(i-t)/(G-d):i===G&&(a=4+(t-s)/(G-d)),a*=60,a<0&&(a+=360),[a,u,c]},g.hsl=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["hsl"]),function(){})},m.hsl=ge,e.prototype.hsl=function(){return _r(this._rgb)},Ce=function(){var t,s,i,a,c,d,h,u,b,w,k,N,M,x,S,C,D,X;if(t=te(arguments),c=t[0],C=t[1],X=t[2],X*=255,C===0)b=a=s=X;else switch(c===360&&(c=0),c>360&&(c-=360),c<0&&(c+=360),c/=60,d=oe(c),i=c-d,h=X*(1-C),u=X*(1-C*i),D=X*(1-C*(1-i)),d){case 0:w=[X,D,h],b=w[0],a=w[1],s=w[2];break;case 1:k=[u,X,h],b=k[0],a=k[1],s=k[2];break;case 2:N=[h,X,D],b=N[0],a=N[1],s=N[2];break;case 3:M=[h,u,X],b=M[0],a=M[1],s=M[2];break;case 4:x=[D,h,X],b=x[0],a=x[1],s=x[2];break;case 5:S=[X,h,u],b=S[0],a=S[1],s=S[2]}return[b,a,s,t.length>3?t[3]:1]},pr=function(){var t,s,i,a,c,d,h,u,b;return h=te(arguments),d=h[0],i=h[1],t=h[2],c=Math.min(d,i,t),G=Math.max(d,i,t),s=G-c,b=G/255,G===0?(a=Number.NaN,u=0):(u=s/G,d===G&&(a=(i-t)/s),i===G&&(a=2+(t-d)/s),t===G&&(a=4+(d-i)/s),a*=60,a<0&&(a+=360)),[a,u,b]},g.hsv=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["hsv"]),function(){})},m.hsv=Ce,e.prototype.hsv=function(){return pr(this._rgb)},nr=function(t){var s,i,a;return ee(t)==="number"&&t>=0&&t<=16777215?(a=t>>16,i=t>>8&255,s=t&255,[a,i,s,1]):(console.warn("unknown num color: "+t),[0,0,0,1])},gr=function(){var t,s,i,a;return a=te(arguments),i=a[0],s=a[1],t=a[2],(i<<16)+(s<<8)+t},g.num=function(t){return new e(t,"num")},e.prototype.num=function(t){return t==null&&(t="rgb"),gr(this._rgb,t)},m.num=nr,y.push({p:1,test:function(t){if(arguments.length===1&&ee(t)==="number"&&t>=0&&t<=16777215)return"num"}}),Ne=function(){var t,s,i,a,c,d,h,u,b,w,k,N,M,x,S,C,D,X,ie,O;if(i=te(arguments),u=i[0],c=i[1],s=i[2],c=c/100,h=h/100*255,t=c*255,c===0)N=h=a=s;else switch(u===360&&(u=0),u>360&&(u-=360),u<0&&(u+=360),u/=60,b=oe(u),d=u-b,w=s*(1-c),k=w+t*(1-d),ie=w+t*d,O=w+t,b){case 0:M=[O,ie,w],N=M[0],h=M[1],a=M[2];break;case 1:x=[k,O,w],N=x[0],h=x[1],a=x[2];break;case 2:S=[w,O,ie],N=S[0],h=S[1],a=S[2];break;case 3:C=[w,k,O],N=C[0],h=C[1],a=C[2];break;case 4:D=[ie,w,O],N=D[0],h=D[1],a=D[2];break;case 5:X=[O,w,k],N=X[0],h=X[1],a=X[2]}return[N,h,a,i.length>3?i[3]:1]},hr=function(){var t,s,i,a,c,d,h,u,b;return b=te(arguments),u=b[0],c=b[1],s=b[2],h=Math.min(u,c,s),G=Math.max(u,c,s),a=G-h,i=a*100/255,t=h/(255-a)*100,a===0?d=Number.NaN:(u===G&&(d=(c-s)/a),c===G&&(d=2+(s-u)/a),s===G&&(d=4+(u-c)/a),d*=60,d<0&&(d+=360)),[d,i,t]},g.hcg=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["hcg"]),function(){})},m.hcg=Ne,e.prototype.hcg=function(){return hr(this._rgb)},se=function(t){var s,i,a,c,d,h,u,b;if(t=t.toLowerCase(),g.colors!=null&&g.colors[t])return Ee(g.colors[t]);if(d=t.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(u=d.slice(1,4),c=h=0;h<=2;c=++h)u[c]=+u[c];u[3]=1}else if(d=t.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(u=d.slice(1,5),c=b=0;b<=3;c=++b)u[c]=+u[c];else if(d=t.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){for(u=d.slice(1,4),c=s=0;s<=2;c=++s)u[c]=be(u[c]*2.55);u[3]=1}else if(d=t.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){for(u=d.slice(1,5),c=i=0;i<=2;c=++i)u[c]=be(u[c]*2.55);u[3]=+u[3]}else(d=t.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?(a=d.slice(1,4),a[1]*=.01,a[2]*=.01,u=ge(a),u[3]=1):(d=t.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&(a=d.slice(1,4),a[1]*=.01,a[2]*=.01,u=ge(a),u[3]=+d[4]);return u},dr=function(t){var s;if(s=t[3]<1?"rgba":"rgb",s==="rgb")return s+"("+t.slice(0,3).map(be).join(",")+")";if(s==="rgba")return s+"("+t.slice(0,3).map(be).join(",")+","+t[3]+")"},yt=function(t){return be(t*100)/100},ce=function(t,s){var i;return i=s<1?"hsla":"hsl",t[0]=yt(t[0]||0),t[1]=yt(t[1]*100)+"%",t[2]=yt(t[2]*100)+"%",i==="hsla"&&(t[3]=s),i+"("+t.join(",")+")"},m.css=function(t){return se(t)},g.css=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["css"]),function(){})},e.prototype.css=function(t){if(t==null&&(t="rgb"),t.slice(0,3)==="rgb")return dr(this._rgb);if(t.slice(0,3)==="hsl")return ce(this.hsl(),this.alpha())},m.named=function(t){return Ee(Fe[t])},y.push({p:5,test:function(t){if(arguments.length===1&&Fe[t]!=null)return"named"}}),e.prototype.name=function(t){var s,i;arguments.length&&(Fe[t]&&(this._rgb=Ee(Fe[t])),this._rgb[3]=1),s=this.hex("rgb");for(i in Fe)if(s===Fe[i])return i;return s},rr=function(){var t,s,i,a;return a=te(arguments),i=a[0],t=a[1],s=a[2],s=s*r,[i,W(s)*t,Xe(s)*t]},It=function(){var t,s,i,a,c,d,h,u,b,w,k;return i=te(arguments),u=i[0],c=i[1],h=i[2],w=rr(u,c,h),t=w[0],s=w[1],a=w[2],k=he(t,s,a),b=k[0],d=k[1],a=k[2],[b,d,a,i.length>3?i[3]:1]},pt=function(){var t,s,i,a,c,d;return d=te(arguments),c=d[0],t=d[1],s=d[2],i=xe(t*t+s*s),a=(P(s,t)*f+360)%360,be(i*1e4)===0&&(a=Number.NaN),[c,i,a]},jt=function(){var t,s,i,a,c,d,h;return d=te(arguments),c=d[0],i=d[1],s=d[2],h=Dt(c,i,s),a=h[0],t=h[1],s=h[2],pt(a,t,s)},g.lch=function(){var t;return t=te(arguments),new e(t,"lch")},g.hcl=function(){var t;return t=te(arguments),new e(t,"hcl")},m.lch=It,m.hcl=function(){var t,s,i,a;return a=te(arguments),s=a[0],t=a[1],i=a[2],It([i,t,s])},e.prototype.lch=function(){return jt(this._rgb)},e.prototype.hcl=function(){return jt(this._rgb).reverse()},cr=function(t){var s,i,a,c,d,h,u,b,w;return t==null&&(t="rgb"),b=te(arguments),u=b[0],c=b[1],s=b[2],u=u/255,c=c/255,s=s/255,d=1-Math.max(u,Math.max(c,s)),a=d<1?1/(1-d):0,i=(1-u-d)*a,h=(1-c-d)*a,w=(1-s-d)*a,[i,h,w,d]},I=function(){var t,s,i,a,c,d,h,u,b;return s=te(arguments),a=s[0],h=s[1],b=s[2],d=s[3],t=s.length>4?s[4]:1,d===1?[0,0,0,t]:(u=a>=1?0:255*(1-a)*(1-d),c=h>=1?0:255*(1-h)*(1-d),i=b>=1?0:255*(1-b)*(1-d),[u,c,i,t])},m.cmyk=function(){return I(te(arguments))},g.cmyk=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["cmyk"]),function(){})},e.prototype.cmyk=function(){return cr(this._rgb)},m.gl=function(){var t,s,i,a,c;for(a=function(){var d,h;d=te(arguments),h=[];for(s in d)c=d[s],h.push(c);return h}.apply(this,arguments),t=i=0;i<=2;t=++i)a[t]*=255;return a},g.gl=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["gl"]),function(){})},e.prototype.gl=function(){var t;return t=this._rgb,[t[0]/255,t[1]/255,t[2]/255,t[3]]},Wt=function(t,s,i){var a;return a=te(arguments),t=a[0],s=a[1],i=a[2],t=bt(t),s=bt(s),i=bt(i),.2126*t+.7152*s+.0722*i},bt=function(t){return t/=255,t<=.03928?t/12.92:ae((t+.055)/1.055,2.4)},$e=function(t,s,i,a){var c,d;return c=t._rgb,d=s._rgb,new e(c[0]+i*(d[0]-c[0]),c[1]+i*(d[1]-c[1]),c[2]+i*(d[2]-c[2]),a)},z.push(["rgb",$e]),e.prototype.luminance=function(t,s){var i,a,c,d,h;return s==null&&(s="rgb"),arguments.length?(d=this._rgb,t===0?d=[0,0,0,this._rgb[3]]:t===1?d=[255,255,255,this[3]]:(i=Wt(this._rgb),a=1e-7,c=20,h=function(u,b){var w,k;return k=u.interpolate(b,.5,s),w=k.luminance(),Math.abs(t-w)<a||!c--?k:w>t?h(u,k):h(k,b)},i>t?d=h(g("black"),this).rgba():d=h(this,g("white")).rgba()),g(d).alpha(this.alpha())):Wt(this._rgb)},Ht=function(t){var s,i,a,c;return c=t/100,c<66?(a=255,i=-155.25485562709179-.44596950469579133*(i=c-2)+104.49216199393888*je(i),s=c<20?0:-254.76935184120902+.8274096064007395*(s=c-10)+115.67994401066147*je(s)):(a=351.97690566805693+.114206453784165*(a=c-55)-40.25366309332127*je(a),i=325.4494125711974+.07943456536662342*(i=c-50)-28.0852963507957*je(i),s=255),[a,i,s]},br=function(){var t,s,i,a,c,d,h,u,b;for(h=te(arguments),d=h[0],i=h[1],t=h[2],c=1e3,a=4e4,s=.4;a-c>s;)b=(a+c)*.5,u=Ht(b),u[2]/u[0]>=t/d?a=b:c=b;return be(b)},g.temperature=g.kelvin=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["temperature"]),function(){})},m.temperature=m.kelvin=m.K=Ht,e.prototype.temperature=function(){return br(this._rgb)},e.prototype.kelvin=e.prototype.temperature,g.contrast=function(t,s){var i,a,c,d;return((c=ee(t))==="string"||c==="number")&&(t=new e(t)),((d=ee(s))==="string"||d==="number")&&(s=new e(s)),i=t.luminance(),a=s.luminance(),i>a?(i+.05)/(a+.05):(a+.05)/(i+.05)},g.distance=function(t,s,i){var a,c,d,h,u,b,w;i==null&&(i="lab"),((u=ee(t))==="string"||u==="number")&&(t=new e(t)),((b=ee(s))==="string"||b==="number")&&(s=new e(s)),d=t.get(i),h=s.get(i),w=0;for(c in d)a=(d[c]||0)-(h[c]||0),w+=a*a;return Math.sqrt(w)},g.deltaE=function(t,s,i,a){var c,d,h,u,b,w,k,N,M,x,S,C,D,X,ie,O,Me,me,$,U,ue,v,A,H,q,j,Y;for(i==null&&(i=1),a==null&&(a=1),((Me=ee(t))==="string"||Me==="number")&&(t=new e(t)),((me=ee(s))==="string"||me==="number")&&(s=new e(s)),$=t.lab(),c=$[0],h=$[1],b=$[2],U=s.lab(),d=U[0],u=U[1],w=U[2],k=xe(h*h+b*b),N=xe(u*u+w*w),A=c<16?.511:.040975*c/(1+.01765*c),ue=.0638*k/(1+.0131*k)+.638,O=k<1e-6?0:P(b,h)*180/n;O<0;)O+=360;for(;O>=360;)O-=360;return H=O>=164&&O<=345?.56+F(.2*W(n*(O+168)/180)):.36+F(.4*W(n*(O+35)/180)),M=k*k*k*k,ie=xe(M/(M+1900)),v=ue*(ie*H+1-ie),X=c-d,D=k-N,S=h-u,C=b-w,x=S*S+C*C-D*D,q=X/(i*A),j=D/(a*ue),Y=v,xe(q*q+j*j+x/(Y*Y))},e.prototype.get=function(t){var s,i,a,c,d,h;return a=this,d=t.split("."),c=d[0],s=d[1],h=a[c](),s?(i=c.indexOf(s),i>-1?h[i]:console.warn("unknown channel "+s+" in mode "+c)):h},e.prototype.set=function(t,s){var i,a,c,d,h,u;if(c=this,h=t.split("."),d=h[0],i=h[1],i)if(u=c[d](),a=d.indexOf(i),a>-1)if(ee(s)==="string")switch(s.charAt(0)){case"+":u[a]+=+s;break;case"-":u[a]+=+s;break;case"*":u[a]*=+s.substr(1);break;case"/":u[a]/=+s.substr(1);break;default:u[a]=+s}else u[a]=s;else console.warn("unknown channel "+i+" in mode "+d);else u=s;return g(u,d).alpha(c.alpha())},e.prototype.clipped=function(){return this._rgb._clipped||!1},e.prototype.alpha=function(t){return arguments.length?g.rgb([this._rgb[0],this._rgb[1],this._rgb[2],t]):this._rgb[3]},e.prototype.darken=function(t){var s,i;return t==null&&(t=1),i=this,s=i.lab(),s[0]-=o.Kn*t,g.lab(s).alpha(i.alpha())},e.prototype.brighten=function(t){return t==null&&(t=1),this.darken(-t)},e.prototype.darker=e.prototype.darken,e.prototype.brighter=e.prototype.brighten,e.prototype.saturate=function(t){var s,i;return t==null&&(t=1),i=this,s=i.lch(),s[1]+=t*o.Kn,s[1]<0&&(s[1]=0),g.lch(s).alpha(i.alpha())},e.prototype.desaturate=function(t){return t==null&&(t=1),this.saturate(-t)},e.prototype.premultiply=function(){var t,s;return s=this.rgb(),t=this.alpha(),g(s[0]*t,s[1]*t,s[2]*t,t)},T=function(t,s,i){if(!T[i])throw"unknown blend mode "+i;return T[i](t,s)},R=function(t){return function(s,i){var a,c;return a=g(i).rgb(),c=g(s).rgb(),g(t(a,c),"rgb")}},ne=function(t){return function(s,i){var a,c,d;for(d=[],a=c=0;c<=3;a=++c)d[a]=t(s[a],i[a]);return d}},lr=function(t,s){return t},ir=function(t,s){return t*s/255},Q=function(t,s){return t>s?s:t},or=function(t,s){return t>s?t:s},vr=function(t,s){return 255*(1-(1-t/255)*(1-s/255))},ar=function(t,s){return s<128?2*t*s/255:255*(1-2*(1-t/255)*(1-s/255))},B=function(t,s){return 255*(1-(1-s/255)/(t/255))},ve=function(t,s){return t===255||(t=255*(s/255)/(1-t/255),t>255)?255:t},T.normal=R(ne(lr)),T.multiply=R(ne(ir)),T.screen=R(ne(vr)),T.overlay=R(ne(ar)),T.darken=R(ne(Q)),T.lighten=R(ne(or)),T.dodge=R(ne(ve)),T.burn=R(ne(B)),g.blend=T,g.analyze=function(t){var s,i,a,c;for(a={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0},i=0,s=t.length;i<s;i++)c=t[i],c!=null&&!isNaN(c)&&(a.values.push(c),a.sum+=c,c<a.min&&(a.min=c),c>a.max&&(a.max=c),a.count+=1);return a.domain=[a.min,a.max],a.limits=function(d,h){return g.limits(a,d,h)},a},g.scale=function(t,s){var i,a,c,d,h,u,b,w,k,N,M,x,S,C,D,X,ie,O,Me,me,$,U,ue;return N="rgb",M=g("#ccc"),D=0,u=!1,h=[0,1],C=[],S=[0,0],i=!1,c=[],x=!1,k=0,w=1,d=!1,a={},X=!0,b=1,U=function(v){var A,H,q,j,Y,J;if(v==null&&(v=["#fff","#000"]),v!=null&&ee(v)==="string"&&g.brewer!=null&&(v=g.brewer[v]||g.brewer[v.toLowerCase()]||v),ee(v)==="array"){for(v.length===1&&(v=[v[0],v[0]]),v=v.slice(0),A=q=0,j=v.length-1;0<=j?q<=j:q>=j;A=0<=j?++q:--q)H=v[A],ee(H)==="string"&&(v[A]=g(H));for(C.length=0,A=J=0,Y=v.length-1;0<=Y?J<=Y:J>=Y;A=0<=Y?++J:--J)C.push(A/(v.length-1))}return $(),c=v},Me=function(v){var A,H;if(i!=null){for(H=i.length-1,A=0;A<H&&v>=i[A];)A++;return A-1}return 0},ue=function(v){return v},ie=function(v){var A,H,q,j,Y;return Y=v,i.length>2&&(j=i.length-1,A=Me(v),q=i[0]+(i[1]-i[0])*(0+D*.5),H=i[j-1]+(i[j]-i[j-1])*(1-D*.5),Y=k+(i[A]+(i[A+1]-i[A])*.5-q)/(H-q)*(w-k)),Y},me=function(v,A){var H,q,j,Y,J,Z,le,V;if(A==null&&(A=!1),isNaN(v)||v===null)return M;if(A?V=v:i&&i.length>2?(H=Me(v),V=H/(i.length-2)):w!==k?V=(v-k)/(w-k):V=1,A||(V=ue(V)),b!==1&&(V=ae(V,b)),V=S[0]+V*(1-S[0]-S[1]),V=Math.min(1,Math.max(0,V)),Y=Math.floor(V*1e4),X&&a[Y])q=a[Y];else{if(ee(c)==="array")for(j=J=0,le=C.length-1;0<=le?J<=le:J>=le;j=0<=le?++J:--J){if(Z=C[j],V<=Z){q=c[j];break}if(V>=Z&&j===C.length-1){q=c[j];break}if(V>Z&&V<C[j+1]){V=(V-Z)/(C[j+1]-Z),q=g.interpolate(c[j],c[j+1],V,N);break}}else ee(c)==="function"&&(q=c(V));X&&(a[Y]=q)}return q},$=function(){return a={}},U(t),O=function(v){var A;return A=g(me(v)),x&&A[x]?A[x]():A},O.classes=function(v){var A;return v!=null?(ee(v)==="array"?(i=v,h=[v[0],v[v.length-1]]):(A=g.analyze(h),v===0?i=[A.min,A.max]:i=g.limits(A,"e",v)),O):i},O.domain=function(v){var A,H,q,j,Y,J,Z;if(!arguments.length)return h;if(k=v[0],w=v[v.length-1],C=[],q=c.length,v.length===q&&k!==w)for(Y=0,j=v.length;Y<j;Y++)H=v[Y],C.push((H-k)/(w-k));else for(A=Z=0,J=q-1;0<=J?Z<=J:Z>=J;A=0<=J?++Z:--Z)C.push(A/(q-1));return h=[k,w],O},O.mode=function(v){return arguments.length?(N=v,$(),O):N},O.range=function(v,A){return U(v,A),O},O.out=function(v){return x=v,O},O.spread=function(v){return arguments.length?(D=v,O):D},O.correctLightness=function(v){return v==null&&(v=!0),d=v,$(),d?ue=function(A){var H,q,j,Y,J,Z,le,V,de;for(H=me(0,!0).lab()[0],q=me(1,!0).lab()[0],le=H>q,j=me(A,!0).lab()[0],J=H+(q-H)*A,Y=j-J,V=0,de=1,Z=20;Math.abs(Y)>.01&&Z-- >0;)(function(){return le&&(Y*=-1),Y<0?(V=A,A+=(de-A)*.5):(de=A,A+=(V-A)*.5),j=me(A,!0).lab()[0],Y=j-J})();return A}:ue=function(A){return A},O},O.padding=function(v){return v!=null?(ee(v)==="number"&&(v=[v,v]),S=v,O):S},O.colors=function(v,A){var H,q,j,Y,J,Z,le,V,de;if(arguments.length<2&&(A="hex"),Z=[],arguments.length===0)Z=c.slice(0);else if(v===1)Z=[O(.5)];else if(v>1)q=h[0],H=h[1]-q,Z=function(){le=[];for(var _e=0;0<=v?_e<v:_e>v;0<=v?_e++:_e--)le.push(_e);return le}.apply(this).map(function(_e){return O(q+_e/(v-1)*H)});else{if(t=[],V=[],i&&i.length>2)for(j=de=1,J=i.length;1<=J?de<J:de>J;j=1<=J?++de:--de)V.push((i[j-1]+i[j])*.5);else V=h;Z=V.map(function(_e){return O(_e)})}return g[A]&&(Z=Z.map(function(_e){return _e[A]()})),Z},O.cache=function(v){return v!=null?(X=v,O):X},O.gamma=function(v){return v!=null?(b=v,O):b},O.nodata=function(v){return v!=null?(M=g(v),O):M},O},g.scales==null&&(g.scales={}),g.scales.cool=function(){return g.scale([g.hsl(180,1,.9),g.hsl(250,.7,.4)])},g.scales.hot=function(){return g.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},g.analyze=function(t,s,i){var a,c,d,h,u,b,w;if(u={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0},i==null&&(i=function(){return!0}),a=function(k){k!=null&&!isNaN(k)&&(u.values.push(k),u.sum+=k,k<u.min&&(u.min=k),k>u.max&&(u.max=k),u.count+=1)},w=function(k,N){if(i(k,N))return s!=null&&ee(s)==="function"?a(s(k)):s!=null&&ee(s)==="string"||ee(s)==="number"?a(k[s]):a(k)},ee(t)==="array")for(h=0,d=t.length;h<d;h++)b=t[h],w(b);else for(c in t)b=t[c],w(b,c);return u.domain=[u.min,u.max],u.limits=function(k,N){return g.limits(u,k,N)},u},g.limits=function(t,s,i){var a,c,d,h,u,b,w,k,N,M,x,S,C,D,X,ie,O,Me,me,$,U,ue,v,A,H,q,j,Y,J,Z,le,V,de,_e,Ue,Ke,Ze,Je,Qe,et,wr,tt,rt,ot,st,it,lt,nt,at,ct,yo,Te,xt,xr,Ae,dt;if(s==null&&(s="equal"),i==null&&(i=7),ee(t)==="array"&&(t=g.analyze(t)),H=t.min,G=t.max,yo=t.sum,Ae=t.values.sort(function($t,Bt){return $t-Bt}),i===1)return[H,G];if(v=[],s.substr(0,1)==="c"&&(v.push(H),v.push(G)),s.substr(0,1)==="e"){for(v.push(H),$=le=1,Ue=i-1;1<=Ue?le<=Ue:le>=Ue;$=1<=Ue?++le:--le)v.push(H+$/i*(G-H));v.push(G)}else if(s.substr(0,1)==="l"){if(H<=0)throw"Logarithmic scales are only possible for values > 0";for(q=Math.LOG10E*je(H),A=Math.LOG10E*je(G),v.push(H),$=dt=1,Ke=i-1;1<=Ke?dt<=Ke:dt>=Ke;$=1<=Ke?++dt:--dt)v.push(ae(10,q+$/i*(A-q)));v.push(G)}else if(s.substr(0,1)==="q"){for(v.push(H),$=a=1,tt=i-1;1<=tt?a<=tt:a>=tt;$=1<=tt?++a:--a)V=(Ae.length-1)*$/i,de=oe(V),de===V?v.push(Ae[de]):(_e=V-de,v.push(Ae[de]*(1-_e)+Ae[de+1]*_e));v.push(G)}else if(s.substr(0,1)==="k"){for(Y=Ae.length,D=new Array(Y),Me=new Array(i),ct=!0,J=0,ie=null,ie=[],ie.push(H),$=c=1,rt=i-1;1<=rt?c<=rt:c>=rt;$=1<=rt?++c:--c)ie.push(H+$/i*(G-H));for(ie.push(G);ct;){for(U=d=0,ot=i-1;0<=ot?d<=ot:d>=ot;U=0<=ot?++d:--d)Me[U]=0;for($=h=0,st=Y-1;0<=st?h<=st:h>=st;$=0<=st?++h:--h){for(xr=Ae[$],j=Number.MAX_VALUE,U=u=0,it=i-1;0<=it?u<=it:u>=it;U=0<=it?++u:--u)me=F(ie[U]-xr),me<j&&(j=me,X=U);Me[X]++,D[$]=X}for(Z=new Array(i),U=b=0,lt=i-1;0<=lt?b<=lt:b>=lt;U=0<=lt?++b:--b)Z[U]=null;for($=w=0,nt=Y-1;0<=nt?w<=nt:w>=nt;$=0<=nt?++w:--w)O=D[$],Z[O]===null?Z[O]=Ae[$]:Z[O]+=Ae[$];for(U=k=0,at=i-1;0<=at?k<=at:k>=at;U=0<=at?++k:--k)Z[U]*=1/Me[U];for(ct=!1,U=N=0,Ze=i-1;0<=Ze?N<=Ze:N>=Ze;U=0<=Ze?++N:--N)if(Z[U]!==ie[$]){ct=!0;break}ie=Z,J++,J>200&&(ct=!1)}for(ue={},U=M=0,Je=i-1;0<=Je?M<=Je:M>=Je;U=0<=Je?++M:--M)ue[U]=[];for($=x=0,Qe=Y-1;0<=Qe?x<=Qe:x>=Qe;$=0<=Qe?++x:--x)O=D[$],ue[O].push(Ae[$]);for(Te=[],U=S=0,et=i-1;0<=et?S<=et:S>=et;U=0<=et?++S:--S)Te.push(ue[U][0]),Te.push(ue[U][ue[U].length-1]);for(Te=Te.sort(function($t,Bt){return $t-Bt}),v.push(Te[0]),$=C=1,wr=Te.length-1;C<=wr;$=C+=2)xt=Te[$],!isNaN(xt)&&v.indexOf(xt)===-1&&v.push(xt)}return v},Oe=function(t,s,i){var a,c,d,h;return a=te(arguments),t=a[0],s=a[1],i=a[2],isNaN(t)&&(t=0),t/=360,t<1/3?(c=(1-s)/3,h=(1+s*W(_*t)/W(l-_*t))/3,d=1-(c+h)):t<2/3?(t-=1/3,h=(1-s)/3,d=(1+s*W(_*t)/W(l-_*t))/3,c=1-(h+d)):(t-=2/3,d=(1-s)/3,c=(1+s*W(_*t)/W(l-_*t))/3,h=1-(d+c)),h=gt(i*h*3),d=gt(i*d*3),c=gt(i*c*3),[h*255,d*255,c*255,a.length>3?a[3]:1]},ur=function(){var t,s,i,a,c,d,h,u;return h=te(arguments),d=h[0],s=h[1],t=h[2],_=Math.PI*2,d/=255,s/=255,t/=255,c=Math.min(d,s,t),a=(d+s+t)/3,u=1-c/a,u===0?i=0:(i=(d-s+(d-t))/2,i/=Math.sqrt((d-s)*(d-s)+(d-t)*(s-t)),i=Math.acos(i),t>s&&(i=_-i),i/=_),[i*360,u,a]},g.hsi=function(){return function(t,s,i){i.prototype=t.prototype;var a=new i,c=t.apply(a,s);return Object(c)===c?c:a}(e,ze.call(arguments).concat(["hsi"]),function(){})},m.hsi=Oe,e.prototype.hsi=function(){return ur(this._rgb)},Pe=function(t,s,i,a){var c,d,h,u,b,w,k,N,M,x,S,C,D;return a==="hsl"?(C=t.hsl(),D=s.hsl()):a==="hsv"?(C=t.hsv(),D=s.hsv()):a==="hcg"?(C=t.hcg(),D=s.hcg()):a==="hsi"?(C=t.hsi(),D=s.hsi()):(a==="lch"||a==="hcl")&&(a="hcl",C=t.hcl(),D=s.hcl()),a.substr(0,1)==="h"&&(h=C[0],x=C[1],w=C[2],u=D[0],S=D[1],k=D[2]),!isNaN(h)&&!isNaN(u)?(u>h&&u-h>180?c=u-(h+360):u<h&&h-u>180?c=u+360-h:c=u-h,d=h+i*c):isNaN(h)?isNaN(u)?d=Number.NaN:(d=u,(w===1||w===0)&&a!=="hsv"&&(M=S)):(d=h,(k===1||k===0)&&a!=="hsv"&&(M=x)),M==null&&(M=x+i*(S-x)),b=w+i*(k-w),N=g[a](d,M,b)},z=z.concat(function(){var t,s,i,a;for(i=["hsv","hsl","hsi","hcl","lch","hcg"],a=[],s=0,t=i.length;s<t;s++)sr=i[s],a.push([sr,Pe]);return a}()),Le=function(t,s,i,a){var c,d;return c=t.num(),d=s.num(),g.num(c+(d-c)*i,"num")},z.push(["num",Le]),Ve=function(t,s,i,a){var c,d,h;return d=t.lab(),h=s.lab(),c=new e(d[0]+i*(h[0]-d[0]),d[1]+i*(h[1]-d[1]),d[2]+i*(h[2]-d[2]),a)},z.push(["lab",Ve])}).call(ht)});var We=new WeakMap,Er=!0,So=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Ao=So?5e6:1e7,zt=0,Be=0,Sr=performance.now();function Co(){let e=performance.now(),r=e-Sr,o=zt,n=Be*1e3/r,l=1e3/o,f=Be;return zt=0,Be=0,Sr=e,{avg:o,real_fps:n,virtual_fps:l,num_frames:f,elapsed:r}}function No(e){zt=(zt*Be+e)/(Be+1),Be+=1}var Nr=(e,...r)=>e.map((o,n)=>[o,r[n]]).flat().filter(o=>!!o).join(""),Oo=()=>{let e,r=new Promise(o=>{e=o});return r.resolve=e,r},Re=new Map;async function Po(e){return await new Promise(requestAnimationFrame),await Re.get(e)}async function Or(e,r){if(Re.has(e)&&(await Re.get(e),Re.has(e))){await Re.get(e);return}Re.set(e,Oo());try{return await r()}finally{let o=Re.get(e);Re.delete(e),o.resolve()}}var Fo=":host{position:absolute;top:0px;left:0px;right:0px;bottom:0px;overflow:scroll;overflow-anchor:none;overscroll-behavior:none;-webkit-overflow-scrolling:touch;}div.rt-virtual-panel{position:absolute;top:0;left:0;right:0;pointer-events:none;}div.rt-scroll-table-clip{position:sticky;contain:strict;overflow-anchor:none;width:100%;height:100%;}div.rt-tree-container{display:flex;align-items:center;height:100%;}slot{position:absolute;overflow:hidden;overflow-anchor:none;}",To=":host ::slotted(table){--regular-table--transform-x:0px;--regular-table--transform-y:0px;--regular-table--clip-x:0px;--regular-table--clip-y:0px;}",Ro=class extends HTMLElement{create_shadow_dom(){this.attachShadow({mode:"open"});let e="<slot></slot>";this.shadowRoot.innerHTML=Nr`
            <style>
                ${Fo}
            </style>
            <style>
                ${To}
            </style>
            <div class="rt-virtual-panel"></div>
            <div class="rt-scroll-table-clip">
                ${e}
            </div>
        `;let[,r,o,n]=this.shadowRoot.children;this._sub_cell_style=r,this._table_clip=n,this._virtual_panel=o,this._setup_virtual_scroll()}_setup_virtual_scroll(){this._table_clip&&(this._virtual_mode==="both"||this._virtual_mode==="vertical"?this._table_clip.style.top="0px":this._table_clip.style.removeProperty("top"),this._virtual_mode==="both"||this._virtual_mode==="horizontal"?this._table_clip.style.left="0px":this._table_clip.style.removeProperty("left"),this._virtual_mode!=="both"?this._table_clip.style.contain="none":this._table_clip.style.removeProperty("contain"))}_calculate_viewport(e,r){let{start_row:o,end_row:n}=this._calculate_row_range(e),{start_col:l,end_col:f}=this._calculate_column_range(r);return this._nrows=e,{start_col:l,end_col:f,start_row:o,end_row:n}}_calculate_row_range(e){let{height:r}=this._container_size,o=this._column_sizes.row_height||19,n=this._view_cache.config.column_pivots.length,l=Math.max(1,this._virtual_panel.offsetHeight-this.clientHeight),f=Math.max(Math.ceil(this.scrollTop),0)/l,_=r/o-n,p=Math.max(0,Math.ceil((e||0)-_))*f,y=Math.max(0,Math.min(p+_,e));return{start_row:p,end_row:y}}_calc_start_column(){let e=this._view_cache.config.row_pivots.length,r=0,o=0,n=0;for(;o<this.scrollLeft;){let l=this._column_sizes.indices[r+e];n=this.scrollLeft-o,r+=1,o+=l!==void 0?l:60}return r+=n/(this._column_sizes.indices[r+e-1]||60),Math.max(0,r-1)}_calculate_column_range(e){if(this._virtual_mode==="none"||this._virtual_mode==="vertical")return{start_col:0,end_col:1/0};{let r=this._calc_start_column(),o=this.table_model.num_columns()||Math.min(e,Math.ceil(this._container_size.width/60)),n=r+o+1;return{start_col:r,end_col:n}}}_max_scroll_column(e){let r=0;if(this._view_cache.config.row_pivots.length>0)for(let l of this._column_sizes.indices.slice(0,this._view_cache.config.row_pivots.length))r+=l;let o=this._view_cache.config.row_pivots.length,n=e;for(;r<this._container_size.width&&n>=0;)n--,r+=this._column_sizes.indices[n+o]||60;return Math.min(e-1,n+1)}_validate_viewport({start_col:e,end_col:r,start_row:o,end_row:n}){o=Math.floor(o),n=Math.ceil(n),e=Math.floor(e),r=Math.ceil(r);let l=this._start_col!==e,f=this._start_row!==o||this._end_row!==n||this._end_col!==r;return this._start_col=e,this._end_col=r,this._start_row=o,this._end_row=n,{invalid_column:l,invalid_row:f}}_calc_scrollable_column_width(e){let r=this._view_cache.config.row_pivots.length,o=this._max_scroll_column(e),n=r,l=0;for(;n<o+r;)l+=this._column_sizes.indices[n]||60,n++;return l}_update_virtual_panel_width(e,r){if(e)if(this._virtual_mode==="vertical"||this._virtual_mode==="none")this._virtual_panel.style.width=this._column_sizes.indices.reduce((o,n)=>o+n,0)+"px";else{let o=this._calc_scrollable_column_width(r);if(o!==0){let n=this._container_size.width+o+2;this._virtual_panel.style.width=n+"px"}else this._virtual_panel.style.width="1px"}}_update_virtual_panel_height(e){let{row_height:r=19}=this._column_sizes,o=this._view_cache.config.column_pivots.length*r,n;if(this._virtual_mode==="horizontal"||this._virtual_mode==="none")n=e*r+o;else{let l=this.clientHeight/(this._table_clip.offsetHeight-o);n=Math.min(Ao,e*r*l)}this._virtual_panel.style.height=`${n}px`}async draw(e={}){return typeof e.throttle<"u"&&!e.throttle?await Ar.call(this,e):await Or(this,()=>Ar.call(this,e))}async _draw_flush(){await Po(this)}update_sub_cell_offset(e){let r=this._column_sizes.row_height*(e.start_row%1)||0,o=this._column_sizes.indices[(this.table_model._row_headers_length||0)+Math.floor(e.start_col)]*(e.start_col%1)||0,n=this._sub_cell_style.sheet?.cssRules[0].style;n&&(n.setProperty("--regular-table--clip-x",`${o}px`),n.setProperty("--regular-table--clip-y",`${r}px`),n.setProperty("--regular-table--transform-x",`-${o}px`),n.setProperty("--regular-table--transform-y",`-${r}px`))}};async function Ar(e){let r=Er&&performance.now(),{invalid_viewport:o=!0,preserve_width:n=!1}=e,{num_columns:l,num_rows:f,row_height:_}=await this._view_cache.view(0,0,0,0);this._container_size={width:this._virtual_mode==="none"||this._virtual_mode==="vertical"?1/0:this._table_clip.clientWidth,height:this._virtual_mode==="none"||this._virtual_mode==="horizontal"?1/0:this._table_clip.clientHeight},this._update_virtual_panel_height(f),n||this._update_virtual_panel_width(o,l);let p=this._calculate_viewport(f,l),{invalid_row:y,invalid_column:L}=this._validate_viewport(p);if(this._invalid_schema||y||L||o){let m=[],z=!0;for await(let F of this.table_model.draw(this._container_size,this._view_cache,this._selected_id,n,p,l)){F!==void 0&&(m=m.concat(F)),z&&(this.update_sub_cell_offset(p),z=!1),this._is_styling=!0;let P=this._style_callbacks;for(let E of P)await E({detail:this});if(this._is_styling=!1,!this._invalidated&&F!==void 0)break;this._invalidated=!1}this.table_model.autosize_cells(m,_),this.table_model.header.reset_header_cache(),n||this._update_virtual_panel_width(this._invalid_schema||L,l),this._invalid_schema=!1}else this.update_sub_cell_offset(p);Er&&No(performance.now()-r)}var Io=!1,Do=class extends Ro{register_listeners(){this.addEventListener("mousedown",this._on_click_or_dblclick.bind(this)),this.addEventListener("scroll",this._on_scroll.bind(this),{passive:!0}),this._register_glitch_scroll_listeners()}async _on_scroll(e){e.stopPropagation(),await this.draw({invalid_viewport:!1}),this.dispatchEvent(new CustomEvent("regular-table-scroll"))}_register_glitch_scroll_listeners(){this.addEventListener("mousewheel",this._on_mousewheel.bind(this)),Io&&(this.addEventListener("touchmove",this._on_touchmove.bind(this)),this.addEventListener("touchstart",this._on_touchstart.bind(this),{passive:!0}))}_on_mousewheel(e){if(!window.safari)return;let{clientWidth:r,clientHeight:o,scrollTop:n,scrollLeft:l}=this;e.preventDefault(),e.returnValue=!1;let f=Math.max(1,this._virtual_panel.offsetHeight-o),_=Math.max(1,this._virtual_panel.offsetWidth-r);this.scrollTop=Math.max(0,Math.min(f,n+e.deltaY)),this.scrollLeft=Math.max(0,Math.min(_,l+e.deltaX)),this._on_scroll(e)}_on_touchmove(e){e.stopPropagation(),e.preventDefault(),e.returnValue=!1;let{clientWidth:r,clientHeight:o}=this,n=Math.max(1,this._virtual_panel.offsetHeight-o),l=Math.max(1,this._virtual_panel.offsetWidth-r);this.scrollTop=Math.min(n,this._memo_scroll_top+(this._memo_touch_startY-e.touches[0].pageY)),this.scrollLeft=Math.min(l,this._memo_scroll_left+(this._memo_touch_startX-e.touches[0].pageX)),this._on_scroll(e)}_on_touchstart(e){this._memo_touch_startY=e.touches[0].pageY,this._memo_touch_startX=e.touches[0].pageX,this._memo_scroll_top=this.scrollTop,this._memo_scroll_left=this.scrollLeft}async _on_dblclick(e){let r=e.target;for(;r.tagName!=="TD"&&r.tagName!=="TH";)if(r=r.parentElement,!this.contains(r))return;let o=e.target.classList.contains("rt-column-resize"),n=We.get(r);if(o){e.stopImmediatePropagation(),r.style.minWidth="",r.style.maxWidth="",e.shiftKey?(this._column_sizes.override=[],this._column_sizes.auto=[],this._column_sizes.indices=[]):(this._column_sizes.override[n.size_key]=void 0,this._column_sizes.auto[n.size_key]=void 0,this._column_sizes.indices[n.size_key]=void 0);for(let l of e.shiftKey?[this.table_model.header.cells[this.table_model.header.cells.length-1],...this.table_model.body.cells]:this.table_model.body.cells)for(let f of e.shiftKey?l:[l[n._virtual_x]])f&&(f.style.minWidth="",f.style.maxWidth="",f.classList.remove("rt-cell-clip"));await this.draw()}}async _on_click(e){if(e.button!==0)return;let r=e.target;for(;r.tagName!=="TD"&&r.tagName!=="TH";)if(r=r.parentElement,!this.contains(r))return;let o=e.target.classList.contains("rt-column-resize"),n=We.get(r);o&&(this._on_resize_column(e,r,n),e.stopImmediatePropagation())}async _on_click_or_dblclick(e){let r=performance.now();this._last_clicked_time&&r-this._last_clicked_time<500?(this._last_clicked_time=r,await this._on_dblclick(e)):(this._last_clicked_time=r,await this._on_click(e))}_on_resize_column(e,r,o){let{_virtual_x:n,size_key:l}=o,f=e.pageX,_=n+r.colSpan-1,p=this.table_model.header.get_column_header(_),y=this._column_sizes.indices[l],L=z=>Or(this,async()=>await this._on_resize_column_move(z,p,f,y,l,_)),m=()=>{document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",m);let z=this._column_sizes.override[l],F=this._column_sizes.indices[l]!==z;this._column_sizes.indices[l]=z,F&&this.draw()};document.addEventListener("mousemove",L),document.addEventListener("mouseup",m)}async _on_resize_column_move(e,r,o,n,l,f){await new Promise(requestAnimationFrame);let _=e.pageX-o,p=Math.max(1,n+_);if(this._column_sizes.override[l]=p,_<0)await this.draw({preserve_width:!0,throttle:!1});else{r.style.minWidth=p+"px",r.style.maxWidth=p+"px";let y=this._column_sizes.auto[l];for(let L of this.table_model.body.cells){let m=L[f];m&&(m.style.maxWidth=m.style.minWidth=p+"px",m.classList.toggle("rt-cell-clip",y>p))}}}},jo=class{constructor(e){this._name=e,this._elements=[],this._index=0}reset(){this._index=0}get(){this._elements[this._index]||(this._elements[this._index]=document.createElement(this._name));let e=this._elements[this._index];return this._index+=1,e}},Pr=class{constructor(e,r,o){this._column_sizes=e,this._container=r,this._span_factory=new jo("span"),this.table=o,this.cells=[],this.rows=[]}num_columns(){return this._get_row(Math.max(0,this.rows.length-1)).row_container.length}num_rows(){return this.cells.length}_set_metadata(e,r){We.set(e,r)}_get_or_create_metadata(e){if(e===void 0)return{};if(We.has(e))return We.get(e);{let r={};return We.set(e,r),r}}_replace_cell(e,r){let{tr:o,row_container:n}=this._get_row(e),l=n[r];return l&&(o.removeChild(l),n.splice(r,1,void 0)),l}_fetch_cell(e,r){if(!(e<0||r<0))return this.cells[e]?.[r]}_get_row(e){let r=this.rows[e];r||(r=this.rows[e]=document.createElement("tr"),this.table.appendChild(r));let o=this.cells[e];return o||(o=this.cells[e]=[]),{tr:r,row_container:o}}_get_cell(e="TD",r,o){let{tr:n,row_container:l}=this._get_row(r),f=l[o];if(f||(o<l.length?(f=l[o]=document.createElement(e),n.insertBefore(f,l.slice(o+1).find(_=>_))):(f=l[o]=document.createElement(e),n.appendChild(f))),f.tagName!==e){let _=document.createElement(e);n.replaceChild(_,f),this.cells[r].splice(o,1,_),f=_}return f}_clean_columns(e){for(let r=0;r<this.rows.length;r++){let o=this.rows[r],n=this.cells[r];this.cells[r]=n.slice(0,e[r]||e);let l=this.cells[r].filter(f=>f!==void 0).length;for(;o.children[l];)o.removeChild(o.children[l])}}_clean_rows(e){for(;this.table.children[e];)this.table.removeChild(this.table.children[e]);this.rows=this.rows.slice(0,e),this.cells=this.cells.slice(0,e)}},Wo=class extends Pr{constructor(...e){super(...e),this._group_header_cache=[],this._offset_cache=[]}_draw_group_th(e,r,o){let n=this._get_cell("TH",r,e[r]||0);if(e[r]+=1,n.removeAttribute("colspan"),n.style.minWidth="0",n.textContent="",o instanceof HTMLElement)n.appendChild(o);else{let f=this._span_factory.get("span");f.textContent=o,n.appendChild(f)}let l=this._span_factory.get("span");return l.className="rt-column-resize",n.appendChild(l),n}_draw_group(e,r,o){let n=this._get_or_create_metadata(o);return n.column_header=e,n.value=r,n.value=r,n}_draw_th(e,r,o,n,l){let f=this._get_or_create_metadata(o);if(f.column_header=e,f.value=r,f.size_key=l.length?l[0]:l,!(l.length>1)){let _=this._column_sizes.override[f.size_key],p=this._column_sizes.auto[f.size_key];_?(o.classList.toggle("rt-cell-clip",p>_),o.style.minWidth=_+"px",o.style.maxWidth=_+"px"):p?(o.classList.remove("rt-cell-clip"),o.style.maxWidth="",o.style.minWidth=p+"px"):(o.style.maxWidth="",o.style.maxWidth="")}return f}get_column_header(e){return this._get_cell("TH",this.num_rows()-1,e)}draw(e,r,o,n,l,f,_,p,y){let L=r?.length;if(L===0)return;let m,z,F,P;p=typeof p>"u"?L-1:p;for(let E=0;E<L;E++){if(F=r[E]?r[E]:"",this._offset_cache[E]=this._offset_cache[E]||0,E<p)y&&this._group_header_cache?.[E]?.[0]?.value===F?(m=this._group_header_cache[E][1],this._group_header_cache[E][2]+=1,o===1&&(this._group_header_cache[E][0].row_header_x=l),m.setAttribute("colspan",this._group_header_cache[E][2])):(m=this._draw_group_th(this._offset_cache,E,F),z=this._draw_group(r,F,m),this._group_header_cache[E]=[z,m,1]);else{m=this._draw_group_th(this._offset_cache,E,F),z=this._draw_th(e||r,F,m,n,l),typeof P>"u"&&(P={th:m,metadata:z});for(let[T]of this._group_header_cache)T.size_key=z.size_key;m.removeAttribute("colspan")}this._get_row(E).tr.classList.toggle("rt-autosize",E===p),m.classList.toggle("rt-group-corner",n===void 0),z&&(z.x=typeof n>"u"?n:Math.floor(n),z.column_header_y=E,z.x0=Math.floor(f),z._virtual_x=_,o===1&&(z.row_header_x=l))}return this._clean_rows(this._offset_cache.length),P=P||{th:m,metadata:z},P}clean(){this._clean_columns(this._offset_cache)}reset_header_cache(){this._offset_cache=[],this._group_header_cache=[]}},Ho=class extends Pr{_draw_td(e,r,o,n,{column_name:l},{ridx_offset:f},_){let p=this._get_cell(e,r,n),y=this._get_or_create_metadata(p);y.y=r+Math.floor(f),y.size_key=_,e==="TD"&&(y.column_header=l);let L=this._column_sizes.override[y.size_key];if(L){let m=this._column_sizes.auto[y.size_key];p.classList.toggle("rt-cell-clip",m>L),p.style.minWidth=L+"px",p.style.maxWidth=L+"px"}else p.classList.remove("rt-cell-clip"),p.style.minWidth="",p.style.maxWidth="";return y.value!==o&&(o instanceof HTMLElement?(p.textContent="",p.appendChild(o)):p.textContent=o),y.value=o,{td:p,metadata:y}}draw(e,r,o,n=!1,l,f,_,p){let{cidx:y,column_data:L,row_headers:m,column_data_listener_metadata:z}=r,{row_height:F}=o,P,E=[],T=[],R=0,K=[];for(let B=0;B<(n?o.row_headers_length:1);B++){R=0;for(let g of L){let re=m?.[R],I;if(n){let pe=g[B],W=this._fetch_cell(R-(E[B]||1),y+B),se=this._get_or_create_metadata(W),Q=this._fetch_cell(R,y+B-(K[R]||1)),ve=this._get_or_create_metadata(Q);p&&Q&&(ve.value===pe||pe===void 0)&&!Q.hasAttribute("rowspan")?(K[R]=K[R]?K[R]+1:2,Q.setAttribute("colspan",K[R]),this._replace_cell(R,y+B)):p&&W&&se.value===pe&&!W.hasAttribute("colspan")?(E[B]=E[B]?E[B]+1:2,W.setAttribute("rowspan",E[B]),this._replace_cell(R,y+B)):(I=this._draw_td("TH",R,pe,y+B,r,o,B),I.td.style.display="",I.td.removeAttribute("rowspan"),I.td.removeAttribute("colspan"),I.metadata.row_header=g,I.metadata.row_header_x=B,I.metadata.y0=Math.floor(o.ridx_offset),I.metadata.y1=Math.ceil(o.y1),I.metadata._virtual_x=B,typeof f<"u"&&(I.metadata.x0=Math.floor(f)),E[B]=1,K[R]=1,T[B]=I)}else I=this._draw_td("TD",R,g,y,r,o,_),z&&(I.metadata.user=z[R]),I.metadata.x=typeof l>"u"?l:Math.floor(l),I.metadata.x1=Math.ceil(o.x1),I.metadata.row_header=re||[],I.metadata.y0=Math.floor(o.ridx_offset),I.metadata.y1=Math.ceil(o.y1),I.metadata.dx=Math.floor(l-f),I.metadata.dy=I.metadata.y-Math.floor(I.metadata.y0),I.metadata._virtual_x=y,typeof f<"u"&&(I.metadata.x0=Math.floor(f)),T[0]=I;if(R++,P=I?I.metadata:P,F=F||I?.td.offsetHeight,R*F>e)break}}return this._clean_rows(R),{tds:T,ridx:R,metadata:P,row_height:F}}clean({ridx:e,cidx:r}){this._clean_rows(e),this._clean_columns(r)}},Cr=class{constructor(e,r,o){this.clear(o);let[n]=o.children,[l,f]=n.children;this.table=n,this._column_sizes=r,this.header=new Wo(r,e,l),this.body=new Ho(r,e,f),this.fragment=document.createDocumentFragment()}num_columns(){return this.header.num_columns()}clear(e){e.innerHTML=Nr`
            <table cellspacing="0">
                <thead></thead>
                <tbody></tbody>
            </table>
        `}autosize_cells(e,r){for(;e.length>0;){let[o,n]=e.pop(),l=o.getBoundingClientRect();this._column_sizes.row_height=r||Math.max(10,Math.min(this._column_sizes.row_height||l.height,l.height)),this._column_sizes.indices[n.size_key]=l.width;let f=this._column_sizes.override[n.size_key]!==void 0;l.width&&!f&&(this._column_sizes.auto[n.size_key]=l.width),o.style.minWidth==="0px"&&(o.style.minWidth=`${l.width}px`)}}async*draw(e,r,o,n,l,f){let{width:_,height:p}=e,{view:y,config:L}=r,{data:m,row_headers:z,column_headers:F,metadata:P,column_header_merge_depth:E,merge_headers:T="both"}=await y(Math.floor(l.start_col),Math.floor(l.start_row),Math.ceil(l.end_col),Math.ceil(l.end_row)),R=T==="both"||T==="row",K=T==="both"||T==="column",{start_row:B=0,start_col:g=0,end_col:re=0,end_row:I=0}=l;z&&(this._row_headers_length=z.reduce((oe,Ne)=>Math.max(oe,Ne.length),0),z=z.map(oe=>(oe.length=this._row_headers_length,oe))),r.config.column_pivots=Array.from(Array(F?.[0]?.length||0).keys()),r.config.row_pivots=Array.from(Array(z?.[0]?.length||0).keys());let pe=this._column_sizes.indices[(this._row_headers_length||0)+Math.floor(l.start_col)]||0,W={viewport_width:0,selected_id:o,ridx_offset:B,sub_cell_offset:pe,x0:g,x1:re,y1:I,row_height:this._column_sizes.row_height,row_headers_length:this._row_headers_length},se,Q=0,ve=[],ne=!0;if(z?.length>0){let oe=L.row_pivots.join(","),Ne={column_name:oe,cidx:0,column_data:z,row_headers:z,first_col:ne},Ee=Q+Math.floor(g);se=this.body.draw(p,Ne,{...W,x0:0},!0,void 0,void 0,Ee,R);let Oe=[];for(let ce=0;ce<r.config.row_pivots.length;ce++){let ge=this.header.draw(oe,Array(r.config.column_pivots.length).fill(""),1,void 0,ce,g,ce,E,K);ge&&Oe.push(ge)}if(ne=!1,W.viewport_width+=Oe.reduce((ce,{th:ge},Ce)=>ce+(this._column_sizes.indices[Ce]||ge.offsetWidth),0),W.row_height=W.row_height||se.row_height,Q=z[0].length,!n)for(let ce=0;ce<r.config.row_pivots.length;ce++){let{td:ge,metadata:Ce}=se.tds[ce]||{},{th:Se,metadata:Pe}=Oe[ce]||{};(ge||Se)&&ve.push([Se||ge,Pe||Ce])}}try{let oe=0,Ne=f-l.start_col;for(;oe<Ne;){if(!m[oe]){let we=Math.max(l.end_col,0);l.start_col=we;let Le=0,$e=0;for(;this._column_sizes.indices.length>Q+g+Le+1&&$e+W.viewport_width<_;)Le++,$e+=this._column_sizes.indices[Q+g+Le];if($e+W.viewport_width<_){let fe=Math.min(f,we+5);l.end_col=Math.max(1,Math.min(f,fe))}else l.end_col=Math.max(1,Math.min(f,we+Le));let pt=y(Math.floor(l.start_col),Math.floor(l.start_row),Math.ceil(l.end_col),Math.ceil(l.end_row));yield void 0;let he=await pt;if(typeof he.column_header_merge_depth<"u"&&(E=he.column_header_merge_depth),typeof he.merge_headers<"u"&&(T=he.merge_headers),he.data.length===0){yield ve;return}l.end_col=l.start_col+he.data.length;for(let fe=0;fe<he.data.length;fe++)m[oe+fe]=he.data[fe],he.metadata&&(P[oe+fe]=he.metadata[fe]),F&&(F[oe+fe]=he.column_headers?.[fe])}let Ee=F?.[oe]||"",Oe=m[oe],ce=P?.[oe],ge={column_name:Ee,cidx:Q,column_data:Oe,column_data_listener_metadata:ce,row_headers:z,first_col:ne},Ce=oe+g,Se=Q+Math.floor(g),Pe=this.header.draw(void 0,Ee,void 0,Ce,Se,g,Q,E,K);if(se=this.body.draw(p,ge,W,!1,Ce,g,Se,R),ne=!1,!n)for(let{td:we,metadata:Le}of se.tds)ve.push([Pe?.th||we,Pe?.metadata||Le]);let Ve=this._column_sizes.indices[Q+Math.floor(g)];if(Ve?W.viewport_width+=Ve:W.viewport_width+=Pe?.th?.offsetWidth||se.tds.reduce((we,Le)=>we+Le.td?.offsetWidth,0),W.row_height=W.row_height||se.row_height,Q++,oe++,W.viewport_width-W.sub_cell_offset>_){this.body.clean({ridx:se?.ridx||0,cidx:Q}),this.header.clean(),yield ve,W.viewport_width=0;for(let[we]of ve)W.viewport_width+=we.offsetWidth;if(W.viewport_width-W.sub_cell_offset>_)return}}this.body.clean({ridx:se?.ridx||0,cidx:Q}),this.header.clean(),yield ve}finally{this.body.clean({ridx:se?.ridx||0,cidx:Q}),this.header.clean(),this.body._span_factory.reset(),this.header._span_factory.reset()}}},$o=["both","horizontal","vertical","none"],Bo=class extends Do{constructor(){super(),this._column_sizes={auto:[],override:[],indices:[]},this._style_callbacks=[],this._initialized=!1}connectedCallback(){this._initialized||(this.create_shadow_dom(),this.register_listeners(),this.setAttribute("tabindex","0"),this._initialized=!0,this.table_model=new Cr(this._table_clip,this._column_sizes,this))}_reset_viewport(){this._start_row=void 0,this._end_row=void 0,this._start_col=void 0,this._end_col=void 0}_reset_scroll(){this._column_sizes.indices=[],this.scrollTop=0,this.scrollLeft=0,this._reset_viewport()}_resetAutoSize(){this._column_sizes.auto=[],this._column_sizes.override=[],this._column_sizes.indices=[];for(let e=0;e<this.table_model.header.num_columns();e++){let r=this.table_model.header.get_column_header(e);r.style.minWidth="",r.style.maxWidth=""}}clear(){this.table_model=new Cr(this._table_clip,this._column_sizes,this)}addStyleListener(e){this._style_callbacks=this._style_callbacks.concat(e);let r=!0;return()=>{if(!r)return;r=!1;let o=this._style_callbacks=this._style_callbacks.slice(),n=o.indexOf(e);o.splice(n,1)}}invalidate(){if(!this._is_styling)throw new Error("Cannot call `invalidate()` outside of a `StyleListener`");this._invalidated=!0}getMeta(e){if(!(typeof e>"u")){if(e instanceof HTMLElement)return We.get(e);if(e.row_header_x>=0){if(e.row_header_x<this._view_cache.config.row_pivots.length){let r=this.table_model.body._fetch_cell(e.y,e.row_header_x);return this.getMeta(r)}}else if(e.column_header_y>=0){if(e.column_header_y<this._view_cache.config.column_pivots.length){let r=this.table_model.body._fetch_cell(e.column_header_y,e.y);return this.getMeta(r)}}else return this.getMeta(this.table_model.body._fetch_cell(e.dy,e.dx+this.table_model._row_headers_length))}}getDrawFPS(){return Co()}async scrollToCell(e,r){if(!this._view_cache){console.warn("data listener not configured");return}let o=this._column_sizes.row_height||19,n=this._view_cache.config.column_pivots.length*o,l=(this._table_clip.offsetHeight-n)%o,f=(this._virtual_panel.offsetHeight-l)/this._nrows;this.scrollTop=Math.ceil(f*r);let _=0;for(;e>0;)e--,_+=this._column_sizes.indices[e+this._view_cache.config.row_pivots.length]||60;this.scrollLeft=Math.ceil(_),await new Promise(requestAnimationFrame),await this._draw_flush()}setDataListener(e,{virtual_mode:r="both"}={}){let o={},n={row_pivots:[],column_pivots:[]};console.assert($o.indexOf(r)>-1,`Unknown virtual_mode ${r};  valid options are "both" (default), "horizontal", "vertical" or "none"`),this._virtual_mode=r,this._invalid_schema=!0,this._view_cache={view:e,config:n,schema:o},this._setup_virtual_scroll()}__noop_jsdoc_hints(){}};document.createElement("regular-table").constructor===HTMLElement&&window.customElements.define("regular-table",Bo);var Mt='regular-table{padding:0;margin:12px 0 0 12px;font-family:inherit;--rt-hover--border-color:var(--inactive--color,#c5c9d080);}regular-table div[tabindex]{outline:none;}regular-table>div{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;}regular-table th{text-align:center;}regular-table thead tr:not(.rt-autosize) th{overflow:hidden;max-width:0px;}regular-table thead tr:last-child .rt-float,regular-table tbody .rt-float{text-align:right;}regular-table thead .rt-integer,regular-table tbody .rt-integer{text-align:right;}regular-table tbody th{text-align:left;}regular-table span.rt-tree-container{display:flex;align-items:center;height:100%;}regular-table thead .rt-string,regular-table tbody .rt-string,regular-table thead .rt-date,regular-table tbody .rt-date,regular-table thead .rt-datetime,regular-table tbody .rt-datetime{text-align:left;}regular-table thead tr:last-child th{border-bottom:1px solid#8b868045;}regular-table tbody tr:first-child td,regular-table tbody tr:first-child th{border-top:1px solid transparent!important;}regular-table th{position:relative;}regular-table tr th span.rt-tree-group{margin-left:5px;margin-right:15px;border-left:1px solid#eee;height:100%;}regular-table td,regular-table th{white-space:nowrap;font-size:12px;padding-right:5px;padding-left:5px;padding-top:0px;padding-bottom:0px;height:19px;}regular-table table *{box-sizing:border-box;}regular-table table{position:absolute;color:#666;outline:none;}regular-table span.rt-row-header-icon{color:#aaa;padding-right:4px;font-family:var(--button--font-family);}regular-table span.rt-column-header-icon{font-size:10px;padding-left:3px;display:inline-block;width:10px;font-family:var(--button--font-family);}regular-table span.rt-row-header-icon:hover{color:#1a7da1;text-shadow:0px 0px 3px#1a7da1;}regular-table .rt-selected td{background-color:#eee;}regular-table .rt-cell-clip{overflow:hidden;text-overflow:ellipsis;}regular-table td span.rt-group-name,regular-table th span.rt-group-name{margin-right:-5px;padding-right:5px;padding-left:8px;flex:1;height:100%;}regular-table th span.rt-group-name{text-align:left;}regular-table td th span.rt-group-leaf,regular-table th span.rt-group-leaf{margin-left:16px;height:100%;}regular-table .rt-column-resize{height:100%;width:10px;position:absolute;top:0;right:0;cursor:col-resize;}regular-table a{color:var(--rt-pos-cell--color);}regular-table a:visited{color:var(--active--color);}.psp-header-border:not(.psp-is-top):not(.psp-header-leaf){box-shadow:1px 0px var(--inactive--border-color,#8b868045);}.psp-header-group{box-shadow:0px 10px 0 -9px var(--inactive--border-color,#8b868045);}.psp-is-top{box-shadow:5px 4px 0px -4px var(--inactive--border-color,#8b868045);}.psp-is-top.psp-header-group:not(.psp-header-group-corner){box-shadow:5px 4px 0px -4px var(--inactive--border-color,#8b868045),0px 10px 0 -9px var(--inactive--border-color,#8b868045);}.psp-header-border.psp-header-group:not(.psp-is-top):not(.psp-header-group-corner){box-shadow:1px 0px var(--inactive--border-color,#8b868045),0px 10px 0 -9px var(--inactive--border-color,#8b868045);}perspective-viewer[settings] tr.rt-autosize .psp-header-leaf.psp-header-border:not(.psp-menu-enabled){box-shadow:1px 0px var(--inactive--border-color,#8b868045);}:host-context(perspective-viewer[settings]) tr.rt-autosize .psp-header-leaf.psp-header-border:not(.psp-menu-enabled){box-shadow:1px 0px var(--inactive--border-color,#8b868045);}.psp-header-leaf.psp-header-border{box-shadow:5px -4px 0px -4px var(--inactive--border-color,#8b868045);}tr:only-child th{box-shadow:none!important;}regular-table tbody tr:hover th.psp-tree-leaf:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover th.psp-tree-label:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover td:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover:after{border-color:var(--rt-hover--border-color,#c5c9d080)!important;background-color:transparent;box-shadow:0px 1px 0px var(--rt-hover--border-color,#c5c9d080),0px 3px 0px rgba(0,0,0,0.05),0px 5px 0px rgba(0,0,0,0.01);}regular-table tbody tr:hover th.psp-tree-leaf.psp-menu-open:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover th.psp-tree-label.psp-menu-open:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover td.psp-menu-open:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr.psp-menu-open:hover:after{box-shadow:inset -2px 0px 0px var(--icon--color),inset 2px 0px 0px var(--icon--color),0px 1px 0px var(--rt-hover--border-color,#c5c9d080),0px 3px 0px rgba(0,0,0,0.05),0px 5px 0px rgba(0,0,0,0.01);}regular-table tbody tr:last-child:hover td.psp-menu-open:not(.psp-row-selected):not(.psp-row-subselected){box-shadow:inset -2px 0px 0px var(--icon--color),inset 2px 0px 0px var(--icon--color),inset 0px -2px 0px var(--icon--color),0px 1px 0px var(--rt-hover--border-color,#c5c9d080),0px 3px 0px rgba(0,0,0,0.05),0px 5px 0px rgba(0,0,0,0.01);}regular-table tbody tr:hover+tr th.psp-tree-leaf:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover+tr th.psp-tree-label:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover+tr td:not(.psp-row-selected):not(.psp-row-subselected){border-top-color:transparent;}regular-table tbody tr th:first-child:not(:empty),regular-table tbody tr th:first-child:empty+th:not(:empty),regular-table tbody tr th:first-child:empty~th:empty+th:not(:empty),regular-table tbody tr td:first-child{border-left-width:1px;border-left-color:transparent;}regular-table tbody tr th:last-child,regular-table tbody tr td:last-child{border-right-width:0px;border-right-color:transparent;}regular-table tbody tr:hover{color:inherit;}regular-table tbody tr:hover th:first-child:not(:empty),regular-table tbody tr:hover th:first-child:empty+th:not(:empty),regular-table tbody tr:hover th:first-child:empty~th:empty+th:not(:empty),regular-table tbody tr:hover td:first-child{border-left-color:var(--rt-hover--border-color,#c5c9d080)!important;}regular-table tbody tr:hover th:last-child,regular-table tbody tr:hover td:last-child{border-right-color:var(--rt-hover--border-color,#c5c9d080)!important;}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody td,perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table thead th:not(.rt-group-corner),:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody td,:host(:not(.sub-cell-scroll-disabled)) regular-table table thead th:not(.rt-group-corner){transform:translate(var(--regular-table--transform-x,0px));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody,:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody{transform:translate(0,var(--regular-table--transform-y,0px));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:first-child td,perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:first-child th,:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody tr:first-child td,:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody tr:first-child th{clip-path:polygon(0 var(--regular-table--clip-y,0),0 200%,200% 200%,200% var(--regular-table--clip-y,0));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr td:first-of-type,:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody tr td:first-of-type{clip-path:polygon(var(--regular-table--clip-x,0)0,var(--regular-table--clip-x,0)200%,200% 200%,200% 0);}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:first-child td:first-of-type,:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody tr:first-child td:first-of-type{clip-path:polygon(var(--regular-table--clip-x,0)var(--regular-table--clip-y,0),var(--regular-table--clip-x,0)200%,200% 200%,200% var(--regular-table--clip-y,0));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table thead tr:last-child:after,:host(:not(.sub-cell-scroll-disabled)) regular-table table thead tr:last-child:after{transform:translate(var(--regular-table--transform-x,0px));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:not(:first-child):after,:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody tr:not(:first-child):after{transform:translate(var(--regular-table--transform-x,0px));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:hover:first-child:after,:host(:not(.sub-cell-scroll-disabled)) regular-table table tbody tr:hover:first-child:after{clip-path:polygon(0 var(--regular-table--clip-y,0),0 200%,200% 200%,200% var(--regular-table--clip-y,0));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table thead tr th.rt-group-corner+th:not(.rt-group-corner),:host(:not(.sub-cell-scroll-disabled)) regular-table table thead tr th.rt-group-corner+th:not(.rt-group-corner){clip-path:polygon(var(--regular-table--clip-x,0)0,var(--regular-table--clip-x,0)200%,200% 200%,200% 0);}regular-table{outline:none;}regular-table::-webkit-scrollbar,regular-table::-webkit-scrollbar-corner{background-color:transparent;height:12px;width:12px;}regular-table::-webkit-scrollbar-thumb{background-clip:content-box;background:var(--icon--color);border:5.5px solid var(--plugin--background);max-height:50%;max-width:50%;min-width:10%;min-height:10%;}perspective-viewer:not([settings]) regular-table table tr.rt-autosize+tr th{height:0px;}perspective-viewer:not([settings]) regular-table table tr.rt-autosize+tr th span{display:none;}:host-context(perspective-viewer:not([settings])) regular-table table tr.rt-autosize+tr th{height:0px;}:host-context(perspective-viewer:not([settings])) regular-table table tr.rt-autosize+tr th span{display:none;}perspective-viewer[settings] .psp-menu-enabled{padding:0 6px;font-size:8px;border-radius:3px 3px 0 0;}perspective-viewer[settings] .psp-menu-enabled:hover,perspective-viewer[settings] tr:not(.rt-autosize) th.psp-menu-open{color:var(--plugin--background);background-color:var(--icon--color);border-bottom-color:var(--icon--color);cursor:pointer;}perspective-viewer[settings] tr:not(.rt-autosize) th.psp-menu-open:before{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;height:8px;width:10px;-webkit-mask-image:var(--column-settings-icon--mask-image);mask-image:var(--column-settings-icon--mask-image);margin-right:4px;background-color:var(--plugin--background);}perspective-viewer[settings] td.psp-menu-open{box-shadow:inset -2px 0px 0px var(--icon--color),inset 2px 0px 0px var(--icon--color);}perspective-viewer[settings] tr:first-child td.psp-menu-open{border-top-color:var(--icon--color)!important;}perspective-viewer[settings] tr:last-child td.psp-menu-open{box-shadow:inset -2px 0px 0px var(--icon--color),inset 2px 0px 0px var(--icon--color),inset 0px -2px 0px var(--icon--color);}:host-context(perspective-viewer[settings]) .psp-menu-enabled{padding:0 6px;font-size:8px;border-radius:3px 3px 0 0;}:host-context(perspective-viewer[settings]) .psp-menu-enabled:hover,:host-context(perspective-viewer[settings]) tr:not(.rt-autosize) th.psp-menu-open{color:var(--plugin--background);background-color:var(--icon--color);border-bottom-color:var(--icon--color);cursor:pointer;}:host-context(perspective-viewer[settings]) tr:not(.rt-autosize) th.psp-menu-open:before{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;height:8px;width:10px;-webkit-mask-image:var(--column-settings-icon--mask-image);mask-image:var(--column-settings-icon--mask-image);margin-right:4px;background-color:var(--plugin--background);}:host-context(perspective-viewer[settings]) td.psp-menu-open{box-shadow:inset -2px 0px 0px var(--icon--color),inset 2px 0px 0px var(--icon--color);}:host-context(perspective-viewer[settings]) tr:first-child td.psp-menu-open{border-top-color:var(--icon--color)!important;}:host-context(perspective-viewer[settings]) tr:last-child td.psp-menu-open{box-shadow:inset -2px 0px 0px var(--icon--color),inset 2px 0px 0px var(--icon--color),inset 0px -2px 0px var(--icon--color);}perspective-viewer regular-table table thead tr:last-child th{border-bottom-width:1px;border-bottom-color:var(--inactive--border-color,#8b868045);}:host-context(perspective-viewer) regular-table table thead tr:last-child th{border-bottom-width:1px;border-bottom-color:var(--inactive--border-color,#8b868045);}.psp-sort-enabled:hover{cursor:pointer;}.psp-row-selected,:hover .psp-row-selected,:hover th.psp-tree-leaf.psp-row-selected,:hover th.psp-tree-label.psp-row-selected{color:white!important;background-color:#ea7319!important;border-color:#ea7319!important;}.psp-row-selected.psp-tree-label:not(:hover):before{color:white;}.psp-row-subselected,:hover .psp-row-subselected,:hover th.psp-tree-leaf.psp-row-subselected,:hover th.psp-tree-label.psp-row-subselected{background:rgba(234,115,25,0.2)!important;}.psp-error{color:red;}td:focus{outline:#666;outline-style:dotted;outline-width:1px;}perspective-viewer.dragging regular-table{pointer-events:none;}:host-context(perspective-viewer.dragging) regular-table{pointer-events:none;}.psp-header-border:last-child{border-right-width:0px;}.psp-header-sort-desc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-desc-icon--mask-image);mask-image:var(--sort-desc-icon--mask-image);}.psp-header-sort-asc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-asc-icon--mask-image);mask-image:var(--sort-asc-icon--mask-image);}.psp-header-sort-col-desc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-col-desc-icon--mask-image);mask-image:var(--sort-col-desc-icon--mask-image);}.psp-header-sort-col-asc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-col-asc-icon--mask-image);mask-image:var(--sort-col-asc-icon--mask-image);}tbody th:last-of-type{border-right:1px solid var(--inactive--border-color,#8b868045);overflow:hidden;text-overflow:ellipsis;}tbody th:empty{background-image:linear-gradient(to right,transparent 9px,var(--inactive--border-color,#eee)10px,transparent 11px);background-repeat:no-repeat;min-width:20px;max-width:20px;pointer-events:none;}.psp-tree-label{max-width:0px;min-width:0px;}.psp-tree-label:before{color:var(--icon--color);font-family:var(--button--font-family,inherit);padding-right:11px;}.psp-tree-label-expand:before{content:var(--tree-label-expand--content,"+");}.psp-tree-label-collapse:before{content:var(--tree-label-collapse--content,"-");}.psp-tree-label-expand,.psp-tree-label-collapse{cursor:pointer;}.psp-tree-label:hover:before{color:var(--active--color);text-shadow:0px 0px 5px var(--active--color);}.psp-tree-leaf{padding-left:24px;}.psp-align-right{text-align:right;}.psp-align-left{text-align:left;}.psp-positive:not(:focus){color:var(--rt-pos-cell--color);}.psp-negative:not(:focus){color:var(--rt-neg-cell--color);}regular-table table tbody td{min-width:52px!important;}.psp-is-width-override .rt-column-resize,.rt-column-resize:hover{border:1px dashed#999;border-bottom-width:0px;border-left-width:0px;}.boolean-editable{cursor:pointer;}regular-table table{user-select:none;color:inherit;border-collapse:separate;}regular-table table th{font-weight:400;}regular-table table td,regular-table table th{border-color:var(--inactive--border-color,#8b868045);height:23px;}regular-table table .psp-header-group{text-overflow:ellipsis;}regular-table table th.psp-header-leaf{border-bottom-width:0px;}regular-table table th.psp-header-leaf span{height:23px;min-height:23px;}regular-table table td,regular-table table th.psp-tree-label,regular-table table th.psp-tree-label,regular-table table th.psp-tree-leaf,regular-table table tbody tr:first-child th{border-style:solid;border-width:0px;border-top-width:1px;}regular-table table tbody th:empty{background-position:0px -10px;}perspective-viewer:not([settings]) regular-table #psp-column-edit-buttons:after{content:none;}:host-context(perspective-viewer:not([settings])) regular-table #psp-column-edit-buttons:after{content:none;}regular-table table thead tr:last-child:after{width:10000px;box-sizing:border-box;display:block;height:23px;content:"";border-bottom:1px solid var(--inactive--border-color);}regular-table table tbody tr:after{width:10000px;box-sizing:border-box;display:block;height:23px;content:"";border-top:1px solid transparent;}regular-table table tbody tr:not(:first-child):after{border-top:1px solid var(--inactive--border-color);}regular-table table tbody tr:hover:not(:first-child):after{border-top:1px solid var(--rt-hover--border-color);}regular-table table tbody tr:hover+tr:after{border-top:1px solid var(--rt-hover--border-color);}@keyframes pulse_pos{0%{background-color:var(--pulse--background-color-start,rgba(0,128,255,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(0,128,255,0));}}@keyframes pulse_pos2{0%{background-color:var(--pulse--background-color-start,rgba(0,128,255,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(0,128,255,0));}}@keyframes pulse_neg{0%{background-color:var(--pulse--background-color-start,rgba(255,25,0,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(255,25,0,0));}}@keyframes pulse_neg2{0%{background-color:var(--pulse--background-color-start,rgba(255,25,0,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(255,25,0,0));}}';function Go(e){return e.x>=0?this._column_types[e.x]:this._row_header_types[e.row_header_x-1]}function Gt(e,r,o){let n=Array.from(e.children[0].children[0].children),l=n.length;l<=1?n[0]?.removeAttribute("id"):n.forEach((_,p)=>{let y=p===l-2?"psp-column-titles":p===l-1?"psp-column-edit-buttons":null;y?_.setAttribute("id",y):_.removeAttribute("id")});let f=r.hasAttribute("settings");if(r.classList.toggle("psp-menu-open",!!o),f&&l>=2){let _=Array.from(n[l-2].children),p=Array.from(n[l-1].children);if(_&&p){n.slice(0,l-2).forEach(y=>{Array.from(y.children).forEach(L=>{L.classList.toggle("psp-menu-open",!1)})});for(let y=0;y<_.length;y++){let L=_[y],m=p[y],z=L.innerText===o;if(L.classList.toggle("psp-menu-open",z),m.classList.toggle("psp-menu-open",z),this._config.columns.length>1)for(let F of e.querySelectorAll("td")){let P=e.getMeta(F),E=P.column_header[P.column_header.length-2]===o;F.classList.toggle("psp-menu-open",E)}}}}}function Tr(e,r){let o=Array.from(e.children[0].children[0].children);if(o.length>0){Gt.call(this,e,r,this._column_settings_selected_column);let[n]=o.splice(this._config.split_by.length,1);Fr.call(this,e,n,!1);let[l]=o.splice(this._config.split_by.length,1);l&&Fr.call(this,e,l,!0)}}function Fr(e,r,o){let n=e._view_cache.config.row_pivots.length-1;for(let l of r?.children){let f=e.getMeta(l),_=f.column_header?.[this._config.split_by.length],p=this._config.sort.find(T=>T[0]===_),y=f.row_header_x===n,L=typeof f.x>"u";y=y||(f.x+1)%this._config.columns.length===0,l.classList.toggle("psp-header-border",y),l.classList.toggle("psp-header-group",!1),l.classList.toggle("psp-header-leaf",!0),l.classList.toggle("psp-is-top",!1),l.classList.toggle("psp-header-corner",L),l.classList.toggle("psp-header-sort-asc",!o&&!!p&&p[1]==="asc"),l.classList.toggle("psp-header-sort-desc",!o&&!!p&&p[1]==="desc"),l.classList.toggle("psp-header-sort-col-asc",!o&&!!p&&p[1]==="col asc"),l.classList.toggle("psp-header-sort-col-desc",!o&&!!p&&p[1]==="col desc");let m=Go.call(this,f),z=m==="integer"||m==="float",F=m==="string",P=m==="date",E=m==="datetime";l.classList.toggle("psp-align-right",z),l.classList.toggle("psp-align-left",!z),l.classList.toggle("psp-menu-enabled",(F||z||P||E)&&!L&&f.column_header_y==this._config.split_by.length+1),l.classList.toggle("psp-sort-enabled",(F||z||P||E)&&!L&&f.column_header_y===this._config.split_by.length),l.classList.toggle("psp-is-width-override",e._column_sizes?.override[f.size_key]!==void 0)}}function Rr(e){let r=e._view_cache.config.row_pivots.length-1,o=Array.from(e.children[0].children[0].children),n=[],l=new Set,f=e.children[0];for(let _=0;_<o.length;_++){let p=f.rows[_],y=new Set;for(let L=0;L<p.cells.length;L++){let m=p.cells[L];m.style.backgroundColor="";let z=e.getMeta(m),F=z.row_header_x===r||z.x>=0;m.classList.toggle("psp-align-right",!1),m.classList.toggle("psp-align-left",!1),m.classList.toggle("psp-header-group",!0),m.classList.toggle("psp-header-leaf",!1),m.classList.toggle("psp-header-border",F),m.classList.toggle("psp-header-group-corner",typeof z.x>"u"),m.classList.toggle("psp-color-mode-bar",!1),m.classList.toggle("psp-header-sort-asc",!1),m.classList.toggle("psp-header-sort-desc",!1),m.classList.toggle("psp-header-sort-col-asc",!1),m.classList.toggle("psp-header-sort-col-desc",!1),m.classList.toggle("psp-sort-enabled",!1);let P=p.cells[L],E=L,T,R;for(;n[_]&&n[_][E];++E);for(y.add(E),T=E;T<E+P.colSpan;++T)for(R=_;R<_+P.rowSpan;++R)n[R]||(n[R]=[]),n[R][T]=!0;P.classList.toggle("psp-is-top",_===0||!l.has(T))}l=y}}var ye=Symbol("Plugin Symbol");function Ir(e,r,[,,,,,o,n],[,,,,,l,f],_){let p=this._ids?.[e.dy]?.join("|"),y=(_?e.column_header.slice(0,-1):e.column_header).join("|");if(this.last_reverse_columns?.has(y)&&this.last_reverse_ids?.has(p)){let L=this.last_reverse_ids?.get(p),m=this.last_reverse_columns.get(y);this._is_old_viewport?this.last_meta?.[m]?.[L]>e.user?(r.style.setProperty("--pulse--background-color-start",l),r.style.setProperty("--pulse--background-color-end",f),r.style.animationName==="pulse_neg"?r.style.animation="pulse_neg2 0.5s linear":r.style.animation="pulse_neg 0.5s linear"):this.last_meta?.[m]?.[L]<e.user?(r.style.setProperty("--pulse--background-color-start",o),r.style.setProperty("--pulse--background-color-end",n),r.style.animationName==="pulse_pos"?r.style.animation="pulse_pos2 0.5s linear":r.style.animation="pulse_pos 0.5s linear"):L!==e.dy&&(r.style.animation=""):r.style.animation=""}else r.style.animation=""}var Yt=kt(ut());function Vt(e,r){return Yt.default.mix(e,`rgb(${r[0]},${r[1]},${r[2]})`,.5).hex()}function Ie([e,r,o,n],l=[255,255,255]){function f(_,p){return((1-n)*(l[_]/255)+n*(p/255))*255}return[f(0,e),f(1,r),f(2,o)]}function De([e,r,o]){return Math.sqrt(e*e*.299+r*r*.587+o*o*.114)>130?"#161616":"#ffffff"}function Yo(e){let[r,o,n]=e.rgb(),[l,f,_]=e.set("hsl.h",(e.get("hsl.h")-15)%360).rgb(),[p,y,L]=e.set("hsl.h",(e.get("hsl.h")+15)%360).rgb();return`linear-gradient(to right top,rgb(${l},${f},${_}),rgb(${r},${o},${n}) 50%,rgb(${p},${y},${L}))`}function ke(e){let r=(0,Yt.default)(e),o=Yo(r),n=r.rgb();return[e,...n,o,`rgba(${n[0]},${n[1]},${n[2]},1)`,`rgba(${n[0]},${n[1]},${n[2]},0)`]}function Dr(e,r,o,n){let l=o.user>0,f=o.user<0,_;e?.pos_bg_color!==void 0?_=e.pos_bg_color:_=this._pos_bg_color;let p;e?.neg_bg_color!==void 0?p=e.neg_bg_color:p=this._neg_bg_color;let y=l?_:f?p:["",...this._plugin_background,""];{let[E,T,R,K,B]=y;if(r.style.position="",e?.number_bg_mode==="color")r.style.animation="",r.style.backgroundColor=E;else if(e?.number_bg_mode==="gradient"){let g=Math.max(0,Math.min(1,Math.abs(o.user/e.bg_gradient))),re=this._plugin_background,I=De(Ie([T,R,K,g],re));r.style.animation="",r.style.color=I,r.style.backgroundColor=`rgba(${T},${R},${K},${g})`}else e?.number_bg_mode==="pulse"?(Ir.call(this,o,r,_,p,n),r.style.backgroundColor=""):(e?.number_bg_mode==="disabled"||e?.number_bg_mode,r.style.animation="",r.style.backgroundColor="")}let[L,m,z,F,P]=(()=>e?.pos_fg_color!==void 0?l?e.pos_fg_color:f?e.neg_fg_color:["",...this._plugin_background,""]:l?this._pos_fg_color:f?this._neg_fg_color:["",...this._plugin_background,""])();if(e?.number_fg_mode==="disabled")if(e?.number_bg_mode==="color"){let E=this._plugin_background,T=De(Ie([y[1],y[2],y[3],1],E));r.style.color=T}else e?.number_bg_mode==="gradient"||(r.style.color="");else e?.number_fg_mode==="bar"?(r.style.color="",r.style.position="relative",P!==""&&r.children.length>0&&r.children[0].nodeType===Node.ELEMENT_NODE&&(r.children[0].style.background=P)):(e?.number_fg_mode==="color"||!e?.number_fg_mode)&&(r.style.color=L)}var Xt=kt(ut());function jr(e,r,o){let n=o.column_header?.[this._config.split_by.length],[l,f,_,p,y]=(()=>e?.color!==void 0?e.color:this._color)();if(e?.string_color_mode==="foreground"&&o.user!==null)r.style.color=l,r.style.backgroundColor="",e?.format==="link"&&(r.children[0].style.color=l);else if(e?.string_color_mode==="background"&&o.user!==null){let L=this._plugin_background,m=De(Ie([f,_,p,1],L));r.style.color=m,r.style.backgroundColor=l}else if(e?.string_color_mode==="series"&&o.user!==null){this._series_color_map.has(n)||(this._series_color_map.set(n,new Map),this._series_color_seed.set(n,0));let L=this._series_color_map.get(n);if(!L.has(o.user)){let I=this._series_color_seed.get(n);L.set(o.user,I),this._series_color_seed.set(n,I+1)}let m=L.get(o.user),[z,F,P]=(0,Xt.default)(l).hsl();z=z+m*150%360;let E=(0,Xt.default)(z,F,P,"hsl"),[T,R,K]=E.rgb(),B=E.hex(),g=this._plugin_background,re=De(Ie([T,R,K,1],g));r.style.color=re,r.style.backgroundColor=B}else r.style.backgroundColor="",r.style.color=""}var Ls=kt(ut());function Wr(e,r,o){let n=o.column_header?.[this._config.split_by.length],[l,f,_,p,y]=(()=>e?.color!==void 0?e.color:this._color)();if(e?.datetime_color_mode==="foreground"&&o.user!==null)r.style.color=l,r.style.backgroundColor="";else if(e?.datetime_color_mode==="background"&&o.user!==null){let L=this._plugin_background,m=De(Ie([f,_,p,1],L));r.style.color=m,r.style.backgroundColor=l}else r.style.backgroundColor="",r.style.color=""}function Hr(e,r,o){let[n]=o.user===!0?this._pos_fg_color:o.user===!1?this._neg_fg_color:["",0,0,0,""];r.style.backgroundColor="",r.style.color=n}function $r(e,r,o){let n=typeof o.value!=null&&typeof o.value!=null&&o.value?.toString()?.trim().length>0,l=o.row_header_x>=this._config.group_by.length,f=e.getMeta({dx:0,dy:o.y-o.y0+1}),_=f&&f.row_header&&typeof f.row_header[o.row_header_x+1]<"u";r.classList.toggle("psp-tree-label",n&&!l),r.classList.toggle("psp-tree-label-expand",n&&!l&&!_),r.classList.toggle("psp-tree-label-collapse",n&&!l&&_),r.classList.toggle("psp-tree-leaf",n&&l)}function Vo(e){return e.x>=0?this._column_types[e.x]:this._row_header_types[e.row_header_x-1]}function Br(e,r){let o=e[ye]||{},n=r.hasAttribute("settings");for(let l of e.children[0].children[1].children)for(let f of l.children){let _=e.getMeta(f),p=_.column_header?.[this._config.split_by.length],y=Vo.call(this,_),L=o[p],m=y==="integer"||y==="float";m?Dr.call(this,L,f,_,n):y==="boolean"?Hr.call(this,L,f,_):y==="string"?jr.call(this,L,f,_):y==="date"||y==="datetime"?Wr.call(this,L,f,_):(f.style.backgroundColor="",f.style.color=""),f.classList.toggle("psp-bool-type",y==="boolean"&&_.user!==null);let z=f.tagName==="TH";z&&$r.call(this,e,f,_),f.classList.toggle("psp-align-right",!z&&m),f.classList.toggle("psp-align-left",z||!m),f.classList.toggle("psp-color-mode-bar",L?.number_fg_mode==="bar"&&m)}}async function qr(e,r,o,n){let f=e.getMeta(n).column_header[this._config.split_by.length],p=(o.shiftKey?Xo:Uo).call(this,f);this._preserve_focus_state=!0,await r.restore({sort:p})}function Xo(e){let r=[],o=!1;for(let n of this._config.sort){let[l,f]=n;if(l===e){o=!0;let _=Gr.call(this,e,f);_&&r.push(_)}else r.push(n)}return o||r.push([e,"desc"]),r}function Uo(e){for(let[r,o]of this._config.sort)if(r===e){let n=Gr.call(this,e,o);return n?[n]:[]}return[[e,"desc"]]}function Gr(e,r){let n=this._config.split_by.length>0?Zo:Ko,l=r?n[r]:"desc";if(l)return[e,l]}var Ko={desc:"asc",asc:void 0},Zo={desc:"asc",asc:"col desc","col desc":"col asc","col asc":void 0};async function Yr(e,r){let o=e.getMeta(r.target),n=r.target.classList.contains("psp-tree-label-collapse");r.shiftKey&&n?this._view.set_depth(o.row_header.filter(l=>l!==void 0).length-2):r.shiftKey?this._view.set_depth(o.row_header.filter(l=>l!==void 0).length-1):n?this._view.collapse(o.y):this._view.expand(o.y),this._num_rows=await this._view.num_rows(),this._num_columns=await this._view.num_columns(),e.draw()}async function Vr(e,r,o){if(o.which!==1)return;let n=o.target;if(n.tagName!=="A"){for(;n.tagName!=="TD"&&n.tagName!=="TH";)if(n=n.parentElement,!e.contains(n))return;if(n.classList.contains("psp-tree-label")){Yr.call(this,e,o),o.stopImmediatePropagation();return}if(n.classList.contains("psp-menu-enabled")){let f=e.getMeta(n).column_header?.[this._config.split_by.length];await r.toggleColumnSettings(f),o.preventDefault(),o.stopImmediatePropagation()}else n.classList.contains("psp-sort-enabled")&&(qr.call(this,e,r,o,n),o.stopImmediatePropagation())}}function Xr(e,r){if(r.which!==1)return;let o=r.target;for(;o.tagName!=="TD"&&o.tagName!=="TH";)if(o=o.parentElement,!e.contains(o))return;(o.classList.contains("psp-tree-label")&&r.offsetX<26||o.classList.contains("psp-header-leaf")&&!o.classList.contains("psp-header-corner"))&&r.stopImmediatePropagation()}function Ur(e,r=!1){let o=this._config.group_by.length===0&&this._config.split_by.length===0,n=e.hasAttribute("selectable"),l=r||!!e.children[0]._is_edit_mode;return o&&!n&&l}function Kr(e,r,o){let n=e[ye]||{},l=Ur.call(this,r);o.classList.toggle("edit-mode-allowed",Ur.call(this,r,!0));for(let f of e.querySelectorAll("td")){let _=e.getMeta(f),p=this.get_psp_type(_);if(l&&this._is_editable[_.x]){let y=_.column_header[this._config.split_by.length];p==="string"&&n[y]?.format==="link"?(f.toggleAttribute("contenteditable",!1),f.classList.toggle("boolean-editable",!1)):p==="boolean"?(f.toggleAttribute("contenteditable",!1),f.classList.toggle("boolean-editable",_.user!==null)):(l!==f.hasAttribute("contenteditable")&&f.toggleAttribute("contenteditable",l),f.classList.toggle("boolean-editable",!1))}else f.toggleAttribute("contenteditable",!1),f.classList.toggle("boolean-editable",!1)}}var Et=(e,r,o)=>{let n=e.querySelectorAll("td"),l=o.get(e),f=e.getRootNode();if(l){for(let _ of n){let p=e.getMeta(_);if(p.x===l.x&&p.y===l.y)return f.activeElement!==_&&_.focus({preventScroll:!0}),!0}document.activeElement!==document.body&&e.contains(f.activeElement)&&f.activeElement.blur()}};function Jo(e){let r;return async function(...o){if(!!r&&await r&&!!r)return;let n;r=new Promise(l=>n=l),await e.apply(this,o),r=void 0,n()}}function Zr(){if(this.isContentEditable){let e=this.getRootNode().getSelection().getRangeAt(0),r=e.cloneRange();return r.selectNodeContents(this),r.setEnd(e.endContainer,e.endOffset),r.toString().length}else return this.target.selectionStart}function Ut(e,r,o){let n=e.getMeta(o),l=r._schema[r._column_paths[n.x]];if(n){let f=o.textContent,_=r._ids[n.y-n.y0];if(l==="float"||l==="integer"){if(f=parseFloat(f.replace(/,/g,"")),isNaN(f))return!1}else if(l==="date"||l==="datetime"){if(f=Date.parse(f),isNaN(f))return!1}else l==="boolean"&&(f=f==="true"?!1:f==="false"?!0:null);let p={__INDEX__:_,[r._column_paths[n.x]]:f};return r._table.update([p],{port_id:r._edit_port}),!0}}function St(e,r=!1){let o=this._config.group_by.length===0&&this._config.split_by.length===0,n=e.hasAttribute("selectable"),l=r||!!e.children[0]._is_edit_mode;return o&&!n&&l}var qe=Jo(async function(e,r,o,n,l){let f=e.getMeta(o),_=this._column_paths.length,p=this._num_rows,y=r.get(e);if(!y)return;f.x+n<_&&0<=f.x+n&&(y.x=f.x+n),f.y+l<p&&0<=f.y+l&&(y.y=f.y+l);let L=Math.max(f.x0-10,0),m=Math.min(f.x0+10,_),z=Math.max(f.y0-5,0),F=Math.min(f.y0+10,p),P=f.x0+n,E=f.y0+l;for(;!Et(e,void 0,r)&&P>=L&&P<m&&E>=z&&E<F;)await e.scrollToCell(P,E,_,p),r.set(e,y),P+=n,E+=l});function Jr(e,r,o,n){if(!St.call(this,r))return;let l=e.getRootNode().activeElement;switch(n.target.classList.remove("psp-error"),n.key){case"Enter":n.preventDefault(),n.shiftKey?qe.call(this,e,o,l,0,-1):qe.call(this,e,o,l,0,1);break;case"ArrowLeft":Zr.call(l)==0&&(n.preventDefault(),qe.call(this,e,o,l,-1,0));break;case"ArrowUp":n.preventDefault(),qe.call(this,e,o,l,0,-1);break;case"ArrowRight":Zr.call(l)==l.textContent.length&&(n.preventDefault(),qe.call(this,e,o,l,1,0));break;case"ArrowDown":n.preventDefault(),qe.call(this,e,o,l,0,1);break;default:}}function Qr(e,r,o){let n=e.getMeta(o.target);if(typeof n?.x<"u"){let l=St.call(this,r),f=this._is_editable[n.x],_=this.get_psp_type(n)==="boolean",p=o.target.textContent==="-";l&&f&&_&&!p&&Ut(e,this,o.target)}}function eo(e,r,o,n){if(St.call(this,r)&&o.has(e)){n.target.classList.remove("psp-error");let l=o.get(e);o.delete(e),l.content!==n.target.textContent&&(Ut(e,this,n.target)||(n.target.textContent=l.content,n.target.classList.add("psp-error"),n.target.focus()))}}function to(e,r,o,n){let l=e.getMeta(n.target);if(l){let f={x:l.x,y:l.y,content:n.target.textContent};o.set(e,f)}}async function _t({_view:e,_config:r},o,n){let l=r.group_by,f=r.split_by,_=o>=0?o:0,p=_+1,y=await e.to_json({start_row:_,end_row:p}),m=y.map(K=>K.__ROW_PATH__)[0]||[],z=l.map((K,B)=>{let g=m[B];return g?[K,"==",g]:void 0}).filter(K=>K),F=l.length>0?n+1:n,P=Object.keys(y[0])[F],E={row:y[0]},T=[];if(P){let K=P.split("|");E.column_names=[K[f.length]],T=f.map((B,g)=>{let re=K[g];return re?[B,"==",re]:void 0}).filter(B=>B).filter(([,,B])=>B!=="__ROW_PATH__")}let R=r.filter.concat(z).concat(T);return E.config={filter:R},E}async function ro(e,r,o,n){let l=e.getMeta(n.target);if(!r.hasAttribute("selectable")||n.handled||n.which!==1||!l)return;let f=this._ids[l.y-l.y0];if(l&&l.y>=0){let _=o.get(e),p=!!_&&_.reduce((P,E,T)=>P&&E===f[T],!0),y=!!_&&f.length===_.length&&p,L={selected:!y},{row:m,column_names:z,config:F}=await _t(this,l.y,l.x);y?(o.delete(e),L={...L,row:m,config:{filter:structuredClone(this._config.filter)}}):(o.set(e,f),L={...L,row:m,column_names:z,config:F}),await e.draw({preserve_width:!0}),n.handled=!0,r.dispatchEvent(new CustomEvent("perspective-select",{bubbles:!0,composed:!0,detail:L}))}}function oo(e,r,o){if(!r.hasAttribute("selectable"))return;let n=o.has(e),l=o.get(e);for(let f of e.querySelectorAll("td"))if(!n)f.classList.toggle("psp-row-selected",!1),f.classList.toggle("psp-row-subselected",!1);else{let _=e.getMeta(f),p=this._ids[_.y-_.y0],y=l.reduce((L,m,z)=>L&&m===p[z],!0);f.classList.toggle("psp-row-selected",p.length===l.length&&y),f.classList.toggle("psp-row-subselected",p.length!==l.length&&y)}for(let f of e.querySelectorAll("tbody th")){let _=e.getMeta(f),p=this._ids[_.y-_.y0];if(!n||!!p[_.row_header_x])f.classList.toggle("psp-row-selected",!1),f.classList.toggle("psp-row-subselected",!1);else{let y=l.reduce((L,m,z)=>L&&m===p[z],!0);f.classList.toggle("psp-row-selected",p.length===l.length&&y),f.classList.toggle("psp-row-subselected",p.length!==l.length&&y)}}}async function so(e,r,o){o.delete(e);for(let n of e.querySelectorAll("td,th"))n.classList.toggle("psp-row-selected",!1),n.classList.toggle("psp-row-subselected",!1)}var fo=kt(ut());var io={types:{float:{filter_operator:"==",aggregate:"sum",format:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}},string:{filter_operator:"==",aggregate:"count"},integer:{filter_operator:"==",aggregate:"sum",format:{}},boolean:{filter_operator:"==",aggregate:"count"},datetime:{filter_operator:"==",aggregate:"count",format:{dateStyle:"short",timeStyle:"medium"},null_value:-1},date:{filter_operator:"==",aggregate:"count",format:{dateStyle:"short"},null_value:-1}}};function Ge(e){let r={};if(lo().types[e]&&Object.assign(r,lo().types[e]),r.type){let o=Ge(r.type);return Object.assign(o,r),o}else return r}function Kt(e){return e&&typeof e=="object"&&!Array.isArray(e)}function Zt(e,...r){if(!r.length)return e;let o=r.shift();if(Kt(e)&&Kt(o))for(let n in o)Kt(o[n])?(e[n]||Object.assign(e,{[n]:{}}),Zt(e[n],o[n])):Object.assign(e,{[n]:o[n]});return Zt(e,...r)}function lo(){return globalThis.__PERSPECTIVE_CONFIG__||(globalThis.__PERSPECTIVE_CONFIG__=Zt(io,globalThis.__TEMPLATE_CONFIG__||{})),globalThis.__PERSPECTIVE_CONFIG__}var no={datetime:Intl.DateTimeFormat,date:Intl.DateTimeFormat,integer:Intl.NumberFormat,float:Intl.NumberFormat,boolean:class{format(e){return e?"true":"false"}}},At=class{constructor(){this._formatters=new Map}create_datetime_formatter(r,o){let n=Ge(r);if(r==="datetime")if(o.format!=="custom"){let l={...n.format,timeZone:o.timeZone,dateStyle:o.dateStyle,timeStyle:o.timeStyle};return l.dateStyle==="disabled"?l.dateStyle=void 0:l.dateStyle===void 0&&(l.dateStyle=n.format.dateStyle),l.timeStyle==="disabled"?l.timeStyle=void 0:l.timeStyle===void 0&&(l.timeStyle=n.format.timeStyle),new Intl.DateTimeFormat([],l)}else{let l={timeZone:o.timeZone,second:o.second,minute:o.minute,hour:o.hour,day:o.day,weekday:o.weekday,month:o.month,year:o.year,hour12:o.hour12,fractionalSecondDigits:o.fractionalSecondDigits};return l.year==="disabled"?l.year=void 0:l.year===void 0&&(l.year="2-digit"),l.month==="disabled"?l.month=void 0:l.month===void 0&&(l.month="numeric"),l.day==="disabled"?l.day=void 0:l.day===void 0&&(l.day="numeric"),l.weekday==="disabled"&&(l.weekday=void 0),l.hour==="disabled"?l.hour=void 0:l.hour===void 0&&(l.hour="numeric"),l.minute==="disabled"?l.minute=void 0:l.minute===void 0&&(l.minute="numeric"),l.second==="disabled"?l.second=void 0:l.second===void 0&&(l.second="numeric"),l.hour12===void 0&&(l.hour12=!0),new Intl.DateTimeFormat([],l)}else{let l={...n.format,dateStyle:o.dateStyle};return l.dateStyle==="disabled"?l.dateStyle=void 0:l.dateStyle===void 0&&(l.dateStyle=n.format.dateStyle),new Intl.DateTimeFormat([],l)}}create_number_formatter(r,o){let{format:n}=Ge(r);return o.fixed!==void 0&&(n.minimumFractionDigits=o.fixed,n.maximumFractionDigits=o.fixed),new no[r]([],n)}create_boolean_formatter(r,o){let n=Ge(r);return new no[r]([],n.format)}get(r,o){let n=[r,o.fixed,o.timeZone,o.dateStyle,o.timeStyle,o.fractionalSecondDigits,o.format,o.year,o.month,o.day,o.weekday,o.hour,o.minute,o.second,o.hour12].join("-");if(!this._formatters.has(n)){let l=Ge(r);r==="date"||r==="datetime"?this._formatters.set(n,this.create_datetime_formatter(r,o)):r==="integer"||r==="float"?this._formatters.set(n,this.create_number_formatter(r,o)):r==="boolean"?this._formatters.set(n,this.create_boolean_formatter(r,o)):this._formatters.set(n,!1)}return this._formatters.get(n)}};var Qo=new At,ao=1;function Ct(e,r,o={},n=!1){if(r===null)return"-";let l=n&&this._table_schema[e]||this._schema[e]||"string",f=o[e]||{};if((l==="integer"||l==="float")&&f?.number_fg_mode==="bar"){let p=Math.max(0,Math.min(ao,Math.abs(r/f.fg_gradient)*ao)),y=this._div_factory.get(),L=r>=0?"left":"right",m=(p*100).toFixed(2);return y.setAttribute("style",`width:calc(${m}% - 4px);position:absolute;${L}:2px;height:80%;top:10%;pointer-events:none;`),y}else if(f?.format==="link"&&l==="string"){let p=document.createElement("a");return p.setAttribute("href",r),p.setAttribute("target","_blank"),p.textContent=r,p}else if(f?.format==="bold"&&l==="string"){let p=document.createElement("b");return p.textContent=r,p}else if(f?.format==="italics"&&l==="string"){let p=document.createElement("i");return p.textContent=r,p}else{let p=Qo.get(l,f);return p?p.format(r):r}}function*co(e=[],r,o){let n=o[ye];for(let l of e){l=["TOTAL",...l];let f=l[l.length-1];l=l.slice(0,l.length-1).fill("");let _=Ct.call(this,r[l.length-1],f,n,!0);_ instanceof HTMLElement?l=l.concat(_):l=l.concat({toString:()=>_}),l.length=r.length+1,yield l}}function ho(e){let r,o,n,l,f;return async function(p,y,L,m,z){let F={},P;m-y>0&&z-L>0?(this._is_old_viewport=this._last_window?.start_row===L&&this._last_window?.end_row===z&&this._last_window?.start_col===y&&this._last_window?.end_col===m,P={start_row:L,start_col:y,end_row:z,end_col:m,id:!0},F=JSON.parse(await this._view.to_columns_string(P)),this._last_window=P,this._ids=F.__ID__,this._reverse_columns=this._column_paths.slice(y,m).reduce((g,re,I)=>(g.set(re,I),g),new Map),this._reverse_ids=this._ids.reduce((g,re,I)=>(g.set(re?.join("|"),I),g),new Map)):this._div_factory.clear();let E=[],T=[],R=[],K=[],B=e.hasAttribute("settings");for(let g=y;g<Math.min(m,this._column_paths.length);++g){let re=this._column_paths[g],I=re.split("|"),pe=F[re]||new Array(z-L).fill(null);E.push(pe.map(W=>Ct.call(this,I[this._config.split_by.length],W,p[ye]))),T.push(pe),B&&I.push("Edit"),R.push(I),K.push(re)}return m-y>0&&z-L>0&&(this.last_column_paths=o,this.last_meta=r,this.last_ids=n,this.last_reverse_ids=l,this.last_reverse_columns=f,o=K,r=T,n=this._ids,l=this._reverse_ids,f=this._reverse_columns),{num_rows:this._num_rows,num_columns:this._column_paths.length,row_headers:Array.from(co.call(this,F.__ROW_PATH__,this._config.group_by,p)),column_headers:R,data:E,metadata:T,column_header_merge_depth:Math.max(0,this._config.split_by.length)}}}function Nt(e,r,o){let n=window.getComputedStyle(e).getPropertyValue(r).trim();return n.length>0?n:o}var Jt=class{constructor(r){this._name=r,this._elements=[],this._index=0}clear(){this._index=0}get(){this._elements[this._index]||(this._elements[this._index]=document.createElement(this._name));let r=this._elements[this._index];return this._index+=1,r}};function es(e){return e.x>=0?this._column_types[e.x]:this._row_header_types[e.row_header_x-1]}async function Qt(e,r,o,n={}){let l=await o.get_config(),f=Object.fromEntries(l.expressions.map(Q=>[Q[0],Q[1]])),[_,p,y,L,m,z,F]=await Promise.all([r.schema(),r.validate_expressions(f),o.num_rows(),o.schema(),o.expression_schema(),o.column_paths(),this.parentElement.getEditPort()]),P=(0,fo.default)(Nt(e,"--plugin--background","#FFFFFF")).rgb(),E=ke(Nt(e,"--rt-pos-cell--color","#338DCD")),T=ke(Nt(e,"--rt-neg-cell--color","#FF5942")),R=ke(Vt(E[0],P)),K=ke(Vt(T[0],P)),B=ke(Nt(e,"--active--color","#ff0000")),g={...L,...m},re={..._,...p.expression_schema},I=z.filter(Q=>Q!=="__ROW_PATH__"&&Q!=="__ID__"),pe=[],W=[];for(let Q of I){let ne=Q.split("|")[l.split_by.length];W.push(g[ne]),pe.push(!!_[ne])}let se=Object.assign(n,{_edit_port:F,_view:o,_table:r,_table_schema:re,_config:l,_num_rows:y,_schema:g,_ids:[],_plugin_background:P,_color:B,_pos_fg_color:E,_neg_fg_color:T,_pos_bg_color:R,_neg_bg_color:K,_column_paths:I,_column_types:W,_is_editable:pe,_row_header_types:l.group_by.map(Q=>re[Q]),_series_color_map:new Map,_series_color_seed:new Map,get_psp_type:es});return se._div_factory=se._div_factory||new Jt("div"),e.setDataListener(ho(this.parentElement).bind(se,e),{virtual_mode:window.getComputedStyle(e).getPropertyValue("--datagrid-virtual-mode")?.trim()||"both"}),se}async function uo(e,r,o){let n=e.getMeta(o.target);if(!n)return;let{x:l,y:f}=n,{row:_,column_names:p,config:y}=await _t(this,f,l);r.dispatchEvent(new CustomEvent("perspective-click",{bubbles:!0,composed:!0,detail:{row:_,column_names:p,config:y}}))}async function _o(e){let r=this.parentElement,o=await r.getTable(!0);if(this._initialized)await Qt.call(this,this.regular_table,o,e,this.model);else{this.innerHTML="",this.shadowRoot?this.shadowRoot.appendChild(this.regular_table):this.appendChild(this.regular_table),this.model=await Qt.call(this,this.regular_table,o,e),this.regular_table.addStyleListener(Br.bind(this.model,this.regular_table,r)),this.regular_table.addStyleListener(Rr.bind(this.model,this.regular_table)),this.regular_table.addStyleListener(Tr.bind(this.model,this.regular_table,r)),this.regular_table.addEventListener("click",Xr.bind(this.model,this.regular_table)),this.regular_table.addEventListener("mousedown",Vr.bind(this.model,this.regular_table,r));let n=new WeakMap;this.regular_table.addStyleListener(oo.bind(this.model,this.regular_table,r,n)),this.regular_table.addEventListener("mousedown",ro.bind(this.model,this.regular_table,r,n)),this.regular_table.addEventListener("psp-deselect-all",so.bind(this.model,this.regular_table,r,n)),this.regular_table.addEventListener("click",uo.bind(this.model,this.regular_table,r));let l=new WeakMap;this.regular_table.addStyleListener(Kr.bind(this.model,this.regular_table,r,this)),this.regular_table.addStyleListener(Et.bind(this.model,this.regular_table,r,l)),this.regular_table.addEventListener("click",Qr.bind(this.model,this.regular_table,r)),this.regular_table.addEventListener("focusin",to.bind(this.model,this.regular_table,r,l)),this.regular_table.addEventListener("focusout",eo.bind(this.model,this.regular_table,r,l)),this.regular_table.addEventListener("keydown",Jr.bind(this.model,this.regular_table,r,l)),r.addEventListener("perspective-toggle-column-settings",f=>{if(this.isConnected){if(Gt.call(this.model,this.regular_table,r,f.detail.column_name),!f.detail.open){this.model._column_settings_selected_column=null;return}this.model._column_settings_selected_column=f.detail.column_name}}),this._initialized=!0}}function Ot(e,r=!1){if(!this._initialized)return;r&&(this._cached_column_sizes=e);let o={},{group_by:n,columns:l}=this.model._config,f=n?.length>0?n.length+1:0;for(let _ of Object.keys(e))if(_==="__ROW_PATH__")o[f-1]=e[_];else{let p=this.model._column_paths.indexOf(_);o[p+f]=e[_]}this.regular_table._column_sizes.override=o}function Pt(){if(!this._initialized)return[];if(this._cached_column_sizes){let f=this._cached_column_sizes;return this._cached_column_sizes=void 0,f}let e=this.regular_table._column_sizes.override,{group_by:r,columns:o}=this.model._config,n=r?.length>0?r.length+1:0,l={};for(let f of Object.keys(e))if(e[f]!==void 0){let _=f-n;_>-1?l[this.model._column_paths[_]]=e[f]:_===-1&&(l.__ROW_PATH__=e[f])}return l}function Ft(e=void 0){typeof e>"u"&&(e=!this._is_edit_mode),this._is_edit_mode=e,this.classList.toggle("editable",e),this._edit_mode!==void 0&&(this._edit_mode.classList.toggle("editable",e),e?this._edit_mode.children[0].textContent="Editable":this._edit_mode.children[0].textContent="Read Only")}function Tt(e=void 0){typeof e>"u"&&(e=!this._is_scroll_lock),this._is_scroll_lock=e,this.classList.toggle("sub-cell-scroll-disabled",e),this._scroll_lock!==void 0&&(this._scroll_lock.classList.toggle("lock-scroll",e),e?this._scroll_lock.children[0].textContent="Align Scroll":this._scroll_lock.children[0].textContent="Free Scroll")}function po(e){e=JSON.parse(JSON.stringify(e));let r={};if(e.columns)for(let n of Object.keys(e.columns)){let l=e.columns[n];l.column_size_override!==void 0&&(r[n]=l.column_size_override,delete l.column_size_override),l?.pos_fg_color&&(l.pos_fg_color=ke(l.pos_fg_color),l.neg_fg_color=ke(l.neg_fg_color)),l?.pos_bg_color&&(l.pos_bg_color=ke(l.pos_bg_color),l.neg_bg_color=ke(l.neg_bg_color)),l?.color&&(l.color=ke(l.color)),Object.keys(l).length===0&&delete e.columns[n]}"editable"in e&&Ft.call(this,e.editable),"scroll_lock"in e&&Tt.call(this,e.scroll_lock);let o=this.regular_table;Ot.call(this,r,!0),o[ye]=e.columns}function go(){if(this.regular_table){let e=this.regular_table,r={columns:{},scroll_lock:!!this._is_scroll_lock,editable:!!this._is_edit_mode};for(let n of Object.keys(e[ye]||{})){let l=Object.assign({},e[ye][n]);(l?.pos_fg_color||l?.pos_bg_color)&&(l.pos_fg_color=l.pos_fg_color?.[0],l.neg_fg_color=l.neg_fg_color?.[0],l.pos_bg_color=l.pos_bg_color?.[0],l.neg_bg_color=l.neg_bg_color?.[0]),l?.color&&(l.color=l.color[0]),r.columns[n]=l}let o=Pt.call(this);for(let n of Object.keys(o||{}))r.columns[n]||(r.columns[n]={}),r.columns[n].column_size_override=o[n];return JSON.parse(JSON.stringify(r))}return{}}async function bo(e){if(this.parentElement&&await this.activate(e),!this.isConnected||this.offsetParent==null)return;let r=Pt.call(this),o=this.regular_table.draw({invalid_columns:!0});this.model._preserve_focus_state?this.model._preserve_focus_state=!1:(this.regular_table.scrollTop=0,this.regular_table.scrollLeft=0,this.regular_table.dispatchEvent(new CustomEvent("psp-deselect-all",{bubbles:!1})),this.regular_table._resetAutoSize()),Ot.call(this,r),await o,this._toolbar.classList.toggle("aggregated",this.model._config.group_by.length>0||this.model._config.split_by.length>0)}function er(){let e=o=>{let n;return o==="integer"||o==="float"?n={fg_gradient:0,pos_fg_color:this.model._pos_fg_color[0],neg_fg_color:this.model._neg_fg_color[0],number_fg_mode:"color",bg_gradient:0,pos_bg_color:this.model._pos_bg_color[0],neg_bg_color:this.model._neg_bg_color[0],number_bg_mode:"disabled",fixed:o==="float"?2:0}:n={color:this.model._color[0],bg_color:this.model._color[0]},n},r={};for(let o of["string","float","integer","bool","date","datetime"])r[o]=e(o);return r}var He,tr=class extends HTMLElement{constructor(){super(),this.regular_table=document.createElement("regular-table"),this.regular_table.part="regular-table",this._is_scroll_lock=!1;let r=tr;r.renderTarget=="shadow"&&(Lt(r,He)||(Mr(r,He,new CSSStyleSheet),Lt(r,He).replaceSync(Mt)),this.attachShadow({mode:"open"}).adoptedStyleSheets.push(Lt(r,He)))}connectedCallback(){this._toolbar||(this._toolbar=document.createElement("perspective-viewer-datagrid-toolbar"));let r=this.parentElement;r&&r.appendChild(this._toolbar)}disconnectedCallback(){this._toolbar.parentElement.removeChild(this._toolbar)}async activate(r){return await _o.call(this,r)}get name(){return"Datagrid"}get category(){return"Basic"}get select_mode(){return"toggle"}get min_config_columns(){}get config_column_names(){return["Columns"]}get priority(){return 1}get plugin_attributes(){return{style:er.call(this)}}async draw(r){return await bo.call(this,r)}async update(r){this.model._num_rows=await r.num_rows(),await this.regular_table.draw()}async resize(){!this.isConnected||this.offsetParent==null||this._initialized&&await this.regular_table.draw()}async clear(){this.regular_table._resetAutoSize(),this.regular_table.clear()}save(){return go.call(this)}restore(r){return po.call(this,r)}async restyle(r){await this.draw(r)}delete(){this.regular_table.table_model&&this.regular_table._resetAutoSize(),this.regular_table.clear()}},Ye=tr;He=new WeakMap,kr(Ye,"renderTarget",window.CSS?.supports&&window.CSS?.supports("selector(:host-context(foo))")?"shadow":"light"),zr(Ye,He,void 0);var mo=':host{position:relative;display:block;}:host #container{position:absolute;display:flex;flex-direction:column;justify-content:stretch;align-items:stretch;top:0;left:0;right:0;bottom:0;}:host #toolbar{display:flex;align-items:center;height:36px;}:host #slot-container{flex:1;position:relative;}#scroll_lock.lock-scroll:before{-webkit-mask-image:var(--toolbar-scroll-lock-active--content);}#scroll_lock:before{-webkit-mask-image:var(--toolbar-scroll-lock--content);}#select_mode:before{content:"highlight_alt";}#edit_mode:before{-webkit-mask-image:var(--toolbar-edit-mode--content);}#edit_mode.editable:before{-webkit-mask-image:var(--toolbar-edit-mode-active--content);}:host(.aggregated) #toolbar #edit_mode{display:none;}.button:before{width:25px;height:21px;content:"";-webkit-mask-image:cover;mask-image:cover;background-color:var(--icon--color,#ccc);margin:0 5px;}.button.editable:before,.button.lock-scroll:before{color:inherit;}.button{display:inline-flex;align-items:center;user-select:none;width:37px;height:22px;box-sizing:border-box;white-space:nowrap;border:1px solid transparent;border-radius:3px;}.button>span{display:none;margin:0;padding:0;}.button:hover{background-color:var(--icon--color);color:var(--plugin--background);opacity:1;display:flex;align-items:center;cursor:pointer;min-width:var(--button--min-width,105px);}.button:hover:before{background-color:var(--plugin--background);margin:0 5px 0 5px;}.button:hover>span{display:contents;font-size:9px;line-height:36px;}';var Rt=class extends HTMLElement{connectedCallback(){if(this._initialized)return;this._initialized=!0,this.setAttribute("slot","plugin-settings"),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=`
            <style>
                ${mo}
            </style>
            <div id="toolbar">
                <span id="scroll_lock" class="button">
                    <span>Free Scroll</span>
                </span>
                <span id="edit_mode" class="button"><span>Read Only</span></span>
            </div>
        `;let r=this.parentElement,o=r.querySelector("perspective-viewer-datagrid");o._scroll_lock=this.shadowRoot.querySelector("#scroll_lock"),o._scroll_lock.addEventListener("click",()=>Tt.call(o)),o._edit_mode=this.shadowRoot.querySelector("#edit_mode"),o._edit_mode.addEventListener("click",()=>{Ft.call(o),o.regular_table.draw(),r.dispatchEvent(new Event("perspective-config-update"))})}};function rs(){let e=document.createElement("style");e.textContent=Mt,document.head.insertBefore(e,document.head.firstChild)}async function os(){customElements.define("perspective-viewer-datagrid-toolbar",Rt),customElements.define("perspective-viewer-datagrid",Ye),await customElements.whenDefined("perspective-viewer"),customElements.get("perspective-viewer").registerPlugin("perspective-viewer-datagrid")}os();rs();
/**
	ColorBrewer colors for chroma.js

	Copyright (c) 2002 Cynthia Brewer, Mark Harrower, and The 
	Pennsylvania State University.

	Licensed under the Apache License, Version 2.0 (the "License"); 
	you may not use this file except in compliance with the License.
	You may obtain a copy of the License at	
	http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed
	under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
	CONDITIONS OF ANY KIND, either express or implied. See the License for the
	specific language governing permissions and limitations under the License.

    @preserve
 */
/**
 * @license
 *
 * chroma.js - JavaScript library for color conversions
 * 
 * Copyright (c) 2011-2017, Gregor Aisch
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */
//# sourceMappingURL=perspective-viewer-datagrid.js.map
