(()=>{var xs=Object.defineProperty;var ks=(v,o)=>{for(var i in o)xs(v,i,{get:o[i],enumerable:!0})};var jr={},js=(()=>{var v=jr.url;return function(o={}){var i=typeof o<"u"?o:{},b,D;i.ready=new Promise(function(t,e){b=t,D=e});var j=Object.assign({},i),N=[],z="./this.program",G=(t,e)=>{throw e},fe=!0,F=!1,re="";function He(t){return i.locateFile?i.locateFile(t,re):re+t}var We,ut,Le,ze;(fe||F)&&(F?re=self.location.href:typeof document<"u"&&document.currentScript&&(re=document.currentScript.src),v&&(re=v),re.indexOf("blob:")!==0?re=re.substr(0,re.replace(/[?#].*/,"").lastIndexOf("/")+1):re="",We=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},F&&(Le=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),ut=(t,e,r)=>{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{if(n.status==200||n.status==0&&n.response){e(n.response);return}r()},n.onerror=r,n.send(null)},ze=t=>document.title=t);var ge=i.print||console.log.bind(console),I=i.printErr||console.warn.bind(console);Object.assign(i,j),j=null,i.arguments&&(N=i.arguments),i.thisProgram&&(z=i.thisProgram),i.quit&&(G=i.quit);var Te;i.wasmBinary&&(Te=i.wasmBinary);var Ye=i.noExitRuntime||!0;typeof WebAssembly!="object"&&Be("no native wasm support detected");var De,_e=!1,Rt;function s(t,e){t||Be(e)}var a=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function c(t,e,r){e>>>=0;for(var n=e+r,l=e;t[l]&&!(l>=n);)++l;if(l-e>16&&t.buffer&&a)return a.decode(t.subarray(e,l));for(var u="";e<l;){var _=t[e++];if(!(_&128)){u+=String.fromCharCode(_);continue}var f=t[e++]&63;if((_&224)==192){u+=String.fromCharCode((_&31)<<6|f);continue}var d=t[e++]&63;if((_&240)==224?_=(_&15)<<12|f<<6|d:_=(_&7)<<18|f<<12|d<<6|t[e++]&63,_<65536)u+=String.fromCharCode(_);else{var m=_-65536;u+=String.fromCharCode(55296|m>>10,56320|m&1023)}}return u}function h(t,e){return t>>>=0,t?c(R,t,e):""}function g(t,e,r,n){if(r>>>=0,!(n>0))return 0;for(var l=r,u=r+n-1,_=0;_<t.length;++_){var f=t.charCodeAt(_);if(f>=55296&&f<=57343){var d=t.charCodeAt(++_);f=65536+((f&1023)<<10)|d&1023}if(f<=127){if(r>=u)break;e[r++>>>0]=f}else if(f<=2047){if(r+1>=u)break;e[r++>>>0]=192|f>>6,e[r++>>>0]=128|f&63}else if(f<=65535){if(r+2>=u)break;e[r++>>>0]=224|f>>12,e[r++>>>0]=128|f>>6&63,e[r++>>>0]=128|f&63}else{if(r+3>=u)break;e[r++>>>0]=240|f>>18,e[r++>>>0]=128|f>>12&63,e[r++>>>0]=128|f>>6&63,e[r++>>>0]=128|f&63}}return e[r>>>0]=0,r-l}function O(t,e,r){return g(t,R,e,r)}function x(t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++r):e+=3}return e}var y,R,S,H,w,P,ne,te;function oe(){var t=De.buffer;i.HEAP8=y=new Int8Array(t),i.HEAP16=S=new Int16Array(t),i.HEAP32=w=new Int32Array(t),i.HEAPU8=R=new Uint8Array(t),i.HEAPU16=H=new Uint16Array(t),i.HEAPU32=P=new Uint32Array(t),i.HEAPF32=ne=new Float32Array(t),i.HEAPF64=te=new Float64Array(t)}var Se,Ge=[],ct=[],Q=[],ee=!1;function de(){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)ie(i.preRun.shift());xt(Ge)}function ae(){ee=!0,xt(ct)}function Z(){if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)Re(i.postRun.shift());xt(Q)}function ie(t){Ge.unshift(t)}function le(t){ct.unshift(t)}function Re(t){Q.unshift(t)}var B=0,Ne=null,Ce=null;function Ur(t){B++,i.monitorRunDependencies&&i.monitorRunDependencies(B)}function Hr(t){if(B--,i.monitorRunDependencies&&i.monitorRunDependencies(B),B==0&&(Ne!==null&&(clearInterval(Ne),Ne=null),Ce)){var e=Ce;Ce=null,e()}}function Be(t){i.onAbort&&i.onAbort(t),t="Aborted("+t+")",I(t),_e=!0,Rt=1,t+=". Build with -sASSERTIONS for more info.";var e=new WebAssembly.RuntimeError(t);throw D(e),e}var Wr="data:application/octet-stream;base64,";function tr(t){return t.startsWith(Wr)}var xe;i.locateFile?(xe="perspective.cpp.wasm",tr(xe)||(xe=He(xe))):xe=new URL("perspective.cpp.wasm",jr.url).href;function rr(t){try{if(t==xe&&Te)return new Uint8Array(Te);if(Le)return Le(t);throw"both async and sync fetching of the wasm failed"}catch(e){Be(e)}}function Lr(t){return!Te&&(fe||F)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+t+"'";return e.arrayBuffer()}).catch(function(){return rr(t)}):Promise.resolve().then(function(){return rr(t)})}function nr(t,e,r){return Lr(t).then(function(n){return WebAssembly.instantiate(n,e)}).then(function(n){return n}).then(r,function(n){I("failed to asynchronously prepare wasm: "+n),Be(n)})}function zr(t,e,r,n){return!t&&typeof WebAssembly.instantiateStreaming=="function"&&!tr(e)&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(function(l){var u=WebAssembly.instantiateStreaming(l,r);return u.then(n,function(_){return I("wasm streaming compile failed: "+_),I("falling back to ArrayBuffer instantiation"),nr(e,r,n)})}):nr(e,r,n)}function Yr(){var t={a:cs};function e(n,l){var u=n.exports;return i.asm=u,De=i.asm.ma,oe(),Se=i.asm.qa,le(i.asm.na),Hr("wasm-instantiate"),u}Ur("wasm-instantiate");function r(n){e(n.instance)}if(i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(n){I("Module.instantiateWasm callback failed with error: "+n),D(n)}return zr(Te,xe,t,r).catch(D),{}}var Gr={833172:t=>{throw new Error(h(t))}};function xt(t){for(;t.length>0;)t.shift()(i)}function Br(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(e){P[this.ptr+4>>>2]=e},this.get_type=function(){return P[this.ptr+4>>>2]},this.set_destructor=function(e){P[this.ptr+8>>>2]=e},this.get_destructor=function(){return P[this.ptr+8>>>2]},this.set_refcount=function(e){w[this.ptr>>>2]=e},this.set_caught=function(e){e=e?1:0,y[this.ptr+12>>>0]=e},this.get_caught=function(){return y[this.ptr+12>>>0]!=0},this.set_rethrown=function(e){e=e?1:0,y[this.ptr+13>>>0]=e},this.get_rethrown=function(){return y[this.ptr+13>>>0]!=0},this.init=function(e,r){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(r),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=w[this.ptr>>>2];w[this.ptr>>>2]=e+1},this.release_ref=function(){var e=w[this.ptr>>>2];return w[this.ptr>>>2]=e-1,e===1},this.set_adjusted_ptr=function(e){P[this.ptr+16>>>2]=e},this.get_adjusted_ptr=function(){return P[this.ptr+16>>>2]},this.get_exception_ptr=function(){var e=Pr(this.get_type());if(e)return P[this.excPtr>>>2];var r=this.get_adjusted_ptr();return r!==0?r:this.excPtr}}var qr=0,Jr=0;function Xr(t,e,r){var n=new Br(t);throw n.init(e,r),qr=t,Jr++,t}var qe={varargs:void 0,get:function(){qe.varargs+=4;var t=w[qe.varargs-4>>>2];return t},getStr:function(t){var e=h(t);return e}};function Zr(t,e,r){return qe.varargs=r,0}function Kr(t,e,r){}function Qr(t,e,r){}function en(t,e,r){return qe.varargs=r,0}function tn(t,e,r,n){qe.varargs=n}function rn(t,e){}var ft={};function kt(t){for(;t.length;){var e=t.pop(),r=t.pop();r(e)}}function Je(t){return this.fromWireType(w[t>>>2])}var Ie={},ke={},_t={},nn=48,sn=57;function dt(t){if(t===void 0)return"_unknown";t=t.replace(/[^a-zA-Z0-9_]/g,"$");var e=t.charCodeAt(0);return e>=nn&&e<=sn?"_"+t:t}function pt(t,e){return t=dt(t),{[t]:function(){return e.apply(this,arguments)}}[t]}function jt(t,e){var r=pt(e,function(n){this.name=e,this.message=n;var l=new Error(n).stack;l!==void 0&&(this.stack=this.toString()+`
`+l.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var ir=void 0;function ht(t){throw new ir(t)}function Ee(t,e,r){t.forEach(function(f){_t[f]=e});function n(f){var d=r(f);d.length!==t.length&&ht("Mismatched type converter count");for(var m=0;m<t.length;++m)pe(t[m],d[m])}var l=new Array(e.length),u=[],_=0;e.forEach((f,d)=>{ke.hasOwnProperty(f)?l[d]=ke[f]:(u.push(f),Ie.hasOwnProperty(f)||(Ie[f]=[]),Ie[f].push(()=>{l[d]=ke[f],++_,_===u.length&&n(l)}))}),u.length===0&&n(l)}function on(t){var e=ft[t];delete ft[t];var r=e.rawConstructor,n=e.rawDestructor,l=e.fields,u=l.map(_=>_.getterReturnType).concat(l.map(_=>_.setterArgumentType));Ee([t],u,_=>{var f={};return l.forEach((d,m)=>{var A=d.fieldName,E=_[m],C=d.getter,M=d.getterContext,W=_[m+l.length],L=d.setter,J=d.setterContext;f[A]={read:k=>E.fromWireType(C(M,k)),write:(k,p)=>{var T=[];L(J,k,W.toWireType(T,p)),kt(T)}}}),[{name:e.name,fromWireType:function(d){var m={};for(var A in f)m[A]=f[A].read(d);return n(d),m},toWireType:function(d,m){for(var A in f)if(!(A in m))throw new TypeError('Missing field:  "'+A+'"');var E=r();for(A in f)f[A].write(E,m[A]);return d!==null&&d.push(n,E),E},argPackAdvance:8,readValueFromPointer:Je,destructorFunction:n}]})}function an(t,e,r,n,l){}function mt(t){switch(t){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+t)}}function ln(){for(var t=new Array(256),e=0;e<256;++e)t[e]=String.fromCharCode(e);sr=t}var sr=void 0;function q(t){for(var e="",r=t;R[r>>>0];)e+=sr[R[r++>>>0]];return e}var Ve=void 0;function V(t){throw new Ve(t)}function pe(t,e,r={}){if(!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=e.name;if(t||V('type "'+n+'" must have a positive integer typeid pointer'),ke.hasOwnProperty(t)){if(r.ignoreDuplicateRegistrations)return;V("Cannot register type '"+n+"' twice")}if(ke[t]=e,delete _t[t],Ie.hasOwnProperty(t)){var l=Ie[t];delete Ie[t],l.forEach(u=>u())}}function un(t,e,r,n,l){var u=mt(r);e=q(e),pe(t,{name:e,fromWireType:function(_){return!!_},toWireType:function(_,f){return f?n:l},argPackAdvance:8,readValueFromPointer:function(_){var f;if(r===1)f=y;else if(r===2)f=S;else if(r===4)f=w;else throw new TypeError("Unknown boolean type size: "+e);return this.fromWireType(f[_>>>u])},destructorFunction:null})}function cn(t){if(!(this instanceof Ae)||!(t instanceof Ae))return!1;for(var e=this.$$.ptrType.registeredClass,r=this.$$.ptr,n=t.$$.ptrType.registeredClass,l=t.$$.ptr;e.baseClass;)r=e.upcast(r),e=e.baseClass;for(;n.baseClass;)l=n.upcast(l),n=n.baseClass;return e===n&&r===l}function fn(t){return{count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType}}function Ft(t){function e(r){return r.$$.ptrType.registeredClass.name}V(e(t)+" instance already deleted")}var $t=!1;function or(t){}function _n(t){t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)}function ar(t){t.count.value-=1;var e=t.count.value===0;e&&_n(t)}function lr(t,e,r){if(e===r)return t;if(r.baseClass===void 0)return null;var n=lr(t,e,r.baseClass);return n===null?null:r.downcast(n)}var ur={};function dn(){return Object.keys(Ke).length}function pn(){var t=[];for(var e in Ke)Ke.hasOwnProperty(e)&&t.push(Ke[e]);return t}var Xe=[];function Dt(){for(;Xe.length;){var t=Xe.pop();t.$$.deleteScheduled=!1,t.delete()}}var Ze=void 0;function hn(t){Ze=t,Xe.length&&Ze&&Ze(Dt)}function mn(){i.getInheritedInstanceCount=dn,i.getLiveInheritedInstances=pn,i.flushPendingDeletes=Dt,i.setDelayFunction=hn}var Ke={};function vn(t,e){for(e===void 0&&V("ptr should not be undefined");t.baseClass;)e=t.upcast(e),t=t.baseClass;return e}function gn(t,e){return e=vn(t,e),Ke[e]}function vt(t,e){(!e.ptrType||!e.ptr)&&ht("makeClassHandle requires ptr and ptrType");var r=!!e.smartPtrType,n=!!e.smartPtr;return r!==n&&ht("Both smartPtrType and smartPtr must be specified"),e.count={value:1},Qe(Object.create(t,{$$:{value:e}}))}function yn(t){var e=this.getPointee(t);if(!e)return this.destructor(t),null;var r=gn(this.registeredClass,e);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=e,r.$$.smartPtr=t,r.clone();var n=r.clone();return this.destructor(t),n}function l(){return this.isSmartPointer?vt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:e,smartPtrType:this,smartPtr:t}):vt(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var u=this.registeredClass.getActualType(e),_=ur[u];if(!_)return l.call(this);var f;this.isConst?f=_.constPointerType:f=_.pointerType;var d=lr(e,this.registeredClass,f.registeredClass);return d===null?l.call(this):this.isSmartPointer?vt(f.registeredClass.instancePrototype,{ptrType:f,ptr:d,smartPtrType:this,smartPtr:t}):vt(f.registeredClass.instancePrototype,{ptrType:f,ptr:d})}function Qe(t){return typeof FinalizationRegistry>"u"?(Qe=e=>e,t):($t=new FinalizationRegistry(e=>{ar(e.$$)}),Qe=e=>{var r=e.$$,n=!!r.smartPtr;if(n){var l={$$:r};$t.register(e,l,e)}return e},or=e=>$t.unregister(e),Qe(t))}function wn(){if(this.$$.ptr||Ft(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var t=Qe(Object.create(Object.getPrototypeOf(this),{$$:{value:fn(this.$$)}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t}function bn(){this.$$.ptr||Ft(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&V("Object already scheduled for deletion"),or(this),ar(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Tn(){return!this.$$.ptr}function Cn(){return this.$$.ptr||Ft(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&V("Object already scheduled for deletion"),Xe.push(this),Xe.length===1&&Ze&&Ze(Dt),this.$$.deleteScheduled=!0,this}function En(){Ae.prototype.isAliasOf=cn,Ae.prototype.clone=wn,Ae.prototype.delete=bn,Ae.prototype.isDeleted=Tn,Ae.prototype.deleteLater=Cn}function Ae(){}function cr(t,e,r){if(t[e].overloadTable===void 0){var n=t[e];t[e]=function(){return t[e].overloadTable.hasOwnProperty(arguments.length)||V("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+t[e].overloadTable+")!"),t[e].overloadTable[arguments.length].apply(this,arguments)},t[e].overloadTable=[],t[e].overloadTable[n.argCount]=n}}function Nt(t,e,r){i.hasOwnProperty(t)?((r===void 0||i[t].overloadTable!==void 0&&i[t].overloadTable[r]!==void 0)&&V("Cannot register public name '"+t+"' twice"),cr(i,t,t),i.hasOwnProperty(r)&&V("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),i[t].overloadTable[r]=e):(i[t]=e,r!==void 0&&(i[t].numArguments=r))}function An(t,e,r,n,l,u,_,f){this.name=t,this.constructor=e,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=l,this.getActualType=u,this.upcast=_,this.downcast=f,this.pureVirtualFunctions=[]}function It(t,e,r){for(;e!==r;)e.upcast||V("Expected null or instance of "+r.name+", got an instance of "+e.name),t=e.upcast(t),e=e.baseClass;return t}function On(t,e){if(e===null)return this.isReference&&V("null is not a valid "+this.name),0;e.$$||V('Cannot pass "'+Wt(e)+'" as a '+this.name),e.$$.ptr||V("Cannot pass deleted object as a pointer of type "+this.name);var r=e.$$.ptrType.registeredClass,n=It(e.$$.ptr,r,this.registeredClass);return n}function Pn(t,e){var r;if(e===null)return this.isReference&&V("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),t!==null&&t.push(this.rawDestructor,r),r):0;e.$$||V('Cannot pass "'+Wt(e)+'" as a '+this.name),e.$$.ptr||V("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&e.$$.ptrType.isConst&&V("Cannot convert argument of type "+(e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name)+" to parameter type "+this.name);var n=e.$$.ptrType.registeredClass;if(r=It(e.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(e.$$.smartPtr===void 0&&V("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:e.$$.smartPtrType===this?r=e.$$.smartPtr:V("Cannot convert argument of type "+(e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=e.$$.smartPtr;break;case 2:if(e.$$.smartPtrType===this)r=e.$$.smartPtr;else{var l=e.clone();r=this.rawShare(r,U.toHandle(function(){l.delete()})),t!==null&&t.push(this.rawDestructor,r)}break;default:V("Unsupporting sharing policy")}return r}function Sn(t,e){if(e===null)return this.isReference&&V("null is not a valid "+this.name),0;e.$$||V('Cannot pass "'+Wt(e)+'" as a '+this.name),e.$$.ptr||V("Cannot pass deleted object as a pointer of type "+this.name),e.$$.ptrType.isConst&&V("Cannot convert argument of type "+e.$$.ptrType.name+" to parameter type "+this.name);var r=e.$$.ptrType.registeredClass,n=It(e.$$.ptr,r,this.registeredClass);return n}function Rn(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t}function xn(t){this.rawDestructor&&this.rawDestructor(t)}function kn(t){t!==null&&t.delete()}function jn(){he.prototype.getPointee=Rn,he.prototype.destructor=xn,he.prototype.argPackAdvance=8,he.prototype.readValueFromPointer=Je,he.prototype.deleteObject=kn,he.prototype.fromWireType=yn}function he(t,e,r,n,l,u,_,f,d,m,A){this.name=t,this.registeredClass=e,this.isReference=r,this.isConst=n,this.isSmartPointer=l,this.pointeeType=u,this.sharingPolicy=_,this.rawGetPointee=f,this.rawConstructor=d,this.rawShare=m,this.rawDestructor=A,!l&&e.baseClass===void 0?n?(this.toWireType=On,this.destructorFunction=null):(this.toWireType=Sn,this.destructorFunction=null):this.toWireType=Pn}function fr(t,e,r){i.hasOwnProperty(t)||ht("Replacing nonexistant public symbol"),i[t].overloadTable!==void 0&&r!==void 0?i[t].overloadTable[r]=e:(i[t]=e,i[t].argCount=r)}function Fn(t,e,r){var n=i["dynCall_"+t];return r&&r.length?n.apply(null,[e].concat(r)):n.call(null,e)}var gt=[];function _r(t){var e=gt[t];return e||(t>=gt.length&&(gt.length=t+1),gt[t]=e=Se.get(t)),e}function $n(t,e,r){if(t.includes("j"))return Fn(t,e,r);var n=_r(e).apply(null,r);return n}function Dn(t,e){var r=[];return function(){return r.length=0,Object.assign(r,arguments),$n(t,e,r)}}function K(t,e){t=q(t);function r(){return t.includes("j")?Dn(t,e):_r(e)}var n=r();return typeof n!="function"&&V("unknown function pointer with signature "+t+": "+e),n}var dr=void 0;function pr(t){var e=Or(t),r=q(e);return ye(e),r}function yt(t,e){var r=[],n={};function l(u){if(!n[u]&&!ke[u]){if(_t[u]){_t[u].forEach(l);return}r.push(u),n[u]=!0}}throw e.forEach(l),new dr(t+": "+r.map(pr).join([", "]))}function Nn(t,e,r,n,l,u,_,f,d,m,A,E,C){A=q(A),u=K(l,u),f&&(f=K(_,f)),m&&(m=K(d,m)),C=K(E,C);var M=dt(A);Nt(M,function(){yt("Cannot construct "+A+" due to unbound types",[n])}),Ee([t,e,r],n?[n]:[],function(W){W=W[0];var L,J;n?(L=W.registeredClass,J=L.instancePrototype):J=Ae.prototype;var k=pt(M,function(){if(Object.getPrototypeOf(this)!==p)throw new Ve("Use 'new' to construct "+A);if(T.constructor_body===void 0)throw new Ve(A+" has no accessible constructor");var Fe=T.constructor_body[arguments.length];if(Fe===void 0)throw new Ve("Tried to invoke ctor of "+A+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(T.constructor_body).toString()+") parameters instead!");return Fe.apply(this,arguments)}),p=Object.create(J,{constructor:{value:k}});k.prototype=p;var T=new An(A,k,p,C,L,u,f,m),X=new he(A,T,!0,!1,!1),Y=new he(A+"*",T,!1,!1,!1),me=new he(A+" const*",T,!1,!0,!1);return ur[t]={pointerType:Y,constPointerType:me},fr(M,k),[X,Y,me]})}function Vt(t,e){for(var r=[],n=0;n<t;n++)r.push(P[e+n*4>>>2]);return r}function hr(t,e){if(!(t instanceof Function))throw new TypeError("new_ called with constructor type "+typeof t+" which is not a function");var r=pt(t.name||"unknownFunctionName",function(){});r.prototype=t.prototype;var n=new r,l=t.apply(n,e);return l instanceof Object?l:n}function Mt(t,e,r,n,l){var u=e.length;u<2&&V("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var _=e[1]!==null&&r!==null,f=!1,d=1;d<e.length;++d)if(e[d]!==null&&e[d].destructorFunction===void 0){f=!0;break}for(var m=e[0].name!=="void",A="",E="",d=0;d<u-2;++d)A+=(d!==0?", ":"")+"arg"+d,E+=(d!==0?", ":"")+"arg"+d+"Wired";var C="return function "+dt(t)+"("+A+`) {
if (arguments.length !== `+(u-2)+`) {
throwBindingError('function `+t+" called with ' + arguments.length + ' arguments, expected "+(u-2)+` args!');
}
`;f&&(C+=`var destructors = [];
`);var M=f?"destructors":"null",W=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],L=[V,n,l,kt,e[0],e[1]];_&&(C+="var thisWired = classParam.toWireType("+M+`, this);
`);for(var d=0;d<u-2;++d)C+="var arg"+d+"Wired = argType"+d+".toWireType("+M+", arg"+d+"); // "+e[d+2].name+`
`,W.push("argType"+d),L.push(e[d+2]);if(_&&(E="thisWired"+(E.length>0?", ":"")+E),C+=(m?"var rv = ":"")+"invoker(fn"+(E.length>0?", ":"")+E+`);
`,f)C+=`runDestructors(destructors);
`;else for(var d=_?1:2;d<e.length;++d){var J=d===1?"thisWired":"arg"+(d-2)+"Wired";e[d].destructorFunction!==null&&(C+=J+"_dtor("+J+"); // "+e[d].name+`
`,W.push(J+"_dtor"),L.push(e[d].destructorFunction))}m&&(C+=`var ret = retType.fromWireType(rv);
return ret;
`),C+=`}
`,W.push(C);var k=hr(Function,W).apply(null,L);return k}function In(t,e,r,n,l,u){s(e>0);var _=Vt(e,r);l=K(n,l),Ee([],[t],function(f){f=f[0];var d="constructor "+f.name;if(f.registeredClass.constructor_body===void 0&&(f.registeredClass.constructor_body=[]),f.registeredClass.constructor_body[e-1]!==void 0)throw new Ve("Cannot register multiple constructors with identical number of parameters ("+(e-1)+") for class '"+f.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return f.registeredClass.constructor_body[e-1]=()=>{yt("Cannot construct "+f.name+" due to unbound types",_)},Ee([],_,function(m){return m.splice(1,0,null),f.registeredClass.constructor_body[e-1]=Mt(d,m,null,l,u),[]}),[]})}function Vn(t,e,r,n,l,u,_,f){var d=Vt(r,n);e=q(e),u=K(l,u),Ee([],[t],function(m){m=m[0];var A=m.name+"."+e;e.startsWith("@@")&&(e=Symbol[e.substring(2)]),f&&m.registeredClass.pureVirtualFunctions.push(e);function E(){yt("Cannot call "+A+" due to unbound types",d)}var C=m.registeredClass.instancePrototype,M=C[e];return M===void 0||M.overloadTable===void 0&&M.className!==m.name&&M.argCount===r-2?(E.argCount=r-2,E.className=m.name,C[e]=E):(cr(C,e,A),C[e].overloadTable[r-2]=E),Ee([],d,function(W){var L=Mt(A,W,m,u,_);return C[e].overloadTable===void 0?(L.argCount=r-2,C[e]=L):C[e].overloadTable[r-2]=L,[]}),[]})}var Ut=[],ue=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Ht(t){t>4&&--ue[t].refcount===0&&(ue[t]=void 0,Ut.push(t))}function Mn(){for(var t=0,e=5;e<ue.length;++e)ue[e]!==void 0&&++t;return t}function Un(){for(var t=5;t<ue.length;++t)if(ue[t]!==void 0)return ue[t];return null}function Hn(){i.count_emval_handles=Mn,i.get_first_emval=Un}var U={toValue:t=>(t||V("Cannot use deleted val. handle = "+t),ue[t].value),toHandle:t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var e=Ut.length?Ut.pop():ue.length;return ue[e]={refcount:1,value:t},e}}}};function Wn(t,e){e=q(e),pe(t,{name:e,fromWireType:function(r){var n=U.toValue(r);return Ht(r),n},toWireType:function(r,n){return U.toHandle(n)},argPackAdvance:8,readValueFromPointer:Je,destructorFunction:null})}function Ln(t,e,r){switch(e){case 0:return function(n){var l=r?y:R;return this.fromWireType(l[n>>>0])};case 1:return function(n){var l=r?S:H;return this.fromWireType(l[n>>>1])};case 2:return function(n){var l=r?w:P;return this.fromWireType(l[n>>>2])};default:throw new TypeError("Unknown integer type: "+t)}}function zn(t,e,r,n){var l=mt(r);e=q(e);function u(){}u.values={},pe(t,{name:e,constructor:u,fromWireType:function(_){return this.constructor.values[_]},toWireType:function(_,f){return f.value},argPackAdvance:8,readValueFromPointer:Ln(e,l,n),destructorFunction:null}),Nt(e,u)}function et(t,e){var r=ke[t];return r===void 0&&V(e+" has unknown type "+pr(t)),r}function Yn(t,e,r){var n=et(t,"enum");e=q(e);var l=n.constructor,u=Object.create(n.constructor.prototype,{value:{value:r},constructor:{value:pt(n.name+"_"+e,function(){})}});l.values[r]=u,l[e]=u}function Wt(t){if(t===null)return"null";var e=typeof t;return e==="object"||e==="array"||e==="function"?t.toString():""+t}function Gn(t,e){switch(e){case 2:return function(r){return this.fromWireType(ne[r>>>2])};case 3:return function(r){return this.fromWireType(te[r>>>3])};default:throw new TypeError("Unknown float type: "+t)}}function Bn(t,e,r){var n=mt(r);e=q(e),pe(t,{name:e,fromWireType:function(l){return l},toWireType:function(l,u){return u},argPackAdvance:8,readValueFromPointer:Gn(e,n),destructorFunction:null})}function qn(t,e,r,n,l,u){var _=Vt(e,r);t=q(t),l=K(n,l),Nt(t,function(){yt("Cannot call "+t+" due to unbound types",_)},e-1),Ee([],_,function(f){var d=[f[0],null].concat(f.slice(1));return fr(t,Mt(t,d,null,l,u),e-1),[]})}function Jn(t,e,r){switch(e){case 0:return r?function(l){return y[l>>>0]}:function(l){return R[l>>>0]};case 1:return r?function(l){return S[l>>>1]}:function(l){return H[l>>>1]};case 2:return r?function(l){return w[l>>>2]}:function(l){return P[l>>>2]};default:throw new TypeError("Unknown integer type: "+t)}}function Xn(t,e,r,n,l){e=q(e),l===-1&&(l=4294967295);var u=mt(r),_=E=>E;if(n===0){var f=32-8*r;_=E=>E<<f>>>f}var d=e.includes("unsigned"),m=(E,C)=>{},A;d?A=function(E,C){return m(C,this.name),C>>>0}:A=function(E,C){return m(C,this.name),C},pe(t,{name:e,fromWireType:_,toWireType:A,argPackAdvance:8,readValueFromPointer:Jn(e,u,n!==0),destructorFunction:null})}function Zn(t,e,r){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],l=n[e];function u(_){_=_>>2;var f=P,d=f[_>>>0],m=f[_+1>>>0];return new l(f.buffer,m,d)}r=q(r),pe(t,{name:r,fromWireType:u,argPackAdvance:8,readValueFromPointer:u},{ignoreDuplicateRegistrations:!0})}function Kn(t,e,r,n,l,u,_,f,d,m,A,E){r=q(r),u=K(l,u),f=K(_,f),m=K(d,m),E=K(A,E),Ee([t],[e],function(C){C=C[0];var M=new he(r,C.registeredClass,!1,!1,!0,C,n,u,f,m,E);return[M]})}function Qn(t,e){e=q(e);var r=e==="std::string";pe(t,{name:e,fromWireType:function(n){var l=P[n>>>2],u=n+4,_;if(r)for(var f=u,d=0;d<=l;++d){var m=u+d;if(d==l||R[m>>>0]==0){var A=m-f,E=h(f,A);_===void 0?_=E:(_+=String.fromCharCode(0),_+=E),f=m+1}}else{for(var C=new Array(l),d=0;d<l;++d)C[d]=String.fromCharCode(R[u+d>>>0]);_=C.join("")}return ye(n),_},toWireType:function(n,l){l instanceof ArrayBuffer&&(l=new Uint8Array(l));var u,_=typeof l=="string";_||l instanceof Uint8Array||l instanceof Uint8ClampedArray||l instanceof Int8Array||V("Cannot pass non-string to std::string"),r&&_?u=x(l):u=l.length;var f=bt(4+u+1),d=f+4;if(d>>>=0,P[f>>>2]=u,r&&_)O(l,d,u+1);else if(_)for(var m=0;m<u;++m){var A=l.charCodeAt(m);A>255&&(ye(d),V("String has UTF-16 code units that do not fit in 8 bits")),R[d+m>>>0]=A}else for(var m=0;m<u;++m)R[d+m>>>0]=l[m];return n!==null&&n.push(ye,f),f},argPackAdvance:8,readValueFromPointer:Je,destructorFunction:function(n){ye(n)}})}var mr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ei(t,e){for(var r=t,n=r>>1,l=n+e/2;!(n>=l)&&H[n>>>0];)++n;if(r=n<<1,r-t>32&&mr)return mr.decode(R.subarray(t>>>0,r>>>0));for(var u="",_=0;!(_>=e/2);++_){var f=S[t+_*2>>>1];if(f==0)break;u+=String.fromCharCode(f)}return u}function ti(t,e,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var n=e,l=r<t.length*2?r/2:t.length,u=0;u<l;++u){var _=t.charCodeAt(u);S[e>>>1]=_,e+=2}return S[e>>>1]=0,e-n}function ri(t){return t.length*2}function ni(t,e){for(var r=0,n="";!(r>=e/4);){var l=w[t+r*4>>>2];if(l==0)break;if(++r,l>=65536){var u=l-65536;n+=String.fromCharCode(55296|u>>10,56320|u&1023)}else n+=String.fromCharCode(l)}return n}function ii(t,e,r){if(e>>>=0,r===void 0&&(r=2147483647),r<4)return 0;for(var n=e,l=n+r-4,u=0;u<t.length;++u){var _=t.charCodeAt(u);if(_>=55296&&_<=57343){var f=t.charCodeAt(++u);_=65536+((_&1023)<<10)|f&1023}if(w[e>>>2]=_,e+=4,e+4>l)break}return w[e>>>2]=0,e-n}function si(t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n>=55296&&n<=57343&&++r,e+=4}return e}function oi(t,e,r){r=q(r);var n,l,u,_,f;e===2?(n=ei,l=ti,_=ri,u=()=>H,f=1):e===4&&(n=ni,l=ii,_=si,u=()=>P,f=2),pe(t,{name:r,fromWireType:function(d){for(var m=P[d>>>2],A=u(),E,C=d+4,M=0;M<=m;++M){var W=d+4+M*e;if(M==m||A[W>>>f]==0){var L=W-C,J=n(C,L);E===void 0?E=J:(E+=String.fromCharCode(0),E+=J),C=W+e}}return ye(d),E},toWireType:function(d,m){typeof m!="string"&&V("Cannot pass non-string to C++ string type "+r);var A=_(m),E=bt(4+A+e);return E>>>=0,P[E>>>2]=A>>f,l(m,E+4,A+e),d!==null&&d.push(ye,E),E},argPackAdvance:8,readValueFromPointer:Je,destructorFunction:function(d){ye(d)}})}function ai(t,e,r,n,l,u){ft[t]={name:q(e),rawConstructor:K(r,n),rawDestructor:K(l,u),fields:[]}}function li(t,e,r,n,l,u,_,f,d,m){ft[t].fields.push({fieldName:q(e),getterReturnType:r,getter:K(n,l),getterContext:u,setterArgumentType:_,setter:K(f,d),setterContext:m})}function ui(t,e){e=q(e),pe(t,{isVoid:!0,name:e,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,n){}})}var ci=!0;function fi(){return ci}function _i(t,e,r){t=U.toValue(t),e=et(e,"emval::as");var n=[],l=U.toHandle(n);return P[r>>>2]=l,e.toWireType(n,t)}function vr(t,e){for(var r=new Array(t),n=0;n<t;++n)r[n]=et(P[e+n*4>>>2],"parameter "+n);return r}function di(t,e,r,n){t=U.toValue(t);for(var l=vr(e,r),u=new Array(e),_=0;_<e;++_){var f=l[_];u[_]=f.readValueFromPointer(n),n+=f.argPackAdvance}var d=t.apply(void 0,u);return U.toHandle(d)}function pi(t){var e=[];return P[t>>>2]=U.toHandle(e),e}var hi={};function tt(t){var e=hi[t];return e===void 0?q(t):e}var wt=[];function mi(t,e,r,n,l){return t=wt[t],e=U.toValue(e),r=tt(r),t(e,r,pi(n),l)}function vi(t,e,r,n){t=wt[t],e=U.toValue(e),r=tt(r),t(e,r,null,n)}function gr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function gi(t){return t===0?U.toHandle(gr()):(t=tt(t),U.toHandle(gr()[t]))}function yi(t){var e=wt.length;return wt.push(t),e}var yr=[];function wi(t,e){var r=vr(t,e),n=r[0],l=n.name+"_$"+r.slice(1).map(function(W){return W.name}).join("_")+"$",u=yr[l];if(u!==void 0)return u;for(var _=["retType"],f=[n],d="",m=0;m<t-1;++m)d+=(m!==0?", ":"")+"arg"+m,_.push("argType"+m),f.push(r[1+m]);for(var A=dt("methodCaller_"+l),E="return function "+A+`(handle, name, destructors, args) {
`,C=0,m=0;m<t-1;++m)E+="    var arg"+m+" = argType"+m+".readValueFromPointer(args"+(C?"+"+C:"")+`);
`,C+=r[m+1].argPackAdvance;E+="    var rv = handle[name]("+d+`);
`;for(var m=0;m<t-1;++m)r[m+1].deleteObject&&(E+="    argType"+m+".deleteObject(arg"+m+`);
`);n.isVoid||(E+=`    return retType.toWireType(destructors, rv);
`),E+=`};
`,_.push(E);var M=hr(Function,_).apply(null,f);return u=yi(M),yr[l]=u,u}function bi(t){return t=tt(t),U.toHandle(i[t])}function Ti(t,e){return t=U.toValue(t),e=U.toValue(e),U.toHandle(t[e])}function Ci(t){t>4&&(ue[t].refcount+=1)}function Ei(t,e){return t=U.toValue(t),e=U.toValue(e),t instanceof e}function Ai(t){for(var e="",r=0;r<t;++r)e+=(r!==0?", ":"")+"arg"+r;for(var n=()=>P,l="return function emval_allocator_"+t+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,r=0;r<t;++r)l+="var argType"+r+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+r+`');
var arg`+r+" = argType"+r+`.readValueFromPointer(args);
args += argType`+r+`['argPackAdvance'];
argTypes += 4;
`;return l+="var obj = new constructor("+e+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",l)(et,i,U.toHandle,n)}var wr={};function Oi(t,e,r,n){t=U.toValue(t);var l=wr[e];return l||(l=Ai(e),wr[e]=l),l(t,r,n)}function Pi(){return U.toHandle([])}function Si(t){return U.toHandle(tt(t))}function Ri(){return U.toHandle({})}function xi(t){var e=U.toValue(t);kt(e),Ht(t)}function ki(t,e,r){t=U.toValue(t),e=U.toValue(e),r=U.toValue(r),t[e]=r}function ji(t,e){t=et(t,"_emval_take_value");var r=t.readValueFromPointer(e);return U.toHandle(r)}function Fi(t){return t=U.toValue(t),U.toHandle(typeof t)}function $i(t){return P[t>>>2]+w[t+4>>>2]*4294967296}function je(t){return t%4===0&&(t%100!==0||t%400===0)}var Di=[0,31,60,91,121,152,182,213,244,274,305,335],Ni=[0,31,59,90,120,151,181,212,243,273,304,334];function Ii(t){var e=je(t.getFullYear()),r=e?Di:Ni,n=r[t.getMonth()]+t.getDate()-1;return n}function Vi(t,e){var r=new Date($i(t)*1e3);w[e>>>2]=r.getSeconds(),w[e+4>>>2]=r.getMinutes(),w[e+8>>>2]=r.getHours(),w[e+12>>>2]=r.getDate(),w[e+16>>>2]=r.getMonth(),w[e+20>>>2]=r.getFullYear()-1900,w[e+24>>>2]=r.getDay();var n=Ii(r)|0;w[e+28>>>2]=n,w[e+36>>>2]=-(r.getTimezoneOffset()*60);var l=new Date(r.getFullYear(),0,1),u=new Date(r.getFullYear(),6,1).getTimezoneOffset(),_=l.getTimezoneOffset(),f=(u!=_&&r.getTimezoneOffset()==Math.min(_,u))|0;w[e+32>>>2]=f}function Mi(t,e,r,n,l,u,_){return-52}function Ui(t,e,r,n,l,u){}function br(t){var e=x(t)+1,r=bt(e);return r&&g(t,y,r,e),r}function Hi(t,e,r){var n=new Date().getFullYear(),l=new Date(n,0,1),u=new Date(n,6,1),_=l.getTimezoneOffset(),f=u.getTimezoneOffset(),d=Math.max(_,f);P[t>>>2]=d*60,w[e>>>2]=Number(_!=f);function m(W){var L=W.toTimeString().match(/\(([A-Za-z ]+)\)$/);return L?L[1]:"GMT"}var A=m(l),E=m(u),C=br(A),M=br(E);f<_?(P[r>>>2]=C,P[r+4>>>2]=M):(P[r>>>2]=M,P[r+4>>>2]=C)}function Wi(){Be("")}var Lt=[];function Li(t,e){Lt.length=0;var r;for(e>>=2;r=R[t++>>>0];)e+=r!=105&e,Lt.push(r==105?w[e>>>0]:te[e++>>>1]),++e;return Lt}function zi(t,e,r){var n=Li(e,r);return Gr[t].apply(null,n)}function Yi(t,e,r){return zi(t,e,r)}function Gi(){return Date.now()}function Tr(){return 4294901760}function Bi(){return Tr()}var Cr;Cr=()=>performance.now();function qi(t,e,r){R.copyWithin(t>>>0,e>>>0,e+r>>>0)}function Ji(t){var e=De.buffer;try{return De.grow(t-e.byteLength+65535>>>16),oe(),1}catch{}}function Xi(t){var e=R.length;t=t>>>0;var r=Tr();if(t>r)return!1;let n=(d,m)=>d+(m-d%m)%m;for(var l=1;l<=4;l*=2){var u=e*(1+.2/l);u=Math.min(u,t+100663296);var _=Math.min(r,n(Math.max(t,u),65536)),f=Ji(_);if(f)return!0}return!1}var zt={};function Zi(){return z||"./this.program"}function rt(){if(!rt.strings){var t=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:Zi()};for(var r in zt)zt[r]===void 0?delete e[r]:e[r]=zt[r];var n=[];for(var r in e)n.push(r+"="+e[r]);rt.strings=n}return rt.strings}function Ki(t,e,r){for(var n=0;n<t.length;++n)y[e++>>>0]=t.charCodeAt(n);r||(y[e>>>0]=0)}function Qi(t,e){var r=0;return rt().forEach(function(n,l){var u=e+r;P[t+l*4>>>2]=u,Ki(n,u),r+=n.length+1}),0}function es(t,e){var r=rt();P[t>>>2]=r.length;var n=0;return r.forEach(function(l){n+=l.length+1}),P[e>>>2]=n,0}function ts(t){return 52}function rs(t,e,r,n){return 52}function ns(t,e,r,n,l){return 70}var is=[null,[],[]];function ss(t,e){var r=is[t];e===0||e===10?((t===1?ge:I)(c(r,0)),r.length=0):r.push(e)}function os(t,e,r,n){for(var l=0,u=0;u<r;u++){var _=P[e>>>2],f=P[e+4>>>2];e+=8;for(var d=0;d<f;d++)ss(t,R[_+d>>>0]);l+=f}return P[n>>>2]=l,0}function Yt(t,e){for(var r=0,n=0;n<=e;r+=t[n++]);return r}var nt=[31,29,31,30,31,30,31,31,30,31,30,31],it=[31,28,31,30,31,30,31,31,30,31,30,31];function st(t,e){for(var r=new Date(t.getTime());e>0;){var n=je(r.getFullYear()),l=r.getMonth(),u=(n?nt:it)[l];if(e>u-r.getDate())e-=u-r.getDate()+1,r.setDate(1),l<11?r.setMonth(l+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1));else return r.setDate(r.getDate()+e),r}return r}function Er(t,e,r){var n=r>0?r:x(t)+1,l=new Array(n),u=g(t,l,0,l.length);return e&&(l.length=u),l}function as(t,e){y.set(t,e>>>0)}function Ar(t,e,r,n){var l=w[n+40>>>2],u={tm_sec:w[n>>>2],tm_min:w[n+4>>>2],tm_hour:w[n+8>>>2],tm_mday:w[n+12>>>2],tm_mon:w[n+16>>>2],tm_year:w[n+20>>>2],tm_wday:w[n+24>>>2],tm_yday:w[n+28>>>2],tm_isdst:w[n+32>>>2],tm_gmtoff:w[n+36>>>2],tm_zone:l?h(l):""},_=h(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var d in f)_=_.replace(new RegExp(d,"g"),f[d]);var m=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],A=["January","February","March","April","May","June","July","August","September","October","November","December"];function E(p,T,X){for(var Y=typeof p=="number"?p.toString():p||"";Y.length<T;)Y=X[0]+Y;return Y}function C(p,T){return E(p,T,"0")}function M(p,T){function X(me){return me<0?-1:me>0?1:0}var Y;return(Y=X(p.getFullYear()-T.getFullYear()))===0&&(Y=X(p.getMonth()-T.getMonth()))===0&&(Y=X(p.getDate()-T.getDate())),Y}function W(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function L(p){var T=st(new Date(p.tm_year+1900,0,1),p.tm_yday),X=new Date(T.getFullYear(),0,4),Y=new Date(T.getFullYear()+1,0,4),me=W(X),Fe=W(Y);return M(me,T)<=0?M(Fe,T)<=0?T.getFullYear()+1:T.getFullYear():T.getFullYear()-1}var J={"%a":function(p){return m[p.tm_wday].substring(0,3)},"%A":function(p){return m[p.tm_wday]},"%b":function(p){return A[p.tm_mon].substring(0,3)},"%B":function(p){return A[p.tm_mon]},"%C":function(p){var T=p.tm_year+1900;return C(T/100|0,2)},"%d":function(p){return C(p.tm_mday,2)},"%e":function(p){return E(p.tm_mday,2," ")},"%g":function(p){return L(p).toString().substring(2)},"%G":function(p){return L(p)},"%H":function(p){return C(p.tm_hour,2)},"%I":function(p){var T=p.tm_hour;return T==0?T=12:T>12&&(T-=12),C(T,2)},"%j":function(p){return C(p.tm_mday+Yt(je(p.tm_year+1900)?nt:it,p.tm_mon-1),3)},"%m":function(p){return C(p.tm_mon+1,2)},"%M":function(p){return C(p.tm_min,2)},"%n":function(){return`
`},"%p":function(p){return p.tm_hour>=0&&p.tm_hour<12?"AM":"PM"},"%S":function(p){return C(p.tm_sec,2)},"%t":function(){return"	"},"%u":function(p){return p.tm_wday||7},"%U":function(p){var T=p.tm_yday+7-p.tm_wday;return C(Math.floor(T/7),2)},"%V":function(p){var T=Math.floor((p.tm_yday+7-(p.tm_wday+6)%7)/7);if((p.tm_wday+371-p.tm_yday-2)%7<=2&&T++,T){if(T==53){var Y=(p.tm_wday+371-p.tm_yday)%7;Y!=4&&(Y!=3||!je(p.tm_year))&&(T=1)}}else{T=52;var X=(p.tm_wday+7-p.tm_yday-1)%7;(X==4||X==5&&je(p.tm_year%400-1))&&T++}return C(T,2)},"%w":function(p){return p.tm_wday},"%W":function(p){var T=p.tm_yday+7-(p.tm_wday+6)%7;return C(Math.floor(T/7),2)},"%y":function(p){return(p.tm_year+1900).toString().substring(2)},"%Y":function(p){return p.tm_year+1900},"%z":function(p){var T=p.tm_gmtoff,X=T>=0;return T=Math.abs(T)/60,T=T/60*100+T%60,(X?"+":"-")+String("0000"+T).slice(-4)},"%Z":function(p){return p.tm_zone},"%%":function(){return"%"}};_=_.replace(/%%/g,"\0\0");for(var d in J)_.includes(d)&&(_=_.replace(new RegExp(d,"g"),J[d](u)));_=_.replace(/\0\0/g,"%");var k=Er(_,!1);return k.length>e?0:(as(k,t),k.length-1)}function ls(t,e,r,n,l){return Ar(t,e,r,n)}function se(t){return parseInt(t)}function us(t,e,r){for(var n=h(e),l="\\!@#$^&*()+=-[]/{}|:<>?,.",u=0,_=l.length;u<_;++u)n=n.replace(new RegExp("\\"+l[u],"g"),"\\"+l[u]);var f={"%A":"%a","%B":"%b","%c":"%a %b %d %H:%M:%S %Y","%D":"%m\\/%d\\/%y","%e":"%d","%F":"%Y-%m-%d","%h":"%b","%R":"%H\\:%M","%r":"%I\\:%M\\:%S\\s%p","%T":"%H\\:%M\\:%S","%x":"%m\\/%d\\/(?:%y|%Y)","%X":"%H\\:%M\\:%S"};for(var d in f)n=n.replace(d,f[d]);var m={"%a":"(?:Sun(?:day)?)|(?:Mon(?:day)?)|(?:Tue(?:sday)?)|(?:Wed(?:nesday)?)|(?:Thu(?:rsday)?)|(?:Fri(?:day)?)|(?:Sat(?:urday)?)","%b":"(?:Jan(?:uary)?)|(?:Feb(?:ruary)?)|(?:Mar(?:ch)?)|(?:Apr(?:il)?)|May|(?:Jun(?:e)?)|(?:Jul(?:y)?)|(?:Aug(?:ust)?)|(?:Sep(?:tember)?)|(?:Oct(?:ober)?)|(?:Nov(?:ember)?)|(?:Dec(?:ember)?)","%C":"\\d\\d","%d":"0[1-9]|[1-9](?!\\d)|1\\d|2\\d|30|31","%H":"\\d(?!\\d)|[0,1]\\d|20|21|22|23","%I":"\\d(?!\\d)|0\\d|10|11|12","%j":"00[1-9]|0?[1-9](?!\\d)|0?[1-9]\\d(?!\\d)|[1,2]\\d\\d|3[0-6]\\d","%m":"0[1-9]|[1-9](?!\\d)|10|11|12","%M":"0\\d|\\d(?!\\d)|[1-5]\\d","%n":"\\s","%p":"AM|am|PM|pm|A\\.M\\.|a\\.m\\.|P\\.M\\.|p\\.m\\.","%S":"0\\d|\\d(?!\\d)|[1-5]\\d|60","%U":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%W":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%w":"[0-6]","%y":"\\d\\d","%Y":"\\d\\d\\d\\d","%%":"%","%t":"\\s"},A={JAN:0,FEB:1,MAR:2,APR:3,MAY:4,JUN:5,JUL:6,AUG:7,SEP:8,OCT:9,NOV:10,DEC:11},E={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6},C={MON:0,TUE:1,WED:2,THU:3,FRI:4,SAT:5,SUN:6};for(var M in m)n=n.replace(M,"("+M+m[M]+")");for(var W=[],u=n.indexOf("%");u>=0;u=n.indexOf("%"))W.push(n[u+1]),n=n.replace(new RegExp("\\%"+n[u+1],"g"),"");var L=new RegExp("^"+n,"i").exec(h(t));function J(){function Oe(Pe,Gt,kr){return typeof Pe!="number"||isNaN(Pe)?Gt:Pe>=Gt?Pe<=kr?Pe:kr:Gt}return{year:Oe(w[r+20>>>2]+1900,1970,9999),month:Oe(w[r+16>>>2],0,11),day:Oe(w[r+12>>>2],1,31),hour:Oe(w[r+8>>>2],0,23),min:Oe(w[r+4>>>2],0,59),sec:Oe(w[r>>>2],0,59)}}if(L){var k=J(),p,T=Oe=>{var Pe=W.indexOf(Oe);if(Pe>=0)return L[Pe+1]};if((p=T("S"))&&(k.sec=se(p)),(p=T("M"))&&(k.min=se(p)),p=T("H"))k.hour=se(p);else if(p=T("I")){var X=se(p);(p=T("p"))&&(X+=p.toUpperCase()[0]==="P"?12:0),k.hour=X}if(p=T("Y"))k.year=se(p);else if(p=T("y")){var Y=se(p);(p=T("C"))?Y+=se(p)*100:Y+=Y<69?2e3:1900,k.year=Y}if((p=T("m"))?k.month=se(p)-1:(p=T("b"))&&(k.month=A[p.substring(0,3).toUpperCase()]||0),p=T("d"))k.day=se(p);else if(p=T("j"))for(var me=se(p),Fe=je(k.year),Ct=0;Ct<12;++Ct){var Rr=Yt(Fe?nt:it,Ct-1);me<=Rr+(Fe?nt:it)[Ct]&&(k.day=me-Rr)}else if(p=T("a")){var xr=p.substring(0,3).toUpperCase();if(p=T("U")){var ot=E[xr],at=se(p),we=new Date(k.year,0,1),be;we.getDay()===0?be=st(we,ot+7*(at-1)):be=st(we,7-we.getDay()+ot+7*(at-1)),k.day=be.getDate(),k.month=be.getMonth()}else if(p=T("W")){var ot=C[xr],at=se(p),we=new Date(k.year,0,1),be;we.getDay()===1?be=st(we,ot+7*(at-1)):be=st(we,7-we.getDay()+1+ot+7*(at-1)),k.day=be.getDate(),k.month=be.getMonth()}}var ve=new Date(k.year,k.month,k.day,k.hour,k.min,k.sec,0);return w[r>>>2]=ve.getSeconds(),w[r+4>>>2]=ve.getMinutes(),w[r+8>>>2]=ve.getHours(),w[r+12>>>2]=ve.getDate(),w[r+16>>>2]=ve.getMonth(),w[r+20>>>2]=ve.getFullYear()-1900,w[r+24>>>2]=ve.getDay(),w[r+28>>>2]=Yt(je(ve.getFullYear())?nt:it,ve.getMonth()-1)+ve.getDate()-1,w[r+32>>>2]=0,t+Er(L[0]).length-1}return 0}ir=i.InternalError=jt(Error,"InternalError"),ln(),Ve=i.BindingError=jt(Error,"BindingError"),En(),mn(),jn(),dr=i.UnboundTypeError=jt(Error,"UnboundTypeError"),Hn();var cs={g:Xr,H:Zr,Q:Kr,W:Qr,S:en,K:tn,ea:rn,E:on,R:an,ha:un,o:Nn,t:In,c:Vn,ga:Wn,N:zn,s:Yn,L:Bn,n:qn,z:Xn,v:Zn,w:Kn,M:Qn,G:oi,F:ai,y:li,ia:ui,Z:fi,j:_i,la:di,m:mi,p:vi,a:Ht,q:gi,h:wi,u:bi,k:Ti,d:Ci,O:Ei,r:Oi,C:Pi,l:Si,I:Ri,f:xi,A:ki,i:ji,B:Fi,$:Vi,X:Mi,Y:Ui,aa:Hi,e:Wi,b:Yi,_:Gi,U:Bi,ba:Cr,fa:qi,T:Xi,ca:Qi,da:es,D:ts,J:rs,P:ns,V:os,ka:Ar,x:ls,ja:us},Ys=Yr(),fs=function(){return(fs=i.asm.na).apply(null,arguments)},bt=function(){return(bt=i.asm.oa).apply(null,arguments)},ye=function(){return(ye=i.asm.pa).apply(null,arguments)},_s=function(){return(_s=i.asm.__errno_location).apply(null,arguments)},Or=i.___getTypeName=function(){return(Or=i.___getTypeName=i.asm.ra).apply(null,arguments)},ds=i.__embind_initialize_bindings=function(){return(ds=i.__embind_initialize_bindings=i.asm.sa).apply(null,arguments)},Pr=function(){return(Pr=i.asm.ta).apply(null,arguments)},ps=i.dynCall_ji=function(){return(ps=i.dynCall_ji=i.asm.ua).apply(null,arguments)},hs=i.dynCall_viij=function(){return(hs=i.dynCall_viij=i.asm.va).apply(null,arguments)},ms=i.dynCall_viiij=function(){return(ms=i.dynCall_viiij=i.asm.wa).apply(null,arguments)},vs=i.dynCall_viiijj=function(){return(vs=i.dynCall_viiijj=i.asm.xa).apply(null,arguments)},gs=i.dynCall_viji=function(){return(gs=i.dynCall_viji=i.asm.ya).apply(null,arguments)},ys=i.dynCall_viiji=function(){return(ys=i.dynCall_viiji=i.asm.za).apply(null,arguments)},ws=i.dynCall_viijji=function(){return(ws=i.dynCall_viijji=i.asm.Aa).apply(null,arguments)},bs=i.dynCall_viijj=function(){return(bs=i.dynCall_viijj=i.asm.Ba).apply(null,arguments)},Ts=i.dynCall_viijij=function(){return(Ts=i.dynCall_viijij=i.asm.Ca).apply(null,arguments)},Cs=i.dynCall_viiiijii=function(){return(Cs=i.dynCall_viiiijii=i.asm.Da).apply(null,arguments)},Es=i.dynCall_vijjji=function(){return(Es=i.dynCall_vijjji=i.asm.Ea).apply(null,arguments)},As=i.dynCall_jiji=function(){return(As=i.dynCall_jiji=i.asm.Fa).apply(null,arguments)},Os=i.dynCall_viijii=function(){return(Os=i.dynCall_viijii=i.asm.Ga).apply(null,arguments)},Ps=i.dynCall_iiiiij=function(){return(Ps=i.dynCall_iiiiij=i.asm.Ha).apply(null,arguments)},Ss=i.dynCall_iiiiijj=function(){return(Ss=i.dynCall_iiiiijj=i.asm.Ia).apply(null,arguments)},Rs=i.dynCall_iiiiiijj=function(){return(Rs=i.dynCall_iiiiiijj=i.asm.Ja).apply(null,arguments)},Tt;Ce=function t(){Tt||Sr(),Tt||(Ce=t)};function Sr(){if(B>0||(de(),B>0))return;function t(){Tt||(Tt=!0,i.calledRun=!0,!_e&&(ae(),b(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),Z()))}i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),t()},1)):t()}if(i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return Sr(),o.ready}})(),Fr=js;var Et={};ks(Et,{COLUMN_SEPARATOR_STRING:()=>ce,CONFIG_ALIASES:()=>Me,CONFIG_VALID_KEYS:()=>qt,DATA_TYPES:()=>Fs,FILTER_OPERATORS:()=>$,SORT_ORDERS:()=>Ds,SORT_ORDER_IDS:()=>Ns,TYPE_AGGREGATES:()=>Is,TYPE_FILTERS:()=>Us});var Fs={integer:"integer",float:"float",string:"string",boolean:"boolean",date:"date",datetime:"datetime",object:"object"},Me={row_pivot:"group_by","row-pivot":"group_by","row-pivots":"group_by",col_pivot:"split_by",col_pivots:"split_by",column_pivot:"split_by","column-pivot":"split_by","column-pivots":"split_by",filters:"filter",sorts:"sort"},qt=["viewport","group_by","split_by","aggregates","columns","filter","sort","computed_columns","expressions","group_by_depth","split_by_depth","filter_op"],$r=["any","avg","abs sum","count","distinct count","dominant","first by index","last by index","last minus first","last","high","join","low","high minus low","max","mean","median","min","pct sum parent","pct sum grand total","stddev","sum","sum abs","sum not null","unique","var"],Bt=["any","count","distinct count","distinct leaf","dominant","first by index","join","last by index","last","unique"],$s=["any","count","distinct count","distinct leaf","dominant","first by index","last by index","last","unique"],Ds=["none","asc","desc","col asc","col desc","asc abs","desc abs","col asc abs","col desc abs"],Ns=[2,0,1,0,1,3,4,3,4],Is={string:Bt,float:$r,integer:$r,boolean:$s,datetime:Bt,date:Bt},$={lessThan:"<",greaterThan:">",equals:"==",lessThanOrEquals:"<=",greaterThanOrEquals:">=",doesNotEqual:"!=",isNull:"is null",isNotNull:"is not null",isIn:"in",isNotIn:"not in",contains:"contains",bitwiseAnd:"&",bitwiseOr:"|",and:"and",or:"or",beginsWith:"begins with",endsWith:"ends with"},Vs=[$.bitwiseAnd,$.bitwiseOr,$.equals,$.doesNotEqual,$.or,$.and,$.isNull,$.isNotNull],Dr=[$.lessThan,$.greaterThan,$.equals,$.lessThanOrEquals,$.greaterThanOrEquals,$.doesNotEqual,$.isNull,$.isNotNull],Ms=[$.equals,$.contains,$.doesNotEqual,$.isIn,$.isNotIn,$.beginsWith,$.endsWith,$.isNull,$.isNotNull],Nr=[$.lessThan,$.greaterThan,$.equals,$.lessThanOrEquals,$.greaterThanOrEquals,$.doesNotEqual,$.isNull,$.isNotNull],ce="|",Us={string:Ms,float:Dr,integer:Dr,boolean:Vs,datetime:Nr,date:Nr};var Jt={types:{float:{filter_operator:"==",aggregate:"sum",format:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}},string:{filter_operator:"==",aggregate:"count"},integer:{filter_operator:"==",aggregate:"sum",format:{}},boolean:{filter_operator:"==",aggregate:"count"},datetime:{filter_operator:"==",aggregate:"count",format:{dateStyle:"short",timeStyle:"medium"},null_value:-1},date:{filter_operator:"==",aggregate:"count",format:{dateStyle:"short"},null_value:-1}}};function $e(v){let o={};if(Ir().types[v]&&Object.assign(o,Ir().types[v]),o.type){let i=$e(o.type);return Object.assign(i,o),i}else return o}function Xt(v){return v&&typeof v=="object"&&!Array.isArray(v)}function At(v,...o){if(!o.length)return v;let i=o.shift();if(Xt(v)&&Xt(i))for(let b in i)Xt(i[b])?(v[b]||Object.assign(v,{[b]:{}}),At(v[b],i[b])):Object.assign(v,{[b]:i[b]});return At(v,...o)}function Vr(v){globalThis.__PERSPECTIVE_CONFIG__&&console.warn("Config already initialized!"),globalThis.__PERSPECTIVE_CONFIG__=At(Jt,v)}function Ir(){return globalThis.__PERSPECTIVE_CONFIG__||(globalThis.__PERSPECTIVE_CONFIG__=At(Jt,globalThis.__TEMPLATE_CONFIG__||{})),globalThis.__PERSPECTIVE_CONFIG__}function Ot(v){if(v>=1&&v<=8)return"integer";if(v===19)return"string";if(v===10||v===9)return"float";if(v===11)return"boolean";if(v===12)return"datetime";if(v===13)return"date";console.warn(`Unknown type for value ${v} with JS type ${typeof v}`)}function Zt(v){let o=v;do for(let i of Object.getOwnPropertyNames(o)){let b=v[i];i!=="constructor"&&typeof b=="function"&&(v[i]=b.bind(v))}while(o=o!==Object&&Object.getPrototypeOf(o))}String.prototype.includes||(String.prototype.includes=function(v,o){return typeof o!="number"&&(o=0),o+v.length>this.length?!1:this.indexOf(v,o)!==-1});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(v,o){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),b=i.length>>>0;if(b===0)return!1;var D=o|0,j=Math.max(D>=0?D:b-Math.abs(D),0);function N(z,G){return z===G||typeof z=="number"&&typeof G=="number"&&isNaN(z)&&isNaN(G)}for(;j<b;){if(N(i[j],v))return!0;j++}return!1}});var Pt=class{constructor(){this.data_formats={row:0,column:1,schema:2},this.format=void 0,this.data=void 0,this.names=void 0,this.types=void 0,this.row_count=void 0}is_format(o){if(Array.isArray(o))return this.data_formats.row;if(Array.isArray(o[Object.keys(o)[0]]))return this.data_formats.column;if(typeof o[Object.keys(o)[0]]=="string"||typeof o[Object.keys(o)[0]]=="function")return this.data_formats.schema;throw`Could not determine data format for ${JSON.stringify(o)}, with JS typeof ${typeof o}`}count_rows(o){return this.format===this.data_formats.row?o.length:this.format===this.data_formats.column?o[Object.keys(o)[0]].length:0}get_format(){return this.format}get(o,i){let b;if(this.format===this.data_formats.row){let D=this.data[i];D.hasOwnProperty(o)&&(b=D[o])}else if(this.format===this.data_formats.column)this.data.hasOwnProperty(o)&&(b=this.data[o][i]);else if(this.format===this.data_formats.schema)b=void 0;else throw`Could not get() from dataset - ${this.data} is poorly formatted.`;return b}marshal(o,i,b){let D=this.names[o],j=Hs(this.get(D,i));if(j===null)return null;if(!(typeof j>"u")){switch(Ot(b.value)){case"float":case"integer":{j=Number(j);break}case"boolean":{typeof j=="string"?j.toLowerCase()==="true"?j=!0:j=!1:j=!!j;break}case"datetime":case"date":break;default:j+=""}return j}}clean(){this.names=void 0,this.types=void 0}init(o){this.data=o,this.format=this.is_format(this.data),this.row_count=this.count_rows(this.data);let i={};if(this.format===this.data_formats.row)o.length>0?this.names=Object.keys(o[0]):this.clean.names=[];else if(this.format===this.data_formats.column)this.names=Object.keys(o);else if(this.format===this.data_formats.schema){this.names=Object.keys(o);for(let b of this.names){let D=$e(o[b]);D.type&&(console.debug(`Converting "${o[b]}" to "${D.type}"`),i[b]=o[b],o[b]=D.type)}}else throw`Could not initialize - failed to determine format for ${o}`;return i}};function Hs(v){return v===null||v==="null"?null:v===void 0||v==="undefined"?void 0:v}var Kt=function(v){let o=[];for(let i=0;i<v.size();i++){let b=v.get(i);o.push(b)}return v.delete(),o},Qt=function(v){let o={},i=v.keys();for(let b=0;b<i.size();b++){let D=i.get(b);o[D]=v.get(D)}return v.delete(),i.delete(),o},Ue=function(v,o){for(let i of o)v.push_back(i);return v};function Ws(v){let o={};return typeof v!="string"?Object.getOwnPropertyNames(v).forEach(i=>{o[i]=v[i]},v):o.message=v,o}var lt=class{constructor(o){this.perspective=o,this._tables={},this._views={},this._callback_cache=new Map}init(o){o.config&&Vr(o.config),o.data=["wait_for_response"],this.post(o)}post(o){throw new Error(`Posting ${o} failed - post() not implemented!`)}process(o,i){switch(o.cmd){case"init_profile_thread":this.perspective.initialize_profile_thread();break;case"memory_usage":this.post({id:o.id,data:this.perspective.memory_usage()});break;case"init":this.init(o);break;case"table":if(typeof o.args[0]>"u")this._tables[o.name]=[];else try{let N=this._tables[o.name],z=this.perspective.table(o.args[0],o.options);if(z&&z.then)z.then(G=>{if(this._tables[o.name]=G,N)for(let fe of N)this.process(fe);this.post({id:o.id,data:o.name})}).catch(G=>this.process_error(o,G));else{if(this._tables[o.name]=z,N)for(let G of N)this.process(G);this.post({id:o.id,data:o.name})}}catch(N){this.process_error(o,N);return}break;case"table_generate":(0,eval)(o.args)(function(N){this._tables[o.name]=N,this.post({id:o.id,data:"created!"})});break;case"table_execute":(0,eval)(o.f)(this._tables[o.name]);break;case"table_method":case"view_method":this.process_method_call(o);break;case"view":let j=this._tables[o.table_name];if(j&&Array.isArray(j))j.push(o),this._views[o.view_name]=[];else try{let N=this._views[o.view_name],z=this._tables[o.table_name].view(o.config);if(z&&z.then)z.then(G=>{if(this._views[o.view_name]=G,this._views[o.view_name].client_id=i,N)for(let fe of N)this.process(fe);this.post({id:o.id,data:o.view_name})}).catch(G=>this.process_error(o,G));else{if(this._views[o.view_name]=z,this._views[o.view_name].client_id=i,N)for(let G of N)this.process(G);this.post({id:o.id,data:o.view_name})}}catch(N){this.process_error(o,N);return}break}}process_subscribe(o,i){try{let b;o.method.slice(0,2)==="on"?(b=D=>{let j={id:o.id,data:D};try{if(o.args&&o.args[0]&&o.method==="on_update"&&o.args[0].mode==="row"){this.post(j,[D.delta]);return}this.post(j)}catch{console.error(`Removing failed callback to \`${o.method}()\` (presumably due to failed connection)`);let z=o.method.substring(3);i[`remove_${z}`](b)}},o.callback_id&&this._callback_cache.set(o.callback_id,b)):o.callback_id&&(b=this._callback_cache.get(o.callback_id),this._callback_cache.delete(o.callback_id)),b?i[o.method](b,...o.args):console.error(`Callback not found for remote call "${JSON.stringify(o)}"`)}catch(b){this.process_error(o,b);return}}process_method_call(o){let i,b,D=o.view_name||o.name;if(o.cmd==="table_method"?i=this._tables[D]:i=this._views[D],!i&&o.cmd==="view_method"){this.process_error(o,{message:"View method cancelled"});return}if(i&&i.push){i.push(o);return}try{if(o.subscribe){this.process_subscribe(o,i);return}else b=i[o.method].apply(i,o.args),b instanceof Promise?b.then(j=>this.process_method_call_response(o,j)).catch(j=>this.process_error(o,j)):this.process_method_call_response(o,b)}catch(j){this.process_error(o,j);return}}process_method_call_response(o,i){o.method==="delete"&&delete this._views[o.name],o.method==="to_arrow"?this.post({id:o.id,data:i},[i]):this.post({id:o.id,data:i})}process_error(o,i){try{this.post({id:o.id,error:Ws(i)})}catch{console.error("Error handler failed: {}",i)}}clear_views(o){for(let i of Object.keys(this._views))if(this._views[i].client_id===o){try{this._views[i].delete()}catch(b){console.error(b)}delete this._views[i]}console.debug(`GC ${Object.keys(this._views).length} views in memory`)}};var Ls={initDataValue:()=>[],initRowValue:()=>({}),initColumnValue:(v,o)=>{},initColumnRowPath:(v,o,i)=>o[i]=[],setColumnValue:(v,o,i,b)=>o[i]=b,addColumnValue:(v,o,i,b)=>o[i].unshift(b),addRow:(v,o)=>v.push(o),formatData:v=>v,slice:(v,o)=>v.slice(o)},zs={initDataValue:()=>new Object,initRowValue:()=>{},initColumnValue:(v,o)=>{v[o]=[]},setColumnValue:(v,o,i,b)=>{v[i].push(b)},addColumnValue:(v,o,i,b)=>{v[i][v[i].length-1].unshift(b)},initColumnRowPath:(v,o,i)=>{v[i]=v[i]||[],v[i].push([])},addRow:()=>{},formatData:v=>v,slice:(v,o)=>{let i={};for(let b in v)i[b]=v[b].slice(o);return i}},er={jsonFormatter:Ls,jsonTableFormatter:zs};typeof self<"u"&&self.performance===void 0&&(self.performance={now:Date.now});var St=new Set;function Mr(v){let o=v,i=new Pt,b=["zero","one","two"],D={};function j(s,a){D[a]?s.delete():(D[a]=s,setTimeout(()=>N(a)))}function N(s){let a=D[s];a&&(a._process(),z(s))}function z(s){D[s]?.delete(),delete D[s]}function G(){let s=performance.memory?JSON.parse(JSON.stringify(performance.memory,["totalJSHeapSize","usedJSHeapSize","jsHeapSizeLimit"])):process.memoryUsage();return s.wasmHeap=o.HEAP8.length,s}function fe(s,a,c,h,g,O,x,y,R){c||(c=""),h||(h=4294967295),a=o.make_table(a,s,h,c,g,O,x,y,R);let S=a.get_pool(),H=a.get_id();return O||g==o.t_op.OP_DELETE?j(S,H):(S._process(),S.delete()),a}function F(s,a,c,h,g){this.name=g,this._View=void 0,this.table=s,this.config=c||{},this.view_config=h||new h,this.is_unit_context=this.table.index===""&&a===0&&this.view_config.group_by.length===0&&this.view_config.split_by.length===0&&this.view_config.filter.length===0&&this.view_config.sort.length===0&&this.view_config.expressions.length===0,this.is_unit_context?this._View=o.make_view_unit(s._Table,g,ce,this.view_config,null):a===0?this._View=o.make_view_zero(s._Table,g,ce,this.view_config,null):a===1?this._View=o.make_view_one(s._Table,g,ce,this.view_config,null):a===2&&(this._View=o.make_view_two(s._Table,g,ce,this.view_config,null)),this.ctx=this._View.get_context(),this.column_only=this._View.is_column_only(),this.update_callbacks=this.table.update_callbacks,this.overridden_types=this.table.overridden_types,this._delete_callbacks=[],Zt(this)}F.prototype.get_config=function(){return JSON.parse(JSON.stringify(this.config))},F.prototype.delete=function(){z(this.table.get_id()),this._View.delete(),this.ctx.delete(),this.table.views.splice(this.table.views.indexOf(this),1),this.table=void 0;let s=0,a=0;for(;s<this.update_callbacks.length;){let c=this.update_callbacks[s];c.view!==this&&(this.update_callbacks[a++]=c),s++}this.update_callbacks.length=a,this._delete_callbacks.forEach(c=>c())},F.prototype.sides=function(){return this._View.sides()},F.prototype._num_hidden=function(){let s=0;for(let a of this.config.sort)this.config.columns.indexOf(a[0])===-1&&s++;return s};function re(s){let a=[];for(let c=0;c<s.size();c++){let h=s.get(c);a.push(o.scalar_to_val(h,!1,!0)),h.delete()}return s.delete(),a}let He=function(s){let a=[];for(let c=0;c<s.size();c++){let h=s.get(c);a.push(re(h))}return s.delete(),a};F.prototype.schema=function(s=!0){let a=Qt(this._View.schema());if(s)for(let c of Object.keys(a)){let h=c.split(ce);h=h[h.length-1],this.overridden_types[h]&&$e(this.overridden_types[h]).type===a[c]&&(a[c]=this.overridden_types[h])}return a},F.prototype.expression_schema=function(s=!0){let a=Qt(this._View.expression_schema());if(s)for(let c of Object.keys(a)){let h=c.split(ce);h=h[h.length-1],this.overridden_types[h]&&$e(this.overridden_types[h]).type===a[c]&&(a[c]=this.overridden_types[h])}return a},F.prototype._column_names=function(s=!1,a=0){return He(this._View.column_names(s,a)).map(c=>c.join(ce))},F.prototype.column_paths=function(){return He(this._View.column_paths()).map(s=>s.join(ce))},F.prototype.get_data_slice=function(s,a,c,h){if(this.is_unit_context)return o.get_data_slice_unit(this._View,s,a,c,h);{let g=this.sides(),O=b[g];return o[`get_data_slice_${O}`](this._View,s,a,c,h)}};let We=function(s){s=s||{};let a=this._View.num_columns()+(this.sides()===0?0:1),c=this._View.num_rows(),h=this._num_hidden(),g=this.sides()>0||this.column_only?1:0,O=this.config.viewport?this.config.viewport:{},x=s.start_row||(O.top?O.top:0),y=Math.min(c,s.end_row!==void 0?s.end_row:O.height?x+O.height:c),R=s.start_col||(O.left?O.left:0),S=Math.min(a,(s.end_col!==void 0?s.end_col+g:O.width?R+O.width:a)*(h+1));return s.start_row=Math.floor(x),s.end_row=Math.ceil(y),s.start_col=Math.floor(R),s.end_col=Math.ceil(S),s};F.prototype.get_min_max=function(s){if(this.is_unit_context)return o.get_min_max_unit(this._View,s);{let a=this.sides(),c=b[a];return o[`get_min_max_${c}`](this._View,s)}};let ut=function(s,a){N(this.table.get_id()),s=We.bind(this)(s);let c=s.start_row,h=s.end_row,g=s.start_col,O=s.end_col,x=this._num_hidden(),y=s.formatted,R=!!s.index,S=!!s.id,H=!!s.leaves_only,w=this.sides(),P=w!==0&&!this.column_only,ne=b[w],te;this.is_unit_context?te=o.get_from_data_slice_unit:te=o[`get_from_data_slice_${ne}`];let oe=this.get_data_slice(c,h,g,O),Se=oe.get_column_names(),Ge=He(Se).map(ee=>ee.join(ce)),ct=this.schema(),Q=a.initDataValue();for(let ee=g;ee<O;ee++){let de=Ge[ee];a.initColumnValue(Q,de)}for(let ee=c;ee<h;ee++){let de=P?oe.get_row_path(ee):void 0;if(P&&H&&de.size()<this.config.group_by.length){de.delete();continue}let ae=a.initRowValue();S&&a.initColumnRowPath(Q,ae,"__ID__");for(let Z=g;Z<O;Z++){let ie=Ge[Z],le=ct[ie],Re=$e(le);if(Z===g&&w!==0){if(!this.column_only){a.initColumnRowPath(Q,ae,"__ROW_PATH__");for(let B=0;B<de.size();B++){let Ne=de.get(B),Ce=o.scalar_to_val(Ne,!1,!1);Ne.delete(),a.addColumnValue(Q,ae,"__ROW_PATH__",Ce),S&&a.addColumnValue(Q,ae,"__ID__",Ce)}}}else{if((Z-(w>0?1:0))%(this.config.columns.length+x)>=this.config.columns.length)continue;{let B=te(oe,ee,Z);y&&B!==null&&B!==void 0&&(le==="datetime"||le==="date")&&(B=new Date(B),B=B.toLocaleString([],Re.format)),a.setColumnValue(Q,ae,ie,B)}}}if(R){let Z=oe.get_pkeys(ee,0);a.initColumnRowPath(Q,ae,"__INDEX__");for(let ie=0;ie<Z.size();ie++){let le=Z.get(ie),Re=o.scalar_to_val(le,!1,!1);le.delete(),a.addColumnValue(Q,ae,"__INDEX__",Re)}Z.delete()}if(S&&w===0){let Z=oe.get_pkeys(ee,0);for(let ie=0;ie<Z.size();ie++){let le=Z.get(ie),Re=o.scalar_to_val(le,!1,!1);le.delete(),a.addColumnValue(Q,ae,"__ID__",Re)}Z.delete()}de&&de.delete(),a.addRow(Q,ae)}return oe.delete(),a.formatData(Q,s.config)},Le=function(s,a,c){let h=this.num_rows(),g=a.start_row||0,O=a.end_row||h,y=this._column_names().indexOf(s);if(y===-1)return;this.sides()>0&&y++;let S,H;a.data_slice?S=a.data_slice.get_column_slice(y):(H=this.get_data_slice(g,O,y,y+1),S=H.get_slice());let w=this._View.get_column_dtype(y),P=c(S,w,y);return S.delete(),H&&H.delete(),P};F.prototype.to_columns=function(s){return ut.call(this,s,er.jsonTableFormatter)},F.prototype.to_json=function(s){return ut.call(this,s,er.jsonFormatter)},F.prototype.to_csv=function(s){N(this.table.get_id()),s=We.bind(this)(s);let a=s.start_row,c=s.end_row,h=s.start_col,g=s.end_col,O=this.sides();if(this.is_unit_context)return o.to_csv_unit(this._View,a,c,h,g);if(O===0)return o.to_csv_zero(this._View,a,c,h,g);if(O===1)return o.to_csv_one(this._View,a,c,h,g);if(O===2)return o.to_csv_two(this._View,a,c,h,g)},F.prototype.col_to_js_typed_array=function(s,a={}){N(this.table.get_id());let c=o.col_to_js_typed_array;return Le.call(this,s,a,c)},F.prototype.to_arrow=function(s={}){N(this.table.get_id()),s=We.bind(this)(s);let a=s.start_row,c=s.end_row,h=s.start_col,g=s.end_col,O=this.sides();if(this.is_unit_context)return o.to_arrow_unit(this._View,a,c,h,g);if(O===0)return o.to_arrow_zero(this._View,a,c,h,g);if(O===1)return o.to_arrow_one(this._View,a,c,h,g);if(O===2)return o.to_arrow_two(this._View,a,c,h,g)},F.prototype.num_rows=function(){return N(this.table.get_id()),this._View.num_rows()},F.prototype.num_columns=function(){let s=this._View.num_columns(),a=this._num_hidden();return s-s/(this.config.columns.length+a)*a},F.prototype.dimensions=function(){return{num_table_rows:this.table.num_rows(),num_table_columns:this.table.num_columns(),num_view_rows:this._View.num_rows(),num_view_columns:this.num_columns()}},F.prototype.get_row_expanded=function(s){return this._View.get_row_expanded(s)},F.prototype.expand=function(s){return this._View.expand(s,this.config.group_by.length)},F.prototype.collapse=function(s){return this._View.collapse(s)},F.prototype.set_depth=function(s){return this._View.set_depth(s,this.config.group_by.length)},F.prototype._get_step_delta=async function(){let s=this._View.get_step_delta(0,2147483647),a;if(s.cells.size()===0)a=this.to_json();else{let c={};for(let g=0;g<s.cells.size();g++)c[s.cells.get(g).row]=!0;c=Object.keys(c);let h=c.map(g=>this.to_json({start_row:Number.parseInt(g),end_row:Number.parseInt(g)+1}));a=[].concat.apply([],h)}return s.cells.delete(),a},F.prototype._get_row_delta=async function(){if(this.is_unit_context)return o.get_row_delta_unit(this._View);{let s=this.sides(),a=b[s];return o[`get_row_delta_${a}`](this._View)}},F.prototype.on_update=function(s,{mode:a="none"}={}){if(N(this.table.get_id()),["none","row"].indexOf(a)===-1)throw new Error(`Invalid update mode "${a}" - valid modes are "none" and "row".`);a==="row"&&(this._View._get_deltas_enabled()||this._View._set_deltas_enabled(!0)),this.update_callbacks.push({view:this,orig_callback:s,callback:async(c,h)=>{h[c]===void 0&&(h[c]={});let g={port_id:c};a==="row"&&(h[c].row_delta===void 0&&(h[c].row_delta=await this._get_row_delta()),g.delta=h[c].row_delta),s(g)}})};function ze(s,a){let c=0,h=0;for(;c<s.length;){let g=s[c];a(g,c,s)&&(s[h++]=g),c++}return s.length=h,s}F.prototype.remove_update=function(s){N(this.table.get_id());let a=this.update_callbacks.length;ze(this.update_callbacks,c=>c.orig_callback!==s),console.assert(a>this.update_callbacks.length,'"callback" does not match a registered updater')},F.prototype.on_delete=function(s){this._delete_callbacks.push(s)},F.prototype.remove_delete=function(s){let a=this._delete_callbacks.length;ze(this._delete_callbacks,c=>c!==s),console.assert(a>this._delete_callbacks.length,'"callback" does not match a registered delete callbacks')};function ge(s){this.group_by=s.group_by||[],this.split_by=s.split_by||[],this.aggregates=s.aggregates||{},this.columns=s.columns,this.filter=s.filter||[],this.sort=s.sort||[],this.expressions=s.expressions||[],this.filter_op=s.filter_op||"and",this.group_by_depth=s.group_by_depth,this.split_by_depth=s.split_by_depth}ge.prototype.get_group_by=function(){let s=o.make_string_vector();return Ue(s,this.group_by)},ge.prototype.get_split_by=function(){let s=o.make_string_vector();return Ue(s,this.split_by)},ge.prototype.get_columns=function(){let s=o.make_string_vector();return Ue(s,this.columns)},ge.prototype.get_filter=function(){let s=o.make_2d_val_vector();for(let a of this.filter){let c=o.make_val_vector(),h=Ue(c,a);s.push_back(h)}return s},ge.prototype.get_sort=function(){let s=o.make_2d_string_vector();for(let a of this.sort){let c=o.make_string_vector(),h=Ue(c,a);s.push_back(h)}return s},ge.prototype.get_expressions=function(){let s=o.make_2d_val_vector();for(let a of this.expressions){let c=o.make_val_vector();for(let h of a)c.push_back(h);s.push_back(c)}return s};function I(s,a,c,h){this._Table=s;let g=this._Table.get_gnode();this.gnode_id=g.get_id(),g.delete();let O=this._Table.get_pool();O.set_update_delegate(this),O.delete(),this.name=Math.random()+"",this.initialized=!1,this.index=a,this.limit=c,this.update_callbacks=[],this._delete_callbacks=[],this.views=[],this.overridden_types=h,Zt(this)}I.prototype.get_id=function(){return this._Table.get_id()},I.prototype.get_pool=function(){return this._Table.get_pool()},I.prototype.make_port=function(){return this._Table.make_port()},I.prototype.remove_port=function(){this._Table.remove_port()},I.prototype._update_callback=function(s){let a={};for(let c in this.update_callbacks)this.update_callbacks[c].callback(s,a)},I.prototype.get_index=function(){return this.index},I.prototype.get_limit=function(){return this.limit},I.prototype.clear=function(){N(this.get_id()),this._Table.reset_gnode(this.gnode_id)},I.prototype.replace=function(s){z(this.get_id()),this._Table.reset_gnode(this.gnode_id),this.update(s),N(this.get_id())},I.prototype.delete=function(){if(this.views.length>0)throw`Cannot delete Table as it still has ${this.views.length} registered View(s).`;z(this.get_id()),this._Table.unregister_gnode(this.gnode_id),this._Table.delete();for(let s of this._delete_callbacks)s()},I.prototype.on_delete=function(s){this._delete_callbacks.push(s)},I.prototype.remove_delete=function(s){let a=this._delete_callbacks.length;ze(this._delete_callbacks,c=>c!==s),console.assert(a>this._delete_callbacks.length,'"callback" does not match a registered delete callbacks')},I.prototype.size=function(){return N(this._Table.get_id()),this._Table.size()},I.prototype.num_rows=function(){return this.size()},I.prototype.num_columns=function(){let s=this._Table.get_schema(),a=s.columns(),c=a.size();return a.delete(),s.delete(),c-1},I.prototype.schema=function(s=!0){let a=this._Table.get_schema(),c=a.columns(),h=a.types(),g={};for(let O=0;O<c.size();O++){let x=c.get(O);x!=="psp_okey"&&(s&&this.overridden_types[x]?g[x]=this.overridden_types[x]:g[x]=Ot(h.get(O).value))}return a.delete(),c.delete(),h.delete(),g};function Te(s){let a=[],c={};for(let h of s){if(h.includes('""')){console.error(`Skipping expression '${h}', as it cannot reference an empty column!`);continue}let g={},O={},x=0,y,R=h.match(/^\/\/(?<alias>.+?)\n/);R?.groups?.alias&&(y=R.groups.alias.trim()),(!y||y.length==0)&&(y=h);let S=h.replace(/([a-zA-Z_]+[a-zA-Z0-9_]*)/g,P=>P=="true"?"True":P=="false"?"False":P);S=S.replace(/\"(.*?[^\\])\"/g,(P,ne)=>{if(ne=ne.replace(/\\"/g,'"'),g[ne]===void 0){let te=`COLUMN${x}`;g[ne]=te,O[te]=ne}return x++,g[ne]}),S=S.replace(/'(.*?[^\\])'/g,P=>`intern(${P})`);let H=(P,ne,te,oe)=>{let Se=P.indexOf(te);return`${P.substring(0,Se)}'${oe}'${P.substring(Se+te.length)}`};S=S.replace(/(bucket|match|match_all|search|indexof)\(.*?,\s*(intern\(\'(.+)\'\)).*\)/g,H),S=S.replace(/(replace_all|replace)\(.*?,\s*(intern\(\'(.*)\'\)),.*\)/g,H);let w=[y,h,S,O];if(c[y]!==void 0){let P=c[y];a[P]=w}else a.push(w),c[y]=a.length-1}return a}I.prototype.validate_expressions=function(s,a=!0){let c={expression_schema:{},expression_alias:{},errors:{}};if(!s||s.length===0)return c;s=Te(s);let h=o.make_2d_val_vector();for(let S of s){let H=o.make_val_vector();for(let w of S)H.push_back(w);h.push_back(H),c.expression_alias[S[0]]=S[1]}let g=o.validate_expressions(this._Table,h),O=g.get_expression_schema(),x=g.get_expression_errors(),y=O.keys();for(let S=0;S<y.size();S++){let H=y.get(S),w=O.get(H);a&&this.overridden_types[H]&&(w=this.overridden_types[H]),c.expression_schema[H]=w}let R=x.keys();for(let S=0;S<R.size();S++){let H=R.get(S),w=x.get(H);c.errors[H]=w}return R.delete(),y.delete(),x.delete(),O.delete(),g.delete(),c},I.prototype.is_valid_filter=function(s){if(s[1]===_e.FILTER_OPERATORS.isNull||s[1]===_e.FILTER_OPERATORS.isNotNull)return!0;let a=s[2];if(a===null)return!1;let c=this.schema();return c[s[0]]&&(c[s[0]]==="date"||c[s[0]]==="datetime")?o.is_valid_datetime(s[2]):typeof a<"u"&&a!==null},I.prototype.view=function(s={}){N(this._Table.get_id());let a={};for(let y of Object.keys(s))if(Me[y])if(!a[Me[y]])St.has(y)||(console.warn(`Deprecated: "${y}" config parameter, please use "${Me[y]}" instead`),St.add(y)),a[Me[y]]=s[y];else throw new Error(`Duplicate configuration parameter "${y}"`);else if(y==="aggregate"){St.has("aggregate")||(console.warn('Deprecated: "aggregate" config parameter has been replaced by "aggregates" and "columns"'),St.add("aggregate")),a.aggregates={},a.columns=[];for(let R of s.aggregate)a.aggregates[R.column]=R.op,a.columns.push(R.column)}else if(qt.indexOf(y)>-1)a[y]=s[y];else throw new Error(`Unrecognized config parameter "${y}"`);a.group_by=a.group_by||[],a.split_by=a.split_by||[],a.aggregates=a.aggregates||{},a.filter=a.filter||[],a.sort=a.sort||[],a.expressions=a.expressions||[];let c=this.schema();if(a.expressions.length>0&&(a.expressions=Te(a.expressions)),a.columns===void 0&&(a.columns=this.columns(),a.expressions.length>0))for(let y of a.expressions)a.columns.push(y[0]);if(a.filter.length>0)for(let y of a.filter){let R=c[y[0]];y[1]!==_e.FILTER_OPERATORS.isNull&&y[1]!==_e.FILTER_OPERATORS.isNotNull&&(R==="date"||R==="datetime")&&(y[2]=new Date(y[2]))}let h=Math.random()+"",g;a.group_by.length>0||a.split_by.length>0?a.split_by&&a.split_by.length>0?g=2:g=1:g=0;let O=new ge(a),x=new F(this,g,a,O,h);return this.views.push(x),x};let Ye;function De(){if(Ye===void 0){let s=0,a=performance.now();setTimeout(function c(){let h=performance.now();console.log(`${(1e3*s/(h-a)).toFixed(2)} msgs/sec`),s=0,a=h,setTimeout(c,5e3)},5e3),Ye=function(h){s+=h},console.log("Profiling initialized")}}I.prototype.query_columns=function(s,a){let c=this.view(s),h=c.to_columns(a);return c.delete(),h},I.prototype.update=function(s,a){a=a||{},a.port_id=a.port_id||0;let c,h=this.columns(),g=this._Table.get_schema(),O=g.types(),x=!1,y=!1;if(c=i,s instanceof ArrayBuffer?(c=new Uint8Array(s),x=!0):typeof s=="string"?(s[0]===","&&(s="_"+s),y=!0,x=!0,c=s):(i.init(s),i.names=h.concat(i.names.filter(R=>R==="__INDEX__")),i.types=Kt(O).slice(0,h.length),Ye&&Ye(i.row_count)),!x){if(c.row_count===0){console.warn("table.update called with no data - ignoring");return}i.names.indexOf("__INDEX__")!=-1&&(!!this.index?i.types.push(i.types[i.names.indexOf(this.index)]):i.types.push(o.t_dtype.DTYPE_INT32))}try{let R=o.t_op.OP_INSERT;fe(c,this._Table,this.index,this.limit,R,!0,x,y,a.port_id).delete(),this.initialized=!0}catch(R){console.error(`Update failed: ${R}`)}finally{g.delete()}},I.prototype.remove=function(s,a){if(!this.index){console.error("Cannot call `remove()` on a Table without a user-specified index.");return}a=a||{},a.port_id=a.port_id||0;let c,h=this.columns(),g=this._Table.get_schema(),O=g.types(),x=!1;s=s.map(y=>({[this.index]:y})),s instanceof ArrayBuffer?(c=new Uint8Array(s),x=!0):(i.init(s),i.names=[this.index],i.types=[Kt(O)[h.indexOf(this.index)]],c=i);try{let y=o.t_op.OP_DELETE;fe(c,this._Table,this.index,this.limit,y,!1,x,!1,a.port_id).delete(),this.initialized=!0}catch(y){console.error("Remove failed",y)}finally{g.delete()}},I.prototype.columns=function(){let s=this._Table.get_schema(),a=s.columns(),c=[];for(let h=0;h<a.size();h++){let g=a.get(h);g!=="psp_okey"&&c.push(g)}return s.delete(),a.delete(),c},I.prototype.execute=function(s){s(this)};let _e={__module__:o,Server:lt,worker:function(){return this},initialize_profile_thread:De,memory_usage:G,table:function(s,a){a=a||{},a.index=a.index||null,a.limit=a.limit||null;let c,h=!1,g={},O=!1;if(s instanceof ArrayBuffer||typeof Buffer<"u"&&s instanceof Buffer?(c=new Uint8Array(s),h=!0):typeof s=="string"?(s[0]===","&&(s="_"+s),O=!0,h=!0,c=s):(i.clean(),g=i.init(s),c=i),a.index&&a.limit)throw`Cannot specify both index '${a.index}' and limit '${a.limit}'.`;let x;try{let y=o.t_op.OP_INSERT;return x=fe(c,void 0,a.index,a.limit,y,!1,h,O,0),new I(x,a.index,a.limit,g)}catch(y){throw x&&x.delete(),console.error(`Table initialization failed: ${y}`),y}}};for(let s of Object.keys(Et))_e[s]=Et[s];class Rt extends lt{constructor(a){super(a),self.addEventListener("message",c=>this.process(c.data),!1)}post(a,c){self.postMessage(a,c)}init(a){if(typeof WebAssembly>"u")throw new Error("WebAssembly not supported");o({wasmBinary:a.buffer,wasmJSMethod:"native-wasm",locateFile:c=>c}).then(c=>{o=c,o.init(),super.init(a)})}}return typeof self<"u"&&self.addEventListener&&new Rt(_e),_e}var ho=globalThis.perspective=Mr(Fr);})();
//# sourceMappingURL=perspective.worker.js.map
